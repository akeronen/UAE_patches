Only in ../uae_jit_cleaning/uae-0.8.21/: config.cache
Only in ../uae_jit_cleaning/uae-0.8.21/: config.log
Only in ../uae_jit_cleaning/uae-0.8.21/: config.status
diff -crB ./uae-0.8.21/configure ../uae_jit_cleaning/uae-0.8.21/configure
*** ./uae-0.8.21/configure	2001-12-30 16:42:54.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/configure	2021-01-10 13:10:29.818591684 +0200
***************
*** 32,37 ****
--- 32,39 ----
  ac_help="$ac_help
    --enable-ui             Use a user interface if possible (default on)"
  ac_help="$ac_help
+   --enable-jit            linux/X11 version: Use the JIT compiler"
+ ac_help="$ac_help
    --with-hostcc=x         Use a x as compiler for the host system"
  ac_help="$ac_help
    --with-gtk-prefix=PFX   Prefix where GTK is installed (optional)"
***************
*** 560,566 ****
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:564: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 562,568 ----
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:566: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 590,596 ****
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:594: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 592,598 ----
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:596: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 641,647 ****
        # Extract the first word of "cl", so it can be a program name with args.
  set dummy cl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:645: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 643,649 ----
        # Extract the first word of "cl", so it can be a program name with args.
  set dummy cl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:647: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 673,679 ****
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:677: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
--- 675,681 ----
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:679: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
***************
*** 684,695 ****
  
  cat > conftest.$ac_ext << EOF
  
! #line 688 "configure"
  #include "confdefs.h"
  
  main(){return(0);}
  EOF
! if { (eval echo configure:693: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
--- 686,697 ----
  
  cat > conftest.$ac_ext << EOF
  
! #line 690 "configure"
  #include "confdefs.h"
  
  main(){return(0);}
  EOF
! if { (eval echo configure:695: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
***************
*** 715,726 ****
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:719: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:724: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 717,728 ----
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:721: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:726: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 729,735 ****
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:733: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
--- 731,737 ----
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:735: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
***************
*** 748,754 ****
  ac_save_CFLAGS="$CFLAGS"
  CFLAGS=
  echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:752: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 750,756 ----
  ac_save_CFLAGS="$CFLAGS"
  CFLAGS=
  echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:754: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 781,787 ****
  
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:785: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
--- 783,789 ----
  
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:787: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
***************
*** 796,808 ****
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 800 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:806: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 798,810 ----
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 802 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:808: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 813,825 ****
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 817 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:823: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 815,827 ----
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 819 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:825: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 830,842 ****
    rm -rf conftest*
    CPP="${CC-cc} -nologo -E"
    cat > conftest.$ac_ext <<EOF
! #line 834 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:840: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 832,844 ----
    rm -rf conftest*
    CPP="${CC-cc} -nologo -E"
    cat > conftest.$ac_ext <<EOF
! #line 836 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:842: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 861,867 ****
  echo "$ac_t""$CPP" 1>&6
  
  echo $ac_n "checking whether ${MAKE-make} sets \${MAKE}""... $ac_c" 1>&6
! echo "configure:865: checking whether ${MAKE-make} sets \${MAKE}" >&5
  set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 863,869 ----
  echo "$ac_t""$CPP" 1>&6
  
  echo $ac_n "checking whether ${MAKE-make} sets \${MAKE}""... $ac_c" 1>&6
! echo "configure:867: checking whether ${MAKE-make} sets \${MAKE}" >&5
  set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 890,896 ****
  # Extract the first word of "makedepend", so it can be a program name with args.
  set dummy makedepend; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:894: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_MAKEDEPPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 892,898 ----
  # Extract the first word of "makedepend", so it can be a program name with args.
  set dummy makedepend; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:896: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_MAKEDEPPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 926,932 ****
  # Extract the first word of "file", so it can be a program name with args.
  set dummy file; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:930: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_FILEPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 928,934 ----
  # Extract the first word of "file", so it can be a program name with args.
  set dummy file; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:932: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_FILEPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 962,968 ****
  # Extract the first word of "wrc", so it can be a program name with args.
  set dummy wrc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:966: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_WRCPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 964,970 ----
  # Extract the first word of "wrc", so it can be a program name with args.
  set dummy wrc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:968: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_WRCPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 998,1004 ****
  # Extract the first word of "rcl", so it can be a program name with args.
  set dummy rcl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1002: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_RCLPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1000,1006 ----
  # Extract the first word of "rcl", so it can be a program name with args.
  set dummy rcl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1004: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_RCLPRG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1034,1040 ****
  # Extract the first word of "sdl-config", so it can be a program name with args.
  set dummy sdl-config; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1038: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_SDL_CONFIG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1036,1042 ----
  # Extract the first word of "sdl-config", so it can be a program name with args.
  set dummy sdl-config; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1040: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_SDL_CONFIG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1069,1077 ****
  
  
  echo $ac_n "checking for AIX""... $ac_c" 1>&6
! echo "configure:1073: checking for AIX" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1075 "configure"
  #include "confdefs.h"
  #ifdef _AIX
    yes
--- 1071,1079 ----
  
  
  echo $ac_n "checking for AIX""... $ac_c" 1>&6
! echo "configure:1075: checking for AIX" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1077 "configure"
  #include "confdefs.h"
  #ifdef _AIX
    yes
***************
*** 1093,1099 ****
  
  
  echo $ac_n "checking for POSIXized ISC""... $ac_c" 1>&6
! echo "configure:1097: checking for POSIXized ISC" >&5
  if test -d /etc/conf/kconfig.d &&
    grep _POSIX_VERSION /usr/include/sys/unistd.h >/dev/null 2>&1
  then
--- 1095,1101 ----
  
  
  echo $ac_n "checking for POSIXized ISC""... $ac_c" 1>&6
! echo "configure:1099: checking for POSIXized ISC" >&5
  if test -d /etc/conf/kconfig.d &&
    grep _POSIX_VERSION /usr/include/sys/unistd.h >/dev/null 2>&1
  then
***************
*** 1115,1123 ****
  
  
  echo $ac_n "checking for Watcom C""... $ac_c" 1>&6
! echo "configure:1119: checking for Watcom C" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1121 "configure"
  #include "confdefs.h"
  #ifdef __WATCOMC__
    yes
--- 1117,1125 ----
  
  
  echo $ac_n "checking for Watcom C""... $ac_c" 1>&6
! echo "configure:1121: checking for Watcom C" >&5
  cat > conftest.$ac_ext <<EOF
! #line 1123 "configure"
  #include "confdefs.h"
  #ifdef __WATCOMC__
    yes
***************
*** 1137,1155 ****
  echo "$ac_t""$uae_cv_prog_cc_watcom" 1>&6
  
  echo $ac_n "checking for Cygwin32 environment""... $ac_c" 1>&6
! echo "configure:1141: checking for Cygwin32 environment" >&5
  if eval "test \"`echo '$''{'am_cv_cygwin32'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1146 "configure"
  #include "confdefs.h"
  
  int main() {
  return __CYGWIN32__;
  ; return 0; }
  EOF
! if { (eval echo configure:1153: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    am_cv_cygwin32=yes
  else
--- 1139,1157 ----
  echo "$ac_t""$uae_cv_prog_cc_watcom" 1>&6
  
  echo $ac_n "checking for Cygwin32 environment""... $ac_c" 1>&6
! echo "configure:1143: checking for Cygwin32 environment" >&5
  if eval "test \"`echo '$''{'am_cv_cygwin32'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1148 "configure"
  #include "confdefs.h"
  
  int main() {
  return __CYGWIN32__;
  ; return 0; }
  EOF
! if { (eval echo configure:1155: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    am_cv_cygwin32=yes
  else
***************
*** 1166,1184 ****
  CYGWIN32=
  test "$am_cv_cygwin32" = yes && CYGWIN32=yes
  echo $ac_n "checking for Mingw32 environment""... $ac_c" 1>&6
! echo "configure:1170: checking for Mingw32 environment" >&5
  if eval "test \"`echo '$''{'am_cv_mingw32'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1175 "configure"
  #include "confdefs.h"
  
  int main() {
  return __MINGW32__;
  ; return 0; }
  EOF
! if { (eval echo configure:1182: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    am_cv_mingw32=yes
  else
--- 1168,1186 ----
  CYGWIN32=
  test "$am_cv_cygwin32" = yes && CYGWIN32=yes
  echo $ac_n "checking for Mingw32 environment""... $ac_c" 1>&6
! echo "configure:1172: checking for Mingw32 environment" >&5
  if eval "test \"`echo '$''{'am_cv_mingw32'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1177 "configure"
  #include "confdefs.h"
  
  int main() {
  return __MINGW32__;
  ; return 0; }
  EOF
! if { (eval echo configure:1184: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    am_cv_mingw32=yes
  else
***************
*** 1197,1203 ****
  
  
  echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
! echo "configure:1201: checking for executable suffix" >&5
  if eval "test \"`echo '$''{'am_cv_exeext'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1199,1205 ----
  
  
  echo $ac_n "checking for executable suffix""... $ac_c" 1>&6
! echo "configure:1203: checking for executable suffix" >&5
  if eval "test \"`echo '$''{'am_cv_exeext'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1241,1247 ****
  HAVE_BEOS=no
  HAVE_POS=no
  echo $ac_n "checking for main in -lMedia_s""... $ac_c" 1>&6
! echo "configure:1245: checking for main in -lMedia_s" >&5
  ac_lib_var=`echo Media_s'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1243,1249 ----
  HAVE_BEOS=no
  HAVE_POS=no
  echo $ac_n "checking for main in -lMedia_s""... $ac_c" 1>&6
! echo "configure:1247: checking for main in -lMedia_s" >&5
  ac_lib_var=`echo Media_s'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1249,1262 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lMedia_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1253 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:1260: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1251,1264 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lMedia_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1255 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:1262: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1278,1284 ****
  fi
  
  echo $ac_n "checking for main in -lNeXT_s""... $ac_c" 1>&6
! echo "configure:1282: checking for main in -lNeXT_s" >&5
  ac_lib_var=`echo NeXT_s'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1280,1286 ----
  fi
  
  echo $ac_n "checking for main in -lNeXT_s""... $ac_c" 1>&6
! echo "configure:1284: checking for main in -lNeXT_s" >&5
  ac_lib_var=`echo NeXT_s'_'main | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1286,1299 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lNeXT_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1290 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:1297: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1288,1301 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lNeXT_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1292 "configure"
  #include "confdefs.h"
  
  int main() {
  main()
  ; return 0; }
  EOF
! if { (eval echo configure:1299: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1315,1321 ****
  fi
  
  echo $ac_n "checking for cos in -lmoto""... $ac_c" 1>&6
! echo "configure:1319: checking for cos in -lmoto" >&5
  ac_lib_var=`echo moto'_'cos | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1317,1323 ----
  fi
  
  echo $ac_n "checking for cos in -lmoto""... $ac_c" 1>&6
! echo "configure:1321: checking for cos in -lmoto" >&5
  ac_lib_var=`echo moto'_'cos | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1323,1329 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lmoto  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1327 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1325,1331 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lmoto  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1329 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1334,1340 ****
  cos()
  ; return 0; }
  EOF
! if { (eval echo configure:1338: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1336,1342 ----
  cos()
  ; return 0; }
  EOF
! if { (eval echo configure:1340: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1356,1362 ****
  fi
  
  echo $ac_n "checking for OpenLibrary in -lamiga""... $ac_c" 1>&6
! echo "configure:1360: checking for OpenLibrary in -lamiga" >&5
  ac_lib_var=`echo amiga'_'OpenLibrary | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1358,1364 ----
  fi
  
  echo $ac_n "checking for OpenLibrary in -lamiga""... $ac_c" 1>&6
! echo "configure:1362: checking for OpenLibrary in -lamiga" >&5
  ac_lib_var=`echo amiga'_'OpenLibrary | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1364,1370 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lamiga  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1368 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1366,1372 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lamiga  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1370 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1375,1381 ****
  OpenLibrary()
  ; return 0; }
  EOF
! if { (eval echo configure:1379: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1377,1383 ----
  OpenLibrary()
  ; return 0; }
  EOF
! if { (eval echo configure:1381: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1397,1403 ****
  fi
  
  echo $ac_n "checking for vga_setmode in -lvga""... $ac_c" 1>&6
! echo "configure:1401: checking for vga_setmode in -lvga" >&5
  ac_lib_var=`echo vga'_'vga_setmode | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1399,1405 ----
  fi
  
  echo $ac_n "checking for vga_setmode in -lvga""... $ac_c" 1>&6
! echo "configure:1403: checking for vga_setmode in -lvga" >&5
  ac_lib_var=`echo vga'_'vga_setmode | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1405,1411 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lvga  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1409 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1407,1413 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lvga  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1411 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1416,1422 ****
  vga_setmode()
  ; return 0; }
  EOF
! if { (eval echo configure:1420: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1418,1424 ----
  vga_setmode()
  ; return 0; }
  EOF
! if { (eval echo configure:1422: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1438,1444 ****
  fi
  
  echo $ac_n "checking for AFOpenAudioConn in -lAF""... $ac_c" 1>&6
! echo "configure:1442: checking for AFOpenAudioConn in -lAF" >&5
  ac_lib_var=`echo AF'_'AFOpenAudioConn | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1440,1446 ----
  fi
  
  echo $ac_n "checking for AFOpenAudioConn in -lAF""... $ac_c" 1>&6
! echo "configure:1444: checking for AFOpenAudioConn in -lAF" >&5
  ac_lib_var=`echo AF'_'AFOpenAudioConn | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1446,1452 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lAF  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1450 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1448,1454 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lAF  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1452 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1457,1463 ****
  AFOpenAudioConn()
  ; return 0; }
  EOF
! if { (eval echo configure:1461: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1459,1465 ----
  AFOpenAudioConn()
  ; return 0; }
  EOF
! if { (eval echo configure:1463: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1479,1485 ****
  fi
  
  echo $ac_n "checking for waveOutGetNumDevs in -lmme""... $ac_c" 1>&6
! echo "configure:1483: checking for waveOutGetNumDevs in -lmme" >&5
  ac_lib_var=`echo mme'_'waveOutGetNumDevs | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1481,1487 ----
  fi
  
  echo $ac_n "checking for waveOutGetNumDevs in -lmme""... $ac_c" 1>&6
! echo "configure:1485: checking for waveOutGetNumDevs in -lmme" >&5
  ac_lib_var=`echo mme'_'waveOutGetNumDevs | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1487,1493 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lmme  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1491 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1489,1495 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lmme  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1493 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1498,1504 ****
  waveOutGetNumDevs()
  ; return 0; }
  EOF
! if { (eval echo configure:1502: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1500,1506 ----
  waveOutGetNumDevs()
  ; return 0; }
  EOF
! if { (eval echo configure:1504: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1520,1526 ****
  fi
  
  echo $ac_n "checking for waddch in -lncurses""... $ac_c" 1>&6
! echo "configure:1524: checking for waddch in -lncurses" >&5
  ac_lib_var=`echo ncurses'_'waddch | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1522,1528 ----
  fi
  
  echo $ac_n "checking for waddch in -lncurses""... $ac_c" 1>&6
! echo "configure:1526: checking for waddch in -lncurses" >&5
  ac_lib_var=`echo ncurses'_'waddch | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1528,1534 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lncurses  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1532 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1530,1536 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lncurses  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1534 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1539,1545 ****
  waddch()
  ; return 0; }
  EOF
! if { (eval echo configure:1543: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1541,1547 ----
  waddch()
  ; return 0; }
  EOF
! if { (eval echo configure:1545: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1561,1567 ****
  fi
  
  echo $ac_n "checking for sem_init in -lposix4""... $ac_c" 1>&6
! echo "configure:1565: checking for sem_init in -lposix4" >&5
  ac_lib_var=`echo posix4'_'sem_init | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1563,1569 ----
  fi
  
  echo $ac_n "checking for sem_init in -lposix4""... $ac_c" 1>&6
! echo "configure:1567: checking for sem_init in -lposix4" >&5
  ac_lib_var=`echo posix4'_'sem_init | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1569,1575 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lposix4  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1573 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1571,1577 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lposix4  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1575 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1580,1586 ****
  sem_init()
  ; return 0; }
  EOF
! if { (eval echo configure:1584: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1582,1588 ----
  sem_init()
  ; return 0; }
  EOF
! if { (eval echo configure:1586: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1602,1608 ****
  fi
  
  echo $ac_n "checking for sem_init in -lrt""... $ac_c" 1>&6
! echo "configure:1606: checking for sem_init in -lrt" >&5
  ac_lib_var=`echo rt'_'sem_init | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1604,1610 ----
  fi
  
  echo $ac_n "checking for sem_init in -lrt""... $ac_c" 1>&6
! echo "configure:1608: checking for sem_init in -lrt" >&5
  ac_lib_var=`echo rt'_'sem_init | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1610,1616 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lrt  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1614 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1612,1618 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lrt  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1616 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1621,1627 ****
  sem_init()
  ; return 0; }
  EOF
! if { (eval echo configure:1625: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1623,1629 ----
  sem_init()
  ; return 0; }
  EOF
! if { (eval echo configure:1627: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1643,1649 ****
  fi
  
  echo $ac_n "checking for alOpenPort in -laudio""... $ac_c" 1>&6
! echo "configure:1647: checking for alOpenPort in -laudio" >&5
  ac_lib_var=`echo audio'_'alOpenPort | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1645,1651 ----
  fi
  
  echo $ac_n "checking for alOpenPort in -laudio""... $ac_c" 1>&6
! echo "configure:1649: checking for alOpenPort in -laudio" >&5
  ac_lib_var=`echo audio'_'alOpenPort | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1651,1657 ****
    ac_save_LIBS="$LIBS"
  LIBS="-laudio  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1655 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 1653,1659 ----
    ac_save_LIBS="$LIBS"
  LIBS="-laudio  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1657 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 1662,1668 ****
  alOpenPort()
  ; return 0; }
  EOF
! if { (eval echo configure:1666: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 1664,1670 ----
  alOpenPort()
  ; return 0; }
  EOF
! if { (eval echo configure:1668: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 1689,1695 ****
  # Uses ac_ vars as temps to allow command line to override cache and checks.
  # --without-x overrides everything else, but does not touch the cache.
  echo $ac_n "checking for X""... $ac_c" 1>&6
! echo "configure:1693: checking for X" >&5
  
  # Check whether --with-x or --without-x was given.
  if test "${with_x+set}" = set; then
--- 1691,1697 ----
  # Uses ac_ vars as temps to allow command line to override cache and checks.
  # --without-x overrides everything else, but does not touch the cache.
  echo $ac_n "checking for X""... $ac_c" 1>&6
! echo "configure:1695: checking for X" >&5
  
  # Check whether --with-x or --without-x was given.
  if test "${with_x+set}" = set; then
***************
*** 1751,1762 ****
  
    # First, try using that file with no special directory specified.
  cat > conftest.$ac_ext <<EOF
! #line 1755 "configure"
  #include "confdefs.h"
  #include <$x_direct_test_include>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1760: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 1753,1764 ----
  
    # First, try using that file with no special directory specified.
  cat > conftest.$ac_ext <<EOF
! #line 1757 "configure"
  #include "confdefs.h"
  #include <$x_direct_test_include>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:1762: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 1825,1838 ****
    ac_save_LIBS="$LIBS"
    LIBS="-l$x_direct_test_library $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1829 "configure"
  #include "confdefs.h"
  
  int main() {
  ${x_direct_test_function}()
  ; return 0; }
  EOF
! if { (eval echo configure:1836: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    LIBS="$ac_save_LIBS"
  # We can link X programs with no special library path.
--- 1827,1840 ----
    ac_save_LIBS="$LIBS"
    LIBS="-l$x_direct_test_library $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 1831 "configure"
  #include "confdefs.h"
  
  int main() {
  ${x_direct_test_function}()
  ; return 0; }
  EOF
! if { (eval echo configure:1838: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    LIBS="$ac_save_LIBS"
  # We can link X programs with no special library path.
***************
*** 1938,1954 ****
      case "`(uname -sr) 2>/dev/null`" in
      "SunOS 5"*)
        echo $ac_n "checking whether -R must be followed by a space""... $ac_c" 1>&6
! echo "configure:1942: checking whether -R must be followed by a space" >&5
        ac_xsave_LIBS="$LIBS"; LIBS="$LIBS -R$x_libraries"
        cat > conftest.$ac_ext <<EOF
! #line 1945 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1952: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_R_nospace=yes
  else
--- 1940,1956 ----
      case "`(uname -sr) 2>/dev/null`" in
      "SunOS 5"*)
        echo $ac_n "checking whether -R must be followed by a space""... $ac_c" 1>&6
! echo "configure:1944: checking whether -R must be followed by a space" >&5
        ac_xsave_LIBS="$LIBS"; LIBS="$LIBS -R$x_libraries"
        cat > conftest.$ac_ext <<EOF
! #line 1947 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1954: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_R_nospace=yes
  else
***************
*** 1964,1977 ****
        else
  	LIBS="$ac_xsave_LIBS -R $x_libraries"
  	cat > conftest.$ac_ext <<EOF
! #line 1968 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1975: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_R_space=yes
  else
--- 1966,1979 ----
        else
  	LIBS="$ac_xsave_LIBS -R $x_libraries"
  	cat > conftest.$ac_ext <<EOF
! #line 1970 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1977: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_R_space=yes
  else
***************
*** 2003,2009 ****
      # libraries were built with DECnet support.  And karl@cs.umb.edu says
      # the Alpha needs dnet_stub (dnet does not exist).
      echo $ac_n "checking for dnet_ntoa in -ldnet""... $ac_c" 1>&6
! echo "configure:2007: checking for dnet_ntoa in -ldnet" >&5
  ac_lib_var=`echo dnet'_'dnet_ntoa | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2005,2011 ----
      # libraries were built with DECnet support.  And karl@cs.umb.edu says
      # the Alpha needs dnet_stub (dnet does not exist).
      echo $ac_n "checking for dnet_ntoa in -ldnet""... $ac_c" 1>&6
! echo "configure:2009: checking for dnet_ntoa in -ldnet" >&5
  ac_lib_var=`echo dnet'_'dnet_ntoa | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2011,2017 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldnet  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2015 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2013,2019 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldnet  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2017 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2022,2028 ****
  dnet_ntoa()
  ; return 0; }
  EOF
! if { (eval echo configure:2026: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2024,2030 ----
  dnet_ntoa()
  ; return 0; }
  EOF
! if { (eval echo configure:2028: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2044,2050 ****
  
      if test $ac_cv_lib_dnet_dnet_ntoa = no; then
        echo $ac_n "checking for dnet_ntoa in -ldnet_stub""... $ac_c" 1>&6
! echo "configure:2048: checking for dnet_ntoa in -ldnet_stub" >&5
  ac_lib_var=`echo dnet_stub'_'dnet_ntoa | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2046,2052 ----
  
      if test $ac_cv_lib_dnet_dnet_ntoa = no; then
        echo $ac_n "checking for dnet_ntoa in -ldnet_stub""... $ac_c" 1>&6
! echo "configure:2050: checking for dnet_ntoa in -ldnet_stub" >&5
  ac_lib_var=`echo dnet_stub'_'dnet_ntoa | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2052,2058 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldnet_stub  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2056 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2054,2060 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldnet_stub  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2058 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2063,2069 ****
  dnet_ntoa()
  ; return 0; }
  EOF
! if { (eval echo configure:2067: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2065,2071 ----
  dnet_ntoa()
  ; return 0; }
  EOF
! if { (eval echo configure:2069: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2092,2103 ****
      # The nsl library prevents programs from opening the X display
      # on Irix 5.2, according to dickey@clark.net.
      echo $ac_n "checking for gethostbyname""... $ac_c" 1>&6
! echo "configure:2096: checking for gethostbyname" >&5
  if eval "test \"`echo '$''{'ac_cv_func_gethostbyname'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2101 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char gethostbyname(); below.  */
--- 2094,2105 ----
      # The nsl library prevents programs from opening the X display
      # on Irix 5.2, according to dickey@clark.net.
      echo $ac_n "checking for gethostbyname""... $ac_c" 1>&6
! echo "configure:2098: checking for gethostbyname" >&5
  if eval "test \"`echo '$''{'ac_cv_func_gethostbyname'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2103 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char gethostbyname(); below.  */
***************
*** 2120,2126 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2124: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_gethostbyname=yes"
  else
--- 2122,2128 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2126: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_gethostbyname=yes"
  else
***************
*** 2141,2147 ****
  
      if test $ac_cv_func_gethostbyname = no; then
        echo $ac_n "checking for gethostbyname in -lnsl""... $ac_c" 1>&6
! echo "configure:2145: checking for gethostbyname in -lnsl" >&5
  ac_lib_var=`echo nsl'_'gethostbyname | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2143,2149 ----
  
      if test $ac_cv_func_gethostbyname = no; then
        echo $ac_n "checking for gethostbyname in -lnsl""... $ac_c" 1>&6
! echo "configure:2147: checking for gethostbyname in -lnsl" >&5
  ac_lib_var=`echo nsl'_'gethostbyname | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2149,2155 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2153 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2151,2157 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2155 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2160,2166 ****
  gethostbyname()
  ; return 0; }
  EOF
! if { (eval echo configure:2164: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2162,2168 ----
  gethostbyname()
  ; return 0; }
  EOF
! if { (eval echo configure:2166: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2190,2201 ****
      # -lsocket must be given before -lnsl if both are needed.
      # We assume that if connect needs -lnsl, so does gethostbyname.
      echo $ac_n "checking for connect""... $ac_c" 1>&6
! echo "configure:2194: checking for connect" >&5
  if eval "test \"`echo '$''{'ac_cv_func_connect'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2199 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char connect(); below.  */
--- 2192,2203 ----
      # -lsocket must be given before -lnsl if both are needed.
      # We assume that if connect needs -lnsl, so does gethostbyname.
      echo $ac_n "checking for connect""... $ac_c" 1>&6
! echo "configure:2196: checking for connect" >&5
  if eval "test \"`echo '$''{'ac_cv_func_connect'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2201 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char connect(); below.  */
***************
*** 2218,2224 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2222: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_connect=yes"
  else
--- 2220,2226 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2224: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_connect=yes"
  else
***************
*** 2239,2245 ****
  
      if test $ac_cv_func_connect = no; then
        echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
! echo "configure:2243: checking for connect in -lsocket" >&5
  ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2241,2247 ----
  
      if test $ac_cv_func_connect = no; then
        echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
! echo "configure:2245: checking for connect in -lsocket" >&5
  ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2247,2253 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsocket $X_EXTRA_LIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2251 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2249,2255 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsocket $X_EXTRA_LIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2253 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2258,2264 ****
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:2262: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2260,2266 ----
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:2264: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2282,2293 ****
  
      # gomez@mi.uni-erlangen.de says -lposix is necessary on A/UX.
      echo $ac_n "checking for remove""... $ac_c" 1>&6
! echo "configure:2286: checking for remove" >&5
  if eval "test \"`echo '$''{'ac_cv_func_remove'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2291 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char remove(); below.  */
--- 2284,2295 ----
  
      # gomez@mi.uni-erlangen.de says -lposix is necessary on A/UX.
      echo $ac_n "checking for remove""... $ac_c" 1>&6
! echo "configure:2288: checking for remove" >&5
  if eval "test \"`echo '$''{'ac_cv_func_remove'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2293 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char remove(); below.  */
***************
*** 2310,2316 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2314: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_remove=yes"
  else
--- 2312,2318 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2316: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_remove=yes"
  else
***************
*** 2331,2337 ****
  
      if test $ac_cv_func_remove = no; then
        echo $ac_n "checking for remove in -lposix""... $ac_c" 1>&6
! echo "configure:2335: checking for remove in -lposix" >&5
  ac_lib_var=`echo posix'_'remove | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2333,2339 ----
  
      if test $ac_cv_func_remove = no; then
        echo $ac_n "checking for remove in -lposix""... $ac_c" 1>&6
! echo "configure:2337: checking for remove in -lposix" >&5
  ac_lib_var=`echo posix'_'remove | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2339,2345 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lposix  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2343 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2341,2347 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lposix  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2345 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2350,2356 ****
  remove()
  ; return 0; }
  EOF
! if { (eval echo configure:2354: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2352,2358 ----
  remove()
  ; return 0; }
  EOF
! if { (eval echo configure:2356: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2374,2385 ****
  
      # BSDI BSD/OS 2.1 needs -lipc for XOpenDisplay.
      echo $ac_n "checking for shmat""... $ac_c" 1>&6
! echo "configure:2378: checking for shmat" >&5
  if eval "test \"`echo '$''{'ac_cv_func_shmat'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2383 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char shmat(); below.  */
--- 2376,2387 ----
  
      # BSDI BSD/OS 2.1 needs -lipc for XOpenDisplay.
      echo $ac_n "checking for shmat""... $ac_c" 1>&6
! echo "configure:2380: checking for shmat" >&5
  if eval "test \"`echo '$''{'ac_cv_func_shmat'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2385 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char shmat(); below.  */
***************
*** 2402,2408 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:2406: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_shmat=yes"
  else
--- 2404,2410 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:2408: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_shmat=yes"
  else
***************
*** 2423,2429 ****
  
      if test $ac_cv_func_shmat = no; then
        echo $ac_n "checking for shmat in -lipc""... $ac_c" 1>&6
! echo "configure:2427: checking for shmat in -lipc" >&5
  ac_lib_var=`echo ipc'_'shmat | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2425,2431 ----
  
      if test $ac_cv_func_shmat = no; then
        echo $ac_n "checking for shmat in -lipc""... $ac_c" 1>&6
! echo "configure:2429: checking for shmat in -lipc" >&5
  ac_lib_var=`echo ipc'_'shmat | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2431,2437 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lipc  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2435 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2433,2439 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lipc  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2437 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2442,2448 ****
  shmat()
  ; return 0; }
  EOF
! if { (eval echo configure:2446: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2444,2450 ----
  shmat()
  ; return 0; }
  EOF
! if { (eval echo configure:2448: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2475,2481 ****
    # libraries we check for below, so use a different variable.
    #  --interran@uluru.Stanford.EDU, kb@cs.umb.edu.
    echo $ac_n "checking for IceConnectionNumber in -lICE""... $ac_c" 1>&6
! echo "configure:2479: checking for IceConnectionNumber in -lICE" >&5
  ac_lib_var=`echo ICE'_'IceConnectionNumber | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2477,2483 ----
    # libraries we check for below, so use a different variable.
    #  --interran@uluru.Stanford.EDU, kb@cs.umb.edu.
    echo $ac_n "checking for IceConnectionNumber in -lICE""... $ac_c" 1>&6
! echo "configure:2481: checking for IceConnectionNumber in -lICE" >&5
  ac_lib_var=`echo ICE'_'IceConnectionNumber | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2483,2489 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lICE $X_EXTRA_LIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2487 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2485,2491 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lICE $X_EXTRA_LIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2489 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2494,2500 ****
  IceConnectionNumber()
  ; return 0; }
  EOF
! if { (eval echo configure:2498: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2496,2502 ----
  IceConnectionNumber()
  ; return 0; }
  EOF
! if { (eval echo configure:2500: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2525,2536 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr that defines DIR""... $ac_c" 1>&6
! echo "configure:2529: checking for $ac_hdr that defines DIR" >&5
  if eval "test \"`echo '$''{'ac_cv_header_dirent_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2534 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <$ac_hdr>
--- 2527,2538 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr that defines DIR""... $ac_c" 1>&6
! echo "configure:2531: checking for $ac_hdr that defines DIR" >&5
  if eval "test \"`echo '$''{'ac_cv_header_dirent_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2536 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <$ac_hdr>
***************
*** 2538,2544 ****
  DIR *dirp = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:2542: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    eval "ac_cv_header_dirent_$ac_safe=yes"
  else
--- 2540,2546 ----
  DIR *dirp = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:2544: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    eval "ac_cv_header_dirent_$ac_safe=yes"
  else
***************
*** 2563,2569 ****
  # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
  if test $ac_header_dirent = dirent.h; then
  echo $ac_n "checking for opendir in -ldir""... $ac_c" 1>&6
! echo "configure:2567: checking for opendir in -ldir" >&5
  ac_lib_var=`echo dir'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2565,2571 ----
  # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
  if test $ac_header_dirent = dirent.h; then
  echo $ac_n "checking for opendir in -ldir""... $ac_c" 1>&6
! echo "configure:2569: checking for opendir in -ldir" >&5
  ac_lib_var=`echo dir'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2571,2577 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldir  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2575 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2573,2579 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldir  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2577 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2582,2588 ****
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2586: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2584,2590 ----
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2588: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2604,2610 ****
  
  else
  echo $ac_n "checking for opendir in -lx""... $ac_c" 1>&6
! echo "configure:2608: checking for opendir in -lx" >&5
  ac_lib_var=`echo x'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2606,2612 ----
  
  else
  echo $ac_n "checking for opendir in -lx""... $ac_c" 1>&6
! echo "configure:2610: checking for opendir in -lx" >&5
  ac_lib_var=`echo x'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2612,2618 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lx  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2616 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2614,2620 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lx  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2618 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2623,2629 ****
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2627: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2625,2631 ----
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2629: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2646,2657 ****
  fi
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2650: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2655 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
--- 2648,2659 ----
  fi
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2652: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2657 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
***************
*** 2659,2665 ****
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2663: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2661,2667 ----
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2665: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2676,2682 ****
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2680 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
--- 2678,2684 ----
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2682 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
***************
*** 2694,2700 ****
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2698 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2696,2702 ----
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2700 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2715,2721 ****
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2719 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
--- 2717,2723 ----
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2721 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
***************
*** 2726,2732 ****
  exit (0); }
  
  EOF
! if { (eval echo configure:2730: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2728,2734 ----
  exit (0); }
  
  EOF
! if { (eval echo configure:2732: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2754,2770 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2758: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2763 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2768: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2756,2772 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2760: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2765 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2770: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2794,2810 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2798: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2803 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2808: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2796,2812 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2800: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2805 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2810: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2834,2850 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2838: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2843 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2848: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2836,2852 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2840: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2845 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2850: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2874,2890 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2878: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2883 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2888: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2876,2892 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2880: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2885 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2890: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2912,2928 ****
  
  ac_safe=`echo "be_math.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for be_math.h""... $ac_c" 1>&6
! echo "configure:2916: checking for be_math.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2921 "configure"
  #include "confdefs.h"
  #include <be_math.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2926: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2914,2930 ----
  
  ac_safe=`echo "be_math.h" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for be_math.h""... $ac_c" 1>&6
! echo "configure:2918: checking for be_math.h" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2923 "configure"
  #include "confdefs.h"
  #include <be_math.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2928: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2948,2964 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2952: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2957 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2962: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2950,2966 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2954: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2959 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2964: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2988,3004 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2992: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2997 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3002: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2990,3006 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2994: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2999 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3004: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 3028,3044 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3032: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3037 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3042: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 3030,3046 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3034: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3039 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3044: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 3068,3084 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3072: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3077 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3082: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 3070,3086 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3074: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3079 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3084: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 3106,3112 ****
  
  
  echo $ac_n "checking size of char""... $ac_c" 1>&6
! echo "configure:3110: checking size of char" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_char'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3108,3114 ----
  
  
  echo $ac_n "checking size of char""... $ac_c" 1>&6
! echo "configure:3112: checking size of char" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_char'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3114,3120 ****
    ac_cv_sizeof_char=1
  else
    cat > conftest.$ac_ext <<EOF
! #line 3118 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3116,3122 ----
    ac_cv_sizeof_char=1
  else
    cat > conftest.$ac_ext <<EOF
! #line 3120 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3125,3131 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3129: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_char=`cat conftestval`
  else
--- 3127,3133 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3131: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_char=`cat conftestval`
  else
***************
*** 3145,3151 ****
  
  
  echo $ac_n "checking size of short""... $ac_c" 1>&6
! echo "configure:3149: checking size of short" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3147,3153 ----
  
  
  echo $ac_n "checking size of short""... $ac_c" 1>&6
! echo "configure:3151: checking size of short" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3153,3159 ****
    ac_cv_sizeof_short=2
  else
    cat > conftest.$ac_ext <<EOF
! #line 3157 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3155,3161 ----
    ac_cv_sizeof_short=2
  else
    cat > conftest.$ac_ext <<EOF
! #line 3159 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3164,3170 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3168: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_short=`cat conftestval`
  else
--- 3166,3172 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3170: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_short=`cat conftestval`
  else
***************
*** 3184,3190 ****
  
  
  echo $ac_n "checking size of int""... $ac_c" 1>&6
! echo "configure:3188: checking size of int" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3186,3192 ----
  
  
  echo $ac_n "checking size of int""... $ac_c" 1>&6
! echo "configure:3190: checking size of int" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3192,3198 ****
    ac_cv_sizeof_int=4
  else
    cat > conftest.$ac_ext <<EOF
! #line 3196 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3194,3200 ----
    ac_cv_sizeof_int=4
  else
    cat > conftest.$ac_ext <<EOF
! #line 3198 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3203,3209 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3207: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_int=`cat conftestval`
  else
--- 3205,3211 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3209: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_int=`cat conftestval`
  else
***************
*** 3223,3229 ****
  
  
  echo $ac_n "checking size of long""... $ac_c" 1>&6
! echo "configure:3227: checking size of long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3225,3231 ----
  
  
  echo $ac_n "checking size of long""... $ac_c" 1>&6
! echo "configure:3229: checking size of long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3231,3237 ****
    ac_cv_sizeof_long=4
  else
    cat > conftest.$ac_ext <<EOF
! #line 3235 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3233,3239 ----
    ac_cv_sizeof_long=4
  else
    cat > conftest.$ac_ext <<EOF
! #line 3237 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3242,3248 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3246: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long=`cat conftestval`
  else
--- 3244,3250 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3248: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long=`cat conftestval`
  else
***************
*** 3262,3268 ****
  
  
  echo $ac_n "checking size of long long""... $ac_c" 1>&6
! echo "configure:3266: checking size of long long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3264,3270 ----
  
  
  echo $ac_n "checking size of long long""... $ac_c" 1>&6
! echo "configure:3268: checking size of long long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3270,3276 ****
    ac_cv_sizeof_long_long=8
  else
    cat > conftest.$ac_ext <<EOF
! #line 3274 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3272,3278 ----
    ac_cv_sizeof_long_long=8
  else
    cat > conftest.$ac_ext <<EOF
! #line 3276 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3281,3287 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3285: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long_long=`cat conftestval`
  else
--- 3283,3289 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3287: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long_long=`cat conftestval`
  else
***************
*** 3301,3307 ****
  
  
  echo $ac_n "checking size of __int64""... $ac_c" 1>&6
! echo "configure:3305: checking size of __int64" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof___int64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3303,3309 ----
  
  
  echo $ac_n "checking size of __int64""... $ac_c" 1>&6
! echo "configure:3307: checking size of __int64" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof___int64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3309,3315 ****
    ac_cv_sizeof___int64=8
  else
    cat > conftest.$ac_ext <<EOF
! #line 3313 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3311,3317 ----
    ac_cv_sizeof___int64=8
  else
    cat > conftest.$ac_ext <<EOF
! #line 3315 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3320,3326 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3324: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof___int64=`cat conftestval`
  else
--- 3322,3328 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3326: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof___int64=`cat conftestval`
  else
***************
*** 3341,3352 ****
  
  
  echo $ac_n "checking for working const""... $ac_c" 1>&6
! echo "configure:3345: checking for working const" >&5
  if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3350 "configure"
  #include "confdefs.h"
  
  int main() {
--- 3343,3354 ----
  
  
  echo $ac_n "checking for working const""... $ac_c" 1>&6
! echo "configure:3347: checking for working const" >&5
  if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3352 "configure"
  #include "confdefs.h"
  
  int main() {
***************
*** 3395,3401 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3399: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_const=yes
  else
--- 3397,3403 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3401: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_const=yes
  else
***************
*** 3416,3436 ****
  fi
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:3420: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 3427 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:3434: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
--- 3418,3438 ----
  fi
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:3422: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 3429 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:3436: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
***************
*** 3459,3470 ****
    ac_cv_c_inline=
  fi
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:3463: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3468 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3461,3472 ----
    ac_cv_c_inline=
  fi
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:3465: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3470 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3492,3503 ****
  fi
  
  echo $ac_n "checking for off_t""... $ac_c" 1>&6
! echo "configure:3496: checking for off_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3501 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3494,3505 ----
  fi
  
  echo $ac_n "checking for off_t""... $ac_c" 1>&6
! echo "configure:3498: checking for off_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3503 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3525,3536 ****
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:3529: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3534 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3527,3538 ----
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:3531: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3536 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3558,3569 ****
  fi
  
  echo $ac_n "checking for st_blocks in struct stat""... $ac_c" 1>&6
! echo "configure:3562: checking for st_blocks in struct stat" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_st_blocks'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3567 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
--- 3560,3571 ----
  fi
  
  echo $ac_n "checking for st_blocks in struct stat""... $ac_c" 1>&6
! echo "configure:3564: checking for st_blocks in struct stat" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_st_blocks'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3569 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
***************
*** 3571,3577 ****
  struct stat s; s.st_blocks;
  ; return 0; }
  EOF
! if { (eval echo configure:3575: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_st_blocks=yes
  else
--- 3573,3579 ----
  struct stat s; s.st_blocks;
  ; return 0; }
  EOF
! if { (eval echo configure:3577: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_st_blocks=yes
  else
***************
*** 3594,3605 ****
  fi
  
  echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
! echo "configure:3598: checking whether time.h and sys/time.h may both be included" >&5
  if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3603 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/time.h>
--- 3596,3607 ----
  fi
  
  echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
! echo "configure:3600: checking whether time.h and sys/time.h may both be included" >&5
  if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3605 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/time.h>
***************
*** 3608,3614 ****
  struct tm *tp;
  ; return 0; }
  EOF
! if { (eval echo configure:3612: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_time=yes
  else
--- 3610,3616 ----
  struct tm *tp;
  ; return 0; }
  EOF
! if { (eval echo configure:3614: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_time=yes
  else
***************
*** 3629,3640 ****
  fi
  
  echo $ac_n "checking whether struct tm is in sys/time.h or time.h""... $ac_c" 1>&6
! echo "configure:3633: checking whether struct tm is in sys/time.h or time.h" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_tm'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3638 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <time.h>
--- 3631,3642 ----
  fi
  
  echo $ac_n "checking whether struct tm is in sys/time.h or time.h""... $ac_c" 1>&6
! echo "configure:3635: checking whether struct tm is in sys/time.h or time.h" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_tm'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3640 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <time.h>
***************
*** 3642,3648 ****
  struct tm *tp; tp->tm_sec;
  ; return 0; }
  EOF
! if { (eval echo configure:3646: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_tm=time.h
  else
--- 3644,3650 ----
  struct tm *tp; tp->tm_sec;
  ; return 0; }
  EOF
! if { (eval echo configure:3648: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_tm=time.h
  else
***************
*** 3665,3677 ****
  
  if test $ac_cv_prog_gcc = yes; then
      echo $ac_n "checking whether ${CC-cc} needs -traditional""... $ac_c" 1>&6
! echo "configure:3669: checking whether ${CC-cc} needs -traditional" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc_traditional'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
      ac_pattern="Autoconf.*'x'"
    cat > conftest.$ac_ext <<EOF
! #line 3675 "configure"
  #include "confdefs.h"
  #include <sgtty.h>
  Autoconf TIOCGETP
--- 3667,3679 ----
  
  if test $ac_cv_prog_gcc = yes; then
      echo $ac_n "checking whether ${CC-cc} needs -traditional""... $ac_c" 1>&6
! echo "configure:3671: checking whether ${CC-cc} needs -traditional" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc_traditional'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
      ac_pattern="Autoconf.*'x'"
    cat > conftest.$ac_ext <<EOF
! #line 3677 "configure"
  #include "confdefs.h"
  #include <sgtty.h>
  Autoconf TIOCGETP
***************
*** 3689,3695 ****
  
    if test $ac_cv_prog_gcc_traditional = no; then
      cat > conftest.$ac_ext <<EOF
! #line 3693 "configure"
  #include "confdefs.h"
  #include <termio.h>
  Autoconf TCGETA
--- 3691,3697 ----
  
    if test $ac_cv_prog_gcc_traditional = no; then
      cat > conftest.$ac_ext <<EOF
! #line 3695 "configure"
  #include "confdefs.h"
  #include <termio.h>
  Autoconf TCGETA
***************
*** 3711,3717 ****
  fi
  
  echo $ac_n "checking for 8-bit clean memcmp""... $ac_c" 1>&6
! echo "configure:3715: checking for 8-bit clean memcmp" >&5
  if eval "test \"`echo '$''{'ac_cv_func_memcmp_clean'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3713,3719 ----
  fi
  
  echo $ac_n "checking for 8-bit clean memcmp""... $ac_c" 1>&6
! echo "configure:3717: checking for 8-bit clean memcmp" >&5
  if eval "test \"`echo '$''{'ac_cv_func_memcmp_clean'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3719,3725 ****
    ac_cv_func_memcmp_clean=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 3723 "configure"
  #include "confdefs.h"
  
  main()
--- 3721,3727 ----
    ac_cv_func_memcmp_clean=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 3725 "configure"
  #include "confdefs.h"
  
  main()
***************
*** 3729,3735 ****
  }
  
  EOF
! if { (eval echo configure:3733: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_memcmp_clean=yes
  else
--- 3731,3737 ----
  }
  
  EOF
! if { (eval echo configure:3735: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_memcmp_clean=yes
  else
***************
*** 3747,3758 ****
  test $ac_cv_func_memcmp_clean = no && LIBOBJS="$LIBOBJS memcmp.${ac_objext}"
  
  echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
! echo "configure:3751: checking return type of signal handlers" >&5
  if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3756 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <signal.h>
--- 3749,3760 ----
  test $ac_cv_func_memcmp_clean = no && LIBOBJS="$LIBOBJS memcmp.${ac_objext}"
  
  echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
! echo "configure:3753: checking return type of signal handlers" >&5
  if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3758 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <signal.h>
***************
*** 3769,3775 ****
  int i;
  ; return 0; }
  EOF
! if { (eval echo configure:3773: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_type_signal=void
  else
--- 3771,3777 ----
  int i;
  ; return 0; }
  EOF
! if { (eval echo configure:3775: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_type_signal=void
  else
***************
*** 3788,3794 ****
  
  
  echo $ac_n "checking whether utime accepts a null argument""... $ac_c" 1>&6
! echo "configure:3792: checking whether utime accepts a null argument" >&5
  if eval "test \"`echo '$''{'ac_cv_func_utime_null'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3790,3796 ----
  
  
  echo $ac_n "checking whether utime accepts a null argument""... $ac_c" 1>&6
! echo "configure:3794: checking whether utime accepts a null argument" >&5
  if eval "test \"`echo '$''{'ac_cv_func_utime_null'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3798,3804 ****
    ac_cv_func_utime_null=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 3802 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
--- 3800,3806 ----
    ac_cv_func_utime_null=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 3804 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
***************
*** 3809,3815 ****
  && t.st_mtime - s.st_mtime < 120));
  }
  EOF
! if { (eval echo configure:3813: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_utime_null=yes
  else
--- 3811,3817 ----
  && t.st_mtime - s.st_mtime < 120));
  }
  EOF
! if { (eval echo configure:3815: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_utime_null=yes
  else
***************
*** 3835,3846 ****
  for ac_func in getcwd getopt strdup gettimeofday sigaction mkdir rmdir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3839: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3844 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3837,3848 ----
  for ac_func in getcwd getopt strdup gettimeofday sigaction mkdir rmdir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3841: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3846 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3863,3869 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3867: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3865,3871 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3869: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 3890,3901 ****
  for ac_func in select strerror strstr isnan isinf setitimer
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3894: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3899 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3892,3903 ----
  for ac_func in select strerror strstr isnan isinf setitimer
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3896: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3901 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3918,3924 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3922: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3920,3926 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3924: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 3945,3956 ****
  for ac_func in tcgetattr cfmakeraw readdir_r vprintf vsprintf vfprintf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3949: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3954 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 3947,3958 ----
  for ac_func in tcgetattr cfmakeraw readdir_r vprintf vsprintf vfprintf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:3951: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3956 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 3973,3979 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3977: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 3975,3981 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3979: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 4010,4026 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4014: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4019 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4024: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4012,4028 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4016: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4021 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4026: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4052,4063 ****
  listmntent memcpy mkfifo strchr strerror strrchr
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4056: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4061 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 4054,4065 ----
  listmntent memcpy mkfifo strchr strerror strrchr
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4058: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4063 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 4080,4086 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:4084: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 4082,4088 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:4086: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 4112,4118 ****
  # make sure LIBS contains -lsun (on Irix4) or -lseq (on PTX).
  # getmntent is in -lsun on Irix 4, -lseq on Dynix/PTX, -lgen on Unixware.
  echo $ac_n "checking for getmntent in -lsun""... $ac_c" 1>&6
! echo "configure:4116: checking for getmntent in -lsun" >&5
  ac_lib_var=`echo sun'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4114,4120 ----
  # make sure LIBS contains -lsun (on Irix4) or -lseq (on PTX).
  # getmntent is in -lsun on Irix 4, -lseq on Dynix/PTX, -lgen on Unixware.
  echo $ac_n "checking for getmntent in -lsun""... $ac_c" 1>&6
! echo "configure:4118: checking for getmntent in -lsun" >&5
  ac_lib_var=`echo sun'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4120,4126 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsun  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4124 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4122,4128 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsun  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4126 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4131,4137 ****
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4135: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4133,4139 ----
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4137: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4150,4156 ****
  else
    echo "$ac_t""no" 1>&6
  echo $ac_n "checking for getmntent in -lseq""... $ac_c" 1>&6
! echo "configure:4154: checking for getmntent in -lseq" >&5
  ac_lib_var=`echo seq'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4152,4158 ----
  else
    echo "$ac_t""no" 1>&6
  echo $ac_n "checking for getmntent in -lseq""... $ac_c" 1>&6
! echo "configure:4156: checking for getmntent in -lseq" >&5
  ac_lib_var=`echo seq'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4158,4164 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lseq  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4162 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4160,4166 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lseq  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4164 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4169,4175 ****
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4173: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4171,4177 ----
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4175: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4188,4194 ****
  else
    echo "$ac_t""no" 1>&6
  echo $ac_n "checking for getmntent in -lgen""... $ac_c" 1>&6
! echo "configure:4192: checking for getmntent in -lgen" >&5
  ac_lib_var=`echo gen'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4190,4196 ----
  else
    echo "$ac_t""no" 1>&6
  echo $ac_n "checking for getmntent in -lgen""... $ac_c" 1>&6
! echo "configure:4194: checking for getmntent in -lgen" >&5
  ac_lib_var=`echo gen'_'getmntent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4196,4202 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lgen  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4200 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4198,4204 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lgen  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4202 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4207,4213 ****
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4211: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4209,4215 ----
  getmntent()
  ; return 0; }
  EOF
! if { (eval echo configure:4213: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4232,4243 ****
  fi
  
  echo $ac_n "checking for getmntent""... $ac_c" 1>&6
! echo "configure:4236: checking for getmntent" >&5
  if eval "test \"`echo '$''{'ac_cv_func_getmntent'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4241 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char getmntent(); below.  */
--- 4234,4245 ----
  fi
  
  echo $ac_n "checking for getmntent""... $ac_c" 1>&6
! echo "configure:4238: checking for getmntent" >&5
  if eval "test \"`echo '$''{'ac_cv_func_getmntent'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4243 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char getmntent(); below.  */
***************
*** 4260,4266 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:4264: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_getmntent=yes"
  else
--- 4262,4268 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:4266: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_getmntent=yes"
  else
***************
*** 4295,4307 ****
  if test -z "$list_mounted_fs"; then
  # Cray UNICOS 9
  echo $ac_n "checking for listmntent of Cray/Unicos-9""... $ac_c" 1>&6
! echo "configure:4299: checking for listmntent of Cray/Unicos-9" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_cray_listmntent'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    fu_cv_sys_mounted_cray_listmntent=no
  cat > conftest.$ac_ext <<EOF
! #line 4305 "configure"
  #include "confdefs.h"
  #ifdef _CRAY
  yes
--- 4297,4309 ----
  if test -z "$list_mounted_fs"; then
  # Cray UNICOS 9
  echo $ac_n "checking for listmntent of Cray/Unicos-9""... $ac_c" 1>&6
! echo "configure:4301: checking for listmntent of Cray/Unicos-9" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_cray_listmntent'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    fu_cv_sys_mounted_cray_listmntent=no
  cat > conftest.$ac_ext <<EOF
! #line 4307 "configure"
  #include "confdefs.h"
  #ifdef _CRAY
  yes
***************
*** 4339,4345 ****
  if test -z "$list_mounted_fs"; then
  # 4.3BSD, SunOS, HP-UX, Dynix, Irix
  echo $ac_n "checking for one-argument getmntent function""... $ac_c" 1>&6
! echo "configure:4343: checking for one-argument getmntent function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntent1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4341,4347 ----
  if test -z "$list_mounted_fs"; then
  # 4.3BSD, SunOS, HP-UX, Dynix, Irix
  echo $ac_n "checking for one-argument getmntent function""... $ac_c" 1>&6
! echo "configure:4345: checking for one-argument getmntent function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntent1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4361,4372 ****
  if test -z "$list_mounted_fs"; then
  # SVR4
  echo $ac_n "checking for two-argument getmntent function""... $ac_c" 1>&6
! echo "configure:4365: checking for two-argument getmntent function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntent2'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4370 "configure"
  #include "confdefs.h"
  #include <sys/mnttab.h>
  EOF
--- 4363,4374 ----
  if test -z "$list_mounted_fs"; then
  # SVR4
  echo $ac_n "checking for two-argument getmntent function""... $ac_c" 1>&6
! echo "configure:4367: checking for two-argument getmntent function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntent2'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4372 "configure"
  #include "confdefs.h"
  #include <sys/mnttab.h>
  EOF
***************
*** 4401,4412 ****
  if test -z "$list_mounted_fs"; then
  # DEC Alpha running OSF/1.
  echo $ac_n "checking for getfsstat function""... $ac_c" 1>&6
! echo "configure:4405: checking for getfsstat function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getsstat'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4410 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 4403,4414 ----
  if test -z "$list_mounted_fs"; then
  # DEC Alpha running OSF/1.
  echo $ac_n "checking for getfsstat function""... $ac_c" 1>&6
! echo "configure:4407: checking for getfsstat function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getsstat'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4412 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 4417,4423 ****
  int numsys = getfsstat ((struct statfs *)0, 0L, MNT_WAIT); 
  ; return 0; }
  EOF
! if { (eval echo configure:4421: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_mounted_getsstat=yes
  else
--- 4419,4425 ----
  int numsys = getfsstat ((struct statfs *)0, 0L, MNT_WAIT); 
  ; return 0; }
  EOF
! if { (eval echo configure:4423: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_mounted_getsstat=yes
  else
***************
*** 4442,4458 ****
  if test -z "$list_mounted_fs"; then
  # AIX.
  echo $ac_n "checking for mntctl function and struct vmount""... $ac_c" 1>&6
! echo "configure:4446: checking for mntctl function and struct vmount" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_vmount'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4451 "configure"
  #include "confdefs.h"
  #include <fshelp.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4456: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4444,4460 ----
  if test -z "$list_mounted_fs"; then
  # AIX.
  echo $ac_n "checking for mntctl function and struct vmount""... $ac_c" 1>&6
! echo "configure:4448: checking for mntctl function and struct vmount" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_vmount'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4453 "configure"
  #include "confdefs.h"
  #include <fshelp.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4458: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4480,4491 ****
  if test -z "$list_mounted_fs"; then
  # SVR3
  echo $ac_n "checking for FIXME existence of three headers""... $ac_c" 1>&6
! echo "configure:4484: checking for FIXME existence of three headers" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_fread_fstyp'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4489 "configure"
  #include "confdefs.h"
  
  #include <sys/statfs.h>
--- 4482,4493 ----
  if test -z "$list_mounted_fs"; then
  # SVR3
  echo $ac_n "checking for FIXME existence of three headers""... $ac_c" 1>&6
! echo "configure:4486: checking for FIXME existence of three headers" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_fread_fstyp'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4491 "configure"
  #include "confdefs.h"
  
  #include <sys/statfs.h>
***************
*** 4493,4499 ****
  #include <mnttab.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4497: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4495,4501 ----
  #include <mnttab.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4499: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4521,4527 ****
  if test -z "$list_mounted_fs"; then
  # 4.4BSD and DEC OSF/1.
  echo $ac_n "checking for getmntinfo function""... $ac_c" 1>&6
! echo "configure:4525: checking for getmntinfo function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntinfo'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4523,4529 ----
  if test -z "$list_mounted_fs"; then
  # 4.4BSD and DEC OSF/1.
  echo $ac_n "checking for getmntinfo function""... $ac_c" 1>&6
! echo "configure:4527: checking for getmntinfo function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmntinfo'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4529,4535 ****
  ok=
  if test $ac_cv_func_getmntinfo = yes; then
  cat > conftest.$ac_ext <<EOF
! #line 4533 "configure"
  #include "confdefs.h"
  #include <sys/mount.h>
  EOF
--- 4531,4537 ----
  ok=
  if test $ac_cv_func_getmntinfo = yes; then
  cat > conftest.$ac_ext <<EOF
! #line 4535 "configure"
  #include "confdefs.h"
  #include <sys/mount.h>
  EOF
***************
*** 4562,4580 ****
  if test -z "$list_mounted_fs"; then
  # Ultrix
  echo $ac_n "checking for getmnt function""... $ac_c" 1>&6
! echo "configure:4566: checking for getmnt function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmnt'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4571 "configure"
  #include "confdefs.h"
  
  #include <sys/fs_types.h>
  #include <sys/mount.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4578: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4564,4582 ----
  if test -z "$list_mounted_fs"; then
  # Ultrix
  echo $ac_n "checking for getmnt function""... $ac_c" 1>&6
! echo "configure:4568: checking for getmnt function" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_getmnt'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4573 "configure"
  #include "confdefs.h"
  
  #include <sys/fs_types.h>
  #include <sys/mount.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4580: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4602,4618 ****
  if test -z "$list_mounted_fs"; then
  # SVR2
  echo $ac_n "checking whether it is possible to resort to fread on /etc/mnttab""... $ac_c" 1>&6
! echo "configure:4606: checking whether it is possible to resort to fread on /etc/mnttab" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_fread'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4611 "configure"
  #include "confdefs.h"
  #include <mnttab.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4616: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4604,4620 ----
  if test -z "$list_mounted_fs"; then
  # SVR2
  echo $ac_n "checking whether it is possible to resort to fread on /etc/mnttab""... $ac_c" 1>&6
! echo "configure:4608: checking whether it is possible to resort to fread on /etc/mnttab" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_mounted_fread'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4613 "configure"
  #include "confdefs.h"
  #include <mnttab.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4618: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4644,4650 ****
  fi
  
  echo "checking how to get filesystem space usage" 1>&6
! echo "configure:4648: checking how to get filesystem space usage" >&5
  space=no
  
  # Perform only the link test since it seems there are no variants of the
--- 4646,4652 ----
  fi
  
  echo "checking how to get filesystem space usage" 1>&6
! echo "configure:4650: checking how to get filesystem space usage" >&5
  space=no
  
  # Perform only the link test since it seems there are no variants of the
***************
*** 4656,4667 ****
  if test $space = no; then
  # SVR4
  echo $ac_n "checking statvfs function (SVR4)""... $ac_c" 1>&6
! echo "configure:4660: checking statvfs function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4665 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statvfs.h>
--- 4658,4669 ----
  if test $space = no; then
  # SVR4
  echo $ac_n "checking statvfs function (SVR4)""... $ac_c" 1>&6
! echo "configure:4662: checking statvfs function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4667 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statvfs.h>
***************
*** 4669,4675 ****
  struct statvfs fsd; statvfs (0, &fsd);
  ; return 0; }
  EOF
! if { (eval echo configure:4673: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_stat_statvfs=yes
  else
--- 4671,4677 ----
  struct statvfs fsd; statvfs (0, &fsd);
  ; return 0; }
  EOF
! if { (eval echo configure:4675: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_stat_statvfs=yes
  else
***************
*** 4694,4700 ****
  if test $space = no; then
  # DEC Alpha running OSF/1
  echo $ac_n "checking for 3-argument statfs function (DEC OSF/1)""... $ac_c" 1>&6
! echo "configure:4698: checking for 3-argument statfs function (DEC OSF/1)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs3_osf1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4696,4702 ----
  if test $space = no; then
  # DEC Alpha running OSF/1
  echo $ac_n "checking for 3-argument statfs function (DEC OSF/1)""... $ac_c" 1>&6
! echo "configure:4700: checking for 3-argument statfs function (DEC OSF/1)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs3_osf1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4702,4708 ****
    fu_cv_sys_stat_statfs3_osf1=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4706 "configure"
  #include "confdefs.h"
  
  #include <sys/param.h>
--- 4704,4710 ----
    fu_cv_sys_stat_statfs3_osf1=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4708 "configure"
  #include "confdefs.h"
  
  #include <sys/param.h>
***************
*** 4715,4721 ****
  exit (statfs (".", &fsd, sizeof (struct statfs)));
  }
  EOF
! if { (eval echo configure:4719: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs3_osf1=yes
  else
--- 4717,4723 ----
  exit (statfs (".", &fsd, sizeof (struct statfs)));
  }
  EOF
! if { (eval echo configure:4721: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs3_osf1=yes
  else
***************
*** 4742,4748 ****
  if test $space = no; then
  # AIX
  echo $ac_n "checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)""... $ac_c" 1>&6
! echo "configure:4746: checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_bsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4744,4750 ----
  if test $space = no; then
  # AIX
  echo $ac_n "checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)""... $ac_c" 1>&6
! echo "configure:4748: checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_bsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4750,4756 ****
    fu_cv_sys_stat_statfs2_bsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4754 "configure"
  #include "confdefs.h"
  
  #ifdef HAVE_SYS_PARAM_H
--- 4752,4758 ----
    fu_cv_sys_stat_statfs2_bsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4756 "configure"
  #include "confdefs.h"
  
  #ifdef HAVE_SYS_PARAM_H
***************
*** 4769,4775 ****
  exit (statfs (".", &fsd));
  }
  EOF
! if { (eval echo configure:4773: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_bsize=yes
  else
--- 4771,4777 ----
  exit (statfs (".", &fsd));
  }
  EOF
! if { (eval echo configure:4775: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_bsize=yes
  else
***************
*** 4796,4802 ****
  if test $space = no; then
  # SVR3
  echo $ac_n "checking for four-argument statfs (AIX-3.2.5, SVR3)""... $ac_c" 1>&6
! echo "configure:4800: checking for four-argument statfs (AIX-3.2.5, SVR3)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs4'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4798,4804 ----
  if test $space = no; then
  # SVR3
  echo $ac_n "checking for four-argument statfs (AIX-3.2.5, SVR3)""... $ac_c" 1>&6
! echo "configure:4802: checking for four-argument statfs (AIX-3.2.5, SVR3)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs4'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4804,4810 ****
    fu_cv_sys_stat_statfs4=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4808 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statfs.h>
--- 4806,4812 ----
    fu_cv_sys_stat_statfs4=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4810 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statfs.h>
***************
*** 4814,4820 ****
  exit (statfs (".", &fsd, sizeof fsd, 0));
  }
  EOF
! if { (eval echo configure:4818: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs4=yes
  else
--- 4816,4822 ----
  exit (statfs (".", &fsd, sizeof fsd, 0));
  }
  EOF
! if { (eval echo configure:4820: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs4=yes
  else
***************
*** 4841,4847 ****
  if test $space = no; then
  # 4.4BSD and NetBSD
  echo $ac_n "checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)""... $ac_c" 1>&6
! echo "configure:4845: checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_fsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4843,4849 ----
  if test $space = no; then
  # 4.4BSD and NetBSD
  echo $ac_n "checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)""... $ac_c" 1>&6
! echo "configure:4847: checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_fsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4849,4855 ****
    fu_cv_sys_stat_statfs2_fsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4853 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
--- 4851,4857 ----
    fu_cv_sys_stat_statfs2_fsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4855 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
***************
*** 4865,4871 ****
  exit (statfs (".", &fsd));
  }
  EOF
! if { (eval echo configure:4869: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_fsize=yes
  else
--- 4867,4873 ----
  exit (statfs (".", &fsd));
  }
  EOF
! if { (eval echo configure:4871: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_fsize=yes
  else
***************
*** 4892,4898 ****
  if test $space = no; then
  # Ultrix
  echo $ac_n "checking for two-argument statfs with struct fs_data (Ultrix)""... $ac_c" 1>&6
! echo "configure:4896: checking for two-argument statfs with struct fs_data (Ultrix)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_fs_data'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4894,4900 ----
  if test $space = no; then
  # Ultrix
  echo $ac_n "checking for two-argument statfs with struct fs_data (Ultrix)""... $ac_c" 1>&6
! echo "configure:4898: checking for two-argument statfs with struct fs_data (Ultrix)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_fs_data'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4900,4906 ****
    fu_cv_sys_stat_fs_data=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4904 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
--- 4902,4908 ----
    fu_cv_sys_stat_fs_data=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4906 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
***************
*** 4920,4926 ****
  exit (statfs (".", &fsd) != 1);
  }
  EOF
! if { (eval echo configure:4924: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_fs_data=yes
  else
--- 4922,4928 ----
  exit (statfs (".", &fsd) != 1);
  }
  EOF
! if { (eval echo configure:4926: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_fs_data=yes
  else
***************
*** 4947,4958 ****
  if test $space = no; then
  # SVR2
  cat > conftest.$ac_ext <<EOF
! #line 4951 "configure"
  #include "confdefs.h"
  #include <sys/filsys.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4956: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4949,4960 ----
  if test $space = no; then
  # SVR2
  cat > conftest.$ac_ext <<EOF
! #line 4953 "configure"
  #include "confdefs.h"
  #include <sys/filsys.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4958: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4977,4988 ****
  for ac_func in ftruncate
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4981: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4986 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 4979,4990 ----
  for ac_func in ftruncate
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4983: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4988 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5005,5011 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5009: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5007,5013 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5011: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5033,5044 ****
  
  if test "$ftruncate_missing" = yes; then
  echo $ac_n "checking fcntl emulation of ftruncate""... $ac_c" 1>&6
! echo "configure:5037: checking fcntl emulation of ftruncate" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_ftruncate_emulation'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5042 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 5035,5046 ----
  
  if test "$ftruncate_missing" = yes; then
  echo $ac_n "checking fcntl emulation of ftruncate""... $ac_c" 1>&6
! echo "configure:5039: checking fcntl emulation of ftruncate" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_ftruncate_emulation'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5044 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 5051,5057 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5055: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_ftruncate_emulation=yes
  else
--- 5053,5059 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5057: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_ftruncate_emulation=yes
  else
***************
*** 5079,5090 ****
  # If <sys/vfs.h> exists and struct statfs has a member named f_spare,
  # enable the work-around code in fsusage.c.
  echo $ac_n "checking for statfs that truncates block counts""... $ac_c" 1>&6
! echo "configure:5083: checking for statfs that truncates block counts" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_truncating_statfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5088 "configure"
  #include "confdefs.h"
  
  #if !defined(sun) && !defined(__sun)
--- 5081,5092 ----
  # If <sys/vfs.h> exists and struct statfs has a member named f_spare,
  # enable the work-around code in fsusage.c.
  echo $ac_n "checking for statfs that truncates block counts""... $ac_c" 1>&6
! echo "configure:5085: checking for statfs that truncates block counts" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_truncating_statfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5090 "configure"
  #include "confdefs.h"
  
  #if !defined(sun) && !defined(__sun)
***************
*** 5096,5102 ****
  struct statfs t; long c = *(t.f_spare);
  ; return 0; }
  EOF
! if { (eval echo configure:5100: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    fu_cv_sys_truncating_statfs=yes
  else
--- 5098,5104 ----
  struct statfs t; long c = *(t.f_spare);
  ; return 0; }
  EOF
! if { (eval echo configure:5102: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    fu_cv_sys_truncating_statfs=yes
  else
***************
*** 5117,5123 ****
  echo "$ac_t""$fu_cv_sys_truncating_statfs" 1>&6
  
  echo "checking for AFS" 1>&6
! echo "configure:5121: checking for AFS" >&5
  test -d /afs && cat >> confdefs.h <<\EOF
  #define AFS 1
  EOF
--- 5119,5125 ----
  echo "$ac_t""$fu_cv_sys_truncating_statfs" 1>&6
  
  echo "checking for AFS" 1>&6
! echo "configure:5123: checking for AFS" >&5
  test -d /afs && cat >> confdefs.h <<\EOF
  #define AFS 1
  EOF
***************
*** 5129,5137 ****
      HAVE_POS=yes
  else
    echo $ac_n "checking for pOS""... $ac_c" 1>&6
! echo "configure:5133: checking for pOS" >&5
    cat > conftest.$ac_ext <<EOF
! #line 5135 "configure"
  #include "confdefs.h"
  #ifdef __POS__
      yes
--- 5131,5139 ----
      HAVE_POS=yes
  else
    echo $ac_n "checking for pOS""... $ac_c" 1>&6
! echo "configure:5135: checking for pOS" >&5
    cat > conftest.$ac_ext <<EOF
! #line 5137 "configure"
  #include "confdefs.h"
  #ifdef __POS__
      yes
***************
*** 5168,5183 ****
    else
      if [ "x$ac_cv_header_ncurses_h" = "xno" ]; then
        echo $ac_n "checking for attr_t in curses.h""... $ac_c" 1>&6
! echo "configure:5172: checking for attr_t in curses.h" >&5
        cat > conftest.$ac_ext <<EOF
! #line 5174 "configure"
  #include "confdefs.h"
  #include <curses.h>
  int main() {
  { attr_t a; a = A_NORMAL; }
  ; return 0; }
  EOF
! if { (eval echo configure:5181: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
--- 5170,5185 ----
    else
      if [ "x$ac_cv_header_ncurses_h" = "xno" ]; then
        echo $ac_n "checking for attr_t in curses.h""... $ac_c" 1>&6
! echo "configure:5174: checking for attr_t in curses.h" >&5
        cat > conftest.$ac_ext <<EOF
! #line 5176 "configure"
  #include "confdefs.h"
  #include <curses.h>
  int main() {
  { attr_t a; a = A_NORMAL; }
  ; return 0; }
  EOF
! if { (eval echo configure:5183: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
***************
*** 5194,5209 ****
  rm -f conftest*
      else
        echo $ac_n "checking for attr_t in ncurses.h""... $ac_c" 1>&6
! echo "configure:5198: checking for attr_t in ncurses.h" >&5
        cat > conftest.$ac_ext <<EOF
! #line 5200 "configure"
  #include "confdefs.h"
  #include <ncurses.h>
  int main() {
  { attr_t a; a = A_NORMAL; }
  ; return 0; }
  EOF
! if { (eval echo configure:5207: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
--- 5196,5211 ----
  rm -f conftest*
      else
        echo $ac_n "checking for attr_t in ncurses.h""... $ac_c" 1>&6
! echo "configure:5200: checking for attr_t in ncurses.h" >&5
        cat > conftest.$ac_ext <<EOF
! #line 5202 "configure"
  #include "confdefs.h"
  #include <ncurses.h>
  int main() {
  { attr_t a; a = A_NORMAL; }
  ; return 0; }
  EOF
! if { (eval echo configure:5209: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  else
***************
*** 5223,5234 ****
  fi
  
  echo $ac_n "checking for pthread library""... $ac_c" 1>&6
! echo "configure:5227: checking for pthread library" >&5
  TMP_SAVE_CFLAGS=$CFLAGS
  TMP_SAVE_LIBS=$LIBS
  LIBS="$LIBS -lpthread"
  cat > conftest.$ac_ext <<EOF
! #line 5232 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
--- 5225,5236 ----
  fi
  
  echo $ac_n "checking for pthread library""... $ac_c" 1>&6
! echo "configure:5229: checking for pthread library" >&5
  TMP_SAVE_CFLAGS=$CFLAGS
  TMP_SAVE_LIBS=$LIBS
  LIBS="$LIBS -lpthread"
  cat > conftest.$ac_ext <<EOF
! #line 5234 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
***************
*** 5242,5248 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5246: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    HAVE_PTHREAD_LIB=yes
  echo "$ac_t""yes" 1>&6
--- 5244,5250 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5248: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    HAVE_PTHREAD_LIB=yes
  echo "$ac_t""yes" 1>&6
***************
*** 5258,5270 ****
  LIBS=$TMP_SAVE_LIBS
  
  echo $ac_n "checking for DirectX""... $ac_c" 1>&6
! echo "configure:5262: checking for DirectX" >&5
  TMP_SAVE_CFLAGS=$CFLAGS
  TMP_SAVE_LIBS=$LIBS
  CFLAGS="$CFLAGS $X_CFLAGS"
  LIBS="$LIBS -lddraw"
  cat > conftest.$ac_ext <<EOF
! #line 5268 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
--- 5260,5272 ----
  LIBS=$TMP_SAVE_LIBS
  
  echo $ac_n "checking for DirectX""... $ac_c" 1>&6
! echo "configure:5264: checking for DirectX" >&5
  TMP_SAVE_CFLAGS=$CFLAGS
  TMP_SAVE_LIBS=$LIBS
  CFLAGS="$CFLAGS $X_CFLAGS"
  LIBS="$LIBS -lddraw"
  cat > conftest.$ac_ext <<EOF
! #line 5270 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
***************
*** 5280,5286 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5284: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    HAVE_DIRECTX=yes
  echo "$ac_t""yes" 1>&6
--- 5282,5288 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5286: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    HAVE_DIRECTX=yes
  echo "$ac_t""yes" 1>&6
***************
*** 5301,5306 ****
--- 5303,5309 ----
  WANT_UI=dunno
  WANT_NCURSES_UI=no
  WANT_DGA=no
+ WANT_JIT=no
  WANT_VIDMODE=no
  
  # Check whether --enable-profiling or --disable-profiling was given.
***************
*** 5357,5362 ****
--- 5360,5371 ----
    WANT_UI=$enableval
  fi
  
+ # Check whether --enable-jit or --disable-jit was given.
+ if test "${enable_jit+set}" = set; then
+   enableval="$enable_jit"
+   WANT_JIT=$enableval
+ fi
+ 
  # Check whether --with-hostcc or --without-hostcc was given.
  if test "${with_hostcc+set}" = set; then
    withval="$with_hostcc"
***************
*** 5443,5449 ****
    TMP_SAVE_LIBS=$LIBS
    LIBS="$X_LIBS $LIBS"
    echo $ac_n "checking for XF86DGAQueryExtension in -lXxf86dga""... $ac_c" 1>&6
! echo "configure:5447: checking for XF86DGAQueryExtension in -lXxf86dga" >&5
  ac_lib_var=`echo Xxf86dga'_'XF86DGAQueryExtension | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 5452,5458 ----
    TMP_SAVE_LIBS=$LIBS
    LIBS="$X_LIBS $LIBS"
    echo $ac_n "checking for XF86DGAQueryExtension in -lXxf86dga""... $ac_c" 1>&6
! echo "configure:5456: checking for XF86DGAQueryExtension in -lXxf86dga" >&5
  ac_lib_var=`echo Xxf86dga'_'XF86DGAQueryExtension | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 5451,5457 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lXxf86dga  $X_PRE_LIBS -lXext -lX11 $X_EXTRA_LIBS  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5455 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 5460,5466 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lXxf86dga  $X_PRE_LIBS -lXext -lX11 $X_EXTRA_LIBS  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5464 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 5462,5468 ****
  XF86DGAQueryExtension()
  ; return 0; }
  EOF
! if { (eval echo configure:5466: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 5471,5477 ----
  XF86DGAQueryExtension()
  ; return 0; }
  EOF
! if { (eval echo configure:5475: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 5495,5501 ****
    TMP_SAVE_LIBS=$LIBS
    LIBS="$X_LIBS $LIBS"
    echo $ac_n "checking for XF86VidModeQueryExtension in -lXxf86vm""... $ac_c" 1>&6
! echo "configure:5499: checking for XF86VidModeQueryExtension in -lXxf86vm" >&5
  ac_lib_var=`echo Xxf86vm'_'XF86VidModeQueryExtension | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 5504,5510 ----
    TMP_SAVE_LIBS=$LIBS
    LIBS="$X_LIBS $LIBS"
    echo $ac_n "checking for XF86VidModeQueryExtension in -lXxf86vm""... $ac_c" 1>&6
! echo "configure:5508: checking for XF86VidModeQueryExtension in -lXxf86vm" >&5
  ac_lib_var=`echo Xxf86vm'_'XF86VidModeQueryExtension | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 5503,5509 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lXxf86vm  $X_PRE_LIBS -lXext -lX11 $X_EXTRA_LIBS  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5507 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 5512,5518 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lXxf86vm  $X_PRE_LIBS -lXext -lX11 $X_EXTRA_LIBS  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5516 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 5514,5520 ****
  XF86VidModeQueryExtension()
  ; return 0; }
  EOF
! if { (eval echo configure:5518: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 5523,5529 ----
  XF86VidModeQueryExtension()
  ; return 0; }
  EOF
! if { (eval echo configure:5527: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 5584,5590 ****
    # Extract the first word of "gtk-config", so it can be a program name with args.
  set dummy gtk-config; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:5588: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_GTK_CONFIG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 5593,5599 ----
    # Extract the first word of "gtk-config", so it can be a program name with args.
  set dummy gtk-config; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:5597: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_path_GTK_CONFIG'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 5619,5625 ****
  
    min_gtk_version=0.99.7
    echo $ac_n "checking for GTK - version >= $min_gtk_version""... $ac_c" 1>&6
! echo "configure:5623: checking for GTK - version >= $min_gtk_version" >&5
    no_gtk=""
    if test "$GTK_CONFIG" = "no" ; then
      no_gtk=yes
--- 5628,5634 ----
  
    min_gtk_version=0.99.7
    echo $ac_n "checking for GTK - version >= $min_gtk_version""... $ac_c" 1>&6
! echo "configure:5632: checking for GTK - version >= $min_gtk_version" >&5
    no_gtk=""
    if test "$GTK_CONFIG" = "no" ; then
      no_gtk=yes
***************
*** 5642,5648 ****
    echo $ac_n "cross compiling; assumed OK... $ac_c"
  else
    cat > conftest.$ac_ext <<EOF
! #line 5646 "configure"
  #include "confdefs.h"
  
  #include <gtk/gtk.h>
--- 5651,5657 ----
    echo $ac_n "cross compiling; assumed OK... $ac_c"
  else
    cat > conftest.$ac_ext <<EOF
! #line 5655 "configure"
  #include "confdefs.h"
  
  #include <gtk/gtk.h>
***************
*** 5705,5711 ****
  }
  
  EOF
! if { (eval echo configure:5709: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 5714,5720 ----
  }
  
  EOF
! if { (eval echo configure:5718: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 5739,5745 ****
            CFLAGS="$CFLAGS $GTK_CFLAGS"
            LIBS="$LIBS $GTK_LIBS"
            cat > conftest.$ac_ext <<EOF
! #line 5743 "configure"
  #include "confdefs.h"
  
  #include <gtk/gtk.h>
--- 5748,5754 ----
            CFLAGS="$CFLAGS $GTK_CFLAGS"
            LIBS="$LIBS $GTK_LIBS"
            cat > conftest.$ac_ext <<EOF
! #line 5752 "configure"
  #include "confdefs.h"
  
  #include <gtk/gtk.h>
***************
*** 5749,5755 ****
   return ((gtk_major_version) || (gtk_minor_version) || (gtk_micro_version)); 
  ; return 0; }
  EOF
! if { (eval echo configure:5753: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
     echo "*** The test program compiled, but did not run. This usually means"
            echo "*** that the run-time linker is not finding GTK or finding the wrong"
--- 5758,5764 ----
   return ((gtk_major_version) || (gtk_minor_version) || (gtk_micro_version)); 
  ; return 0; }
  EOF
! if { (eval echo configure:5762: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
     echo "*** The test program compiled, but did not run. This usually means"
            echo "*** that the run-time linker is not finding GTK or finding the wrong"
***************
*** 5792,5804 ****
  SHM_SUPPORT_LINKS=0
  if [ "x$no_x" != "xyes" -a "x$ac_cv_header_sys_ipc_h" = "xyes" -a "x$ac_cv_header_sys_shm_h" = "xyes" ]; then
    echo $ac_n "checking whether the X11 MIT-SHM extension can be compiled in""... $ac_c" 1>&6
! echo "configure:5796: checking whether the X11 MIT-SHM extension can be compiled in" >&5
    TMP_SAVE_CFLAGS=$CFLAGS
    TMP_SAVE_LIBS=$LIBS
    CFLAGS="$CFLAGS $X_CFLAGS"
    LIBS="$X_LIBS $LIBS $X_PRE_LIBS -lX11 -lXext $X_EXTRA_LIBS"
    cat > conftest.$ac_ext <<EOF
! #line 5802 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
--- 5801,5813 ----
  SHM_SUPPORT_LINKS=0
  if [ "x$no_x" != "xyes" -a "x$ac_cv_header_sys_ipc_h" = "xyes" -a "x$ac_cv_header_sys_shm_h" = "xyes" ]; then
    echo $ac_n "checking whether the X11 MIT-SHM extension can be compiled in""... $ac_c" 1>&6
! echo "configure:5805: checking whether the X11 MIT-SHM extension can be compiled in" >&5
    TMP_SAVE_CFLAGS=$CFLAGS
    TMP_SAVE_LIBS=$LIBS
    CFLAGS="$CFLAGS $X_CFLAGS"
    LIBS="$X_LIBS $LIBS $X_PRE_LIBS -lX11 -lXext $X_EXTRA_LIBS"
    cat > conftest.$ac_ext <<EOF
! #line 5811 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
***************
*** 5822,5828 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5826: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    SHM_SUPPORT_LINKS=1
  echo "$ac_t""yes" 1>&6
--- 5831,5837 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5835: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    SHM_SUPPORT_LINKS=1
  echo "$ac_t""yes" 1>&6
***************
*** 5842,5848 ****
  DEBUGOBJS="debug.o"
  
  echo $ac_n "checking which target to use""... $ac_c" 1>&6
! echo "configure:5846: checking which target to use" >&5
  
  if [ "x$WANT_SDLGFX" = "xyes" ]; then
    echo "$ac_t""SDL" 1>&6
--- 5851,5857 ----
  DEBUGOBJS="debug.o"
  
  echo $ac_n "checking which target to use""... $ac_c" 1>&6
! echo "configure:5855: checking which target to use" >&5
  
  if [ "x$WANT_SDLGFX" = "xyes" ]; then
    echo "$ac_t""SDL" 1>&6
***************
*** 5973,5986 ****
      if [ "x$no_gtk" = "xyes" ]; then
        echo "Did not find gtk+, disabling user interface"
        GTK_CFLAGS=
!       TK_LIBS=
        if [ "x$WANT_UI" = "xyes" ]; then
          NR_ERRORS=`expr $NR_ERRORS + 1`
        fi
      else
        echo "Using gtk+ GUI."
        NEED_THREAD_SUPPORT=yes
!       DDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DUSING_GTK_GUI"
        GUIOBJS=gtkui.o
      fi
    else 
--- 5982,5995 ----
      if [ "x$no_gtk" = "xyes" ]; then
        echo "Did not find gtk+, disabling user interface"
        GTK_CFLAGS=
!       GUIOBJS=nogui.o
        if [ "x$WANT_UI" = "xyes" ]; then
          NR_ERRORS=`expr $NR_ERRORS + 1`
        fi
      else
        echo "Using gtk+ GUI."
        NEED_THREAD_SUPPORT=yes
!       ADDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DUSING_GTK_GUI"
        GUIOBJS=gtkui.o
      fi
    else 
***************
*** 5998,6003 ****
--- 6007,6018 ----
    GUIOBJS=nogui.o
  fi
  
+ JITOBJS=""
+ if [ "x$WANT_JIT" = "xyes" ]; then
+   JITOBJS="compstbl.o compemu.o compemu_support.o compemu_fpp.o cpustbl_nf.o cpufast_nf.o"
+   ADDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DJIT -DNATMEM_OFFSET=0x50000000"
+ fi
+ 
  GFXOBJS="$GFXOBJS $GUIOBJS"
   
  
***************
*** 6025,6033 ****
  CPUOBJS=cpuemu.o
  
  echo $ac_n "checking for GCC 2.7 or higher""... $ac_c" 1>&6
! echo "configure:6029: checking for GCC 2.7 or higher" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6031 "configure"
  #include "confdefs.h"
  #if __GNUC__ - 1 > 1 || __GNUC_MINOR__ - 1 > 5
    yes
--- 6040,6048 ----
  CPUOBJS=cpuemu.o
  
  echo $ac_n "checking for GCC 2.7 or higher""... $ac_c" 1>&6
! echo "configure:6044: checking for GCC 2.7 or higher" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6046 "configure"
  #include "confdefs.h"
  #if __GNUC__ - 1 > 1 || __GNUC_MINOR__ - 1 > 5
    yes
***************
*** 6058,6066 ****
  
  if [ "x$ac_cv_header_features_h" = "xyes" ]; then
    echo $ac_n "checking for glibc-2.0 or higher""... $ac_c" 1>&6
! echo "configure:6062: checking for glibc-2.0 or higher" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6064 "configure"
  #include "confdefs.h"
  #include <features.h>
  #if __GLIBC__ - 1 >= 1
--- 6073,6081 ----
  
  if [ "x$ac_cv_header_features_h" = "xyes" ]; then
    echo $ac_n "checking for glibc-2.0 or higher""... $ac_c" 1>&6
! echo "configure:6077: checking for glibc-2.0 or higher" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6079 "configure"
  #include "confdefs.h"
  #include <features.h>
  #if __GLIBC__ - 1 >= 1
***************
*** 6107,6115 ****
  fi
  
  echo $ac_n "checking for x86 target CPU""... $ac_c" 1>&6
! echo "configure:6111: checking for x86 target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6113 "configure"
  #include "confdefs.h"
  
  #ifdef __i386__
--- 6122,6130 ----
  fi
  
  echo $ac_n "checking for x86 target CPU""... $ac_c" 1>&6
! echo "configure:6126: checking for x86 target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6128 "configure"
  #include "confdefs.h"
  
  #ifdef __i386__
***************
*** 6129,6137 ****
  
  
  echo $ac_n "checking for m68k target CPU""... $ac_c" 1>&6
! echo "configure:6133: checking for m68k target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6135 "configure"
  #include "confdefs.h"
  
  #ifdef __m68k__
--- 6144,6152 ----
  
  
  echo $ac_n "checking for m68k target CPU""... $ac_c" 1>&6
! echo "configure:6148: checking for m68k target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6150 "configure"
  #include "confdefs.h"
  
  #ifdef __m68k__
***************
*** 6151,6159 ****
  
  
  echo $ac_n "checking for ppc target CPU""... $ac_c" 1>&6
! echo "configure:6155: checking for ppc target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6157 "configure"
  #include "confdefs.h"
  
  #ifdef __powerpc__
--- 6166,6174 ----
  
  
  echo $ac_n "checking for ppc target CPU""... $ac_c" 1>&6
! echo "configure:6170: checking for ppc target CPU" >&5
  cat > conftest.$ac_ext <<EOF
! #line 6172 "configure"
  #include "confdefs.h"
  
  #ifdef __powerpc__
***************
*** 6182,6188 ****
  
  
  echo $ac_n "checking whether assembler symbols need an underscore""... $ac_c" 1>&6
! echo "configure:6186: checking whether assembler symbols need an underscore" >&5
  cat >conftest1.S << EOF
  	.text
  	.globl _symbol
--- 6197,6203 ----
  
  
  echo $ac_n "checking whether assembler symbols need an underscore""... $ac_c" 1>&6
! echo "configure:6201: checking whether assembler symbols need an underscore" >&5
  cat >conftest1.S << EOF
  	.text
  	.globl _symbol
***************
*** 6219,6232 ****
    SAVECFLAGS=$CFLAGS
    CFLAGS="$CFLAGS -mno-schedule-prologue"
    cat > conftest.$ac_ext <<EOF
! #line 6223 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6230: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    NO_SCHED_CFLAGS="-mno-schedule-prologue"
  else
--- 6234,6247 ----
    SAVECFLAGS=$CFLAGS
    CFLAGS="$CFLAGS -mno-schedule-prologue"
    cat > conftest.$ac_ext <<EOF
! #line 6238 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6245: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    NO_SCHED_CFLAGS="-mno-schedule-prologue"
  else
***************
*** 6241,6254 ****
    SAVECFLAGS=$CFLAGS
    CFLAGS="$CFLAGS -mpreferred-stack-boundary=2"
    cat > conftest.$ac_ext <<EOF
! #line 6245 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6252: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    SAVECFLAGS=$CFLAGS
  else
--- 6256,6269 ----
    SAVECFLAGS=$CFLAGS
    CFLAGS="$CFLAGS -mpreferred-stack-boundary=2"
    cat > conftest.$ac_ext <<EOF
! #line 6260 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6267: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    SAVECFLAGS=$CFLAGS
  else
***************
*** 6265,6278 ****
    CFLAGS="$CFLAGS -fno-exceptions"
    NOEXCEPTIONS=no
    cat > conftest.$ac_ext <<EOF
! #line 6269 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6276: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    NOEXCEPTIONS=yes
  else
--- 6280,6293 ----
    CFLAGS="$CFLAGS -fno-exceptions"
    NOEXCEPTIONS=no
    cat > conftest.$ac_ext <<EOF
! #line 6284 "configure"
  #include "confdefs.h"
  
  int main() {
  int main(){return 0;}
  ; return 0; }
  EOF
! if { (eval echo configure:6291: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    NOEXCEPTIONS=yes
  else
***************
*** 6383,6391 ****
  HAVE_USS_SOUND=no
  if [ "x$ac_cv_header_sys_soundcard_h" = "xyes" -o "x$ac_cv_header_machine_soundcard_h" = "xyes" ]; then
      echo $ac_n "checking whether sys/soundcard.h or machine/soundcard.h works""... $ac_c" 1>&6
! echo "configure:6387: checking whether sys/soundcard.h or machine/soundcard.h works" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6389 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
--- 6398,6406 ----
  HAVE_USS_SOUND=no
  if [ "x$ac_cv_header_sys_soundcard_h" = "xyes" -o "x$ac_cv_header_machine_soundcard_h" = "xyes" ]; then
      echo $ac_n "checking whether sys/soundcard.h or machine/soundcard.h works""... $ac_c" 1>&6
! echo "configure:6402: checking whether sys/soundcard.h or machine/soundcard.h works" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6404 "configure"
  #include "confdefs.h"
  
  #include "confdefs.h"
***************
*** 6400,6406 ****
  int soundfd; ioctl (soundfd, SNDCTL_DSP_GETFMTS, 0);
  ; return 0; }
  EOF
! if { (eval echo configure:6404: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  HAVE_USS_SOUND=yes
--- 6415,6421 ----
  int soundfd; ioctl (soundfd, SNDCTL_DSP_GETFMTS, 0);
  ; return 0; }
  EOF
! if { (eval echo configure:6419: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    echo "$ac_t""yes" 1>&6
  HAVE_USS_SOUND=yes
***************
*** 6418,6424 ****
  fi
  
  echo $ac_n "checking which sound system to use""... $ac_c" 1>&6
! echo "configure:6422: checking which sound system to use" >&5
  # Check whether --enable-file-sound or --disable-file-sound was given.
  if test "${enable_file_sound+set}" = set; then
    enableval="$enable_file_sound"
--- 6433,6439 ----
  fi
  
  echo $ac_n "checking which sound system to use""... $ac_c" 1>&6
! echo "configure:6437: checking which sound system to use" >&5
  # Check whether --enable-file-sound or --disable-file-sound was given.
  if test "${enable_file_sound+set}" = set; then
    enableval="$enable_file_sound"
***************
*** 6539,6551 ****
  
  if [ "x$USE_SCSI_DEVICE" = "xyes" ]; then
    echo $ac_n "checking "availability of libscg headers and lib"""... $ac_c" 1>&6
! echo "configure:6543: checking "availability of libscg headers and lib"" >&5
    OLDLIBS="$LIBS"
    OLDCFLAGS="$CFLAGS"
    CFLAGS="$CFLAGS -Isrc/include"
    LIBS="-Lsrc $LIBS -lscg -lschily"
    cat > conftest.$ac_ext <<EOF
! #line 6549 "configure"
  #include "confdefs.h"
  typedef int BOOL;
  #include "scg/scgcmd.h"
--- 6554,6566 ----
  
  if [ "x$USE_SCSI_DEVICE" = "xyes" ]; then
    echo $ac_n "checking "availability of libscg headers and lib"""... $ac_c" 1>&6
! echo "configure:6558: checking "availability of libscg headers and lib"" >&5
    OLDLIBS="$LIBS"
    OLDCFLAGS="$CFLAGS"
    CFLAGS="$CFLAGS -Isrc/include"
    LIBS="-Lsrc $LIBS -lscg -lschily"
    cat > conftest.$ac_ext <<EOF
! #line 6564 "configure"
  #include "confdefs.h"
  typedef int BOOL;
  #include "scg/scgcmd.h"
***************
*** 6555,6561 ****
  {SCSI *scgp = open_scsi ((void *)0, (void *)0, 0, 1, 1);}
  ; return 0; }
  EOF
! if { (eval echo configure:6559: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    
      echo "$ac_t""available" 1>&6
--- 6570,6576 ----
  {SCSI *scgp = open_scsi ((void *)0, (void *)0, 0, 1, 1);}
  ; return 0; }
  EOF
! if { (eval echo configure:6574: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    
      echo "$ac_t""available" 1>&6
***************
*** 6579,6594 ****
  
  if [ "x$WANT_SDL" = "xyes" ]; then
      OD_JOYSTICK=sdl-joystick.c
! else if [ "x$HAVE_MACHINE_JOYSTICK_H" = "xyes" ]; then
      cat > conftest.$ac_ext <<EOF
! #line 6585 "configure"
  #include "confdefs.h"
  #include <machine/joystick.h>
  int main() {
  { struct joystick a; }
  ; return 0; }
  EOF
! if { (eval echo configure:6592: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    OD_JOYSTICK=od-linux/joystick.c
  else
--- 6594,6609 ----
  
  if [ "x$WANT_SDL" = "xyes" ]; then
      OD_JOYSTICK=sdl-joystick.c
! else if [ "x$ac_cv_header_machine_joystick_h" = "xyes" ]; then
      cat > conftest.$ac_ext <<EOF
! #line 6600 "configure"
  #include "confdefs.h"
  #include <machine/joystick.h>
  int main() {
  { struct joystick a; }
  ; return 0; }
  EOF
! if { (eval echo configure:6607: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    OD_JOYSTICK=od-linux/joystick.c
  else
***************
*** 6616,6628 ****
  
  if [ "x$TARGET" = "xamigaos" -o "x$TARGET" = "xp_os" ]; then
      echo $ac_n "checking which CPU to use""... $ac_c" 1>&6
! echo "configure:6620: checking which CPU to use" >&5
    cpu=`cpu | cut -d' ' -f2`
    echo "$ac_t""$cpu" 1>&6
    CFLAGS="$CFLAGS -m$cpu"
  
      echo $ac_n "checking which FPU to use""... $ac_c" 1>&6
! echo "configure:6626: checking which FPU to use" >&5
    fpu=`cpu | cut -d' ' -f3 | grep '^688812$'`
    if [ "x$fpu" != "x" ]; then
          echo "$ac_t""68881" 1>&6
--- 6631,6643 ----
  
  if [ "x$TARGET" = "xamigaos" -o "x$TARGET" = "xp_os" ]; then
      echo $ac_n "checking which CPU to use""... $ac_c" 1>&6
! echo "configure:6635: checking which CPU to use" >&5
    cpu=`cpu | cut -d' ' -f2`
    echo "$ac_t""$cpu" 1>&6
    CFLAGS="$CFLAGS -m$cpu"
  
      echo $ac_n "checking which FPU to use""... $ac_c" 1>&6
! echo "configure:6641: checking which FPU to use" >&5
    fpu=`cpu | cut -d' ' -f3 | grep '^688812$'`
    if [ "x$fpu" != "x" ]; then
          echo "$ac_t""68881" 1>&6
***************
*** 6804,6809 ****
--- 6821,6828 ----
  s%@LIBRARIES@%$LIBRARIES%g
  s%@TARGET@%$TARGET%g
  s%@GFXOBJS@%$GFXOBJS%g
+ s%@JITOBJS@%$JITOBJS%g
+ s%@JIT_CFLAGS@%$JIT_CFLAGS%g
  s%@RESOBJS@%$RESOBJS%g
  s%@ASMOBJS@%$ASMOBJS%g
  s%@SCSIOBJS@%$SCSIOBJS%g
diff -crB ./uae-0.8.21/configure.in ../uae_jit_cleaning/uae-0.8.21/configure.in
*** ./uae-0.8.21/configure.in	2002-02-04 15:23:29.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/configure.in	2021-01-10 13:10:29.822591684 +0200
***************
*** 224,229 ****
--- 224,230 ----
  WANT_UI=dunno
  WANT_NCURSES_UI=no
  WANT_DGA=no
+ WANT_JIT=no
  WANT_VIDMODE=no
  
  AC_ARG_ENABLE(profiling,[  --enable-profiling      Build a profiling (SLOW!) version],[DO_PROFILING=$enableval],[])
***************
*** 235,240 ****
--- 236,242 ----
  AC_ARG_ENABLE(dga,[  --enable-dga            X11 version: Use the DGA extension],[WANT_DGA=$enableval],[])
  AC_ARG_ENABLE(vidmode,[  --enable-vidmode        X11 version: Use the XF86VidMode extension],[WANT_VIDMODE=$enableval],[])
  AC_ARG_ENABLE(ui,[  --enable-ui             Use a user interface if possible (default on)],[WANT_UI=$enableval],[])
+ AC_ARG_ENABLE(jit,[  --enable-jit            linux/X11 version: Use the JIT compiler],[WANT_JIT=$enableval],[])
  AC_ARG_WITH(hostcc,[  --with-hostcc=x         Use a x as compiler for the host system],[HOSTCC=$withval],[HOSTCC=$CC])
  
  dnl Some simple plausibility tests...
***************
*** 519,525 ****
      else
        echo "Using gtk+ GUI."
        NEED_THREAD_SUPPORT=yes
!       DDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DUSING_GTK_GUI"
        GUIOBJS=gtkui.o
      fi
    else 
--- 521,527 ----
      else
        echo "Using gtk+ GUI."
        NEED_THREAD_SUPPORT=yes
!       ADDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DUSING_GTK_GUI"
        GUIOBJS=gtkui.o
      fi
    else 
***************
*** 537,542 ****
--- 539,550 ----
    GUIOBJS=nogui.o
  fi
  
+ JITOBJS=""
+ if [[ "x$WANT_JIT" = "xyes" ]]; then
+   JITOBJS="compstbl.o compemu.o compemu_support.o compemu_fpp.o cpustbl_nf.o cpufast_nf.o"
+   ADDITIONAL_CFLAGS="$ADDITIONAL_CFLAGS -DJIT -DNATMEM_OFFSET=0x50000000"
+ fi
+ 
  GFXOBJS="$GFXOBJS $GUIOBJS"
   
  dnl Find out some things about the system 
***************
*** 1023,1028 ****
--- 1031,1037 ----
  AC_SUBST(LIBRARIES)
  AC_SUBST(TARGET)
  AC_SUBST(GFXOBJS)
+ AC_SUBST(JITOBJS)
  AC_SUBST(RESOBJS)
  AC_SUBST(ASMOBJS)
  AC_SUBST(SCSIOBJS)
Only in ../uae_jit_cleaning/uae-0.8.21/docs: HOWTOBUILD.txt
Only in ../uae_jit_cleaning/uae-0.8.21/: Makefile
diff -crB ./uae-0.8.21/src/audio.c ../uae_jit_cleaning/uae-0.8.21/src/audio.c
*** ./uae-0.8.21/src/audio.c	2001-12-30 17:15:56.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/audio.c	2021-01-10 13:10:29.826591684 +0200
***************
*** 15,25 ****
  #include "options.h"
  #include "memory.h"
  #include "custom.h"
  #include "newcpu.h"
  #include "autoconf.h"
  #include "gensound.h"
  #include "sounddep/sound.h"
- #include "events.h"
  #include "audio.h"
  #include "savestate.h"
  
--- 15,25 ----
  #include "options.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "autoconf.h"
  #include "gensound.h"
  #include "sounddep/sound.h"
  #include "audio.h"
  #include "savestate.h"
  
diff -crB ./uae-0.8.21/src/autoconf.c ../uae_jit_cleaning/uae-0.8.21/src/autoconf.c
*** ./uae-0.8.21/src/autoconf.c	2001-12-30 17:15:56.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/autoconf.c	2021-01-10 13:10:29.830591684 +0200
***************
*** 15,20 ****
--- 15,21 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "compiler.h"
  #include "autoconf.h"
***************
*** 285,291 ****
      int has_retval = (trapmode[func] & TRAPFLAG_NO_RETVAL) == 0;
      int implicit_rts = (trapmode[func] & TRAPFLAG_DORET) != 0;
  
!     if (*trapstr[func] != 0 && trace_traps)
  	write_log ("TRAP: %s\n", trapstr[func]);
  
      /* For monitoring only? */
--- 286,292 ----
      int has_retval = (trapmode[func] & TRAPFLAG_NO_RETVAL) == 0;
      int implicit_rts = (trapmode[func] & TRAPFLAG_DORET) != 0;
  
!     if (trapstr[func] && *trapstr[func] != 0 && trace_traps)
  	write_log ("TRAP: %s\n", trapstr[func]);
  
      /* For monitoring only? */
diff -crB ./uae-0.8.21/src/blitter.c ../uae_jit_cleaning/uae-0.8.21/src/blitter.c
*** ./uae-0.8.21/src/blitter.c	2002-02-16 16:18:13.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/blitter.c	2021-01-10 13:10:29.830591684 +0200
***************
*** 11,20 ****
  
  #include "config.h"
  #include "options.h"
- #include "events.h"
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
  #include "newcpu.h"
  #include "blitter.h"
  #include "blit.h"
--- 11,20 ----
  
  #include "config.h"
  #include "options.h"
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "blitter.h"
  #include "blit.h"
diff -crB ./uae-0.8.21/src/bsdsocket.c ../uae_jit_cleaning/uae-0.8.21/src/bsdsocket.c
*** ./uae-0.8.21/src/bsdsocket.c	2000-08-26 00:29:41.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/bsdsocket.c	2021-01-10 13:10:29.834591684 +0200
***************
*** 18,23 ****
--- 18,24 ----
  #include "options.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "autoconf.h"
  #include "bsdsocket.h"
diff -crB ./uae-0.8.21/src/cfgfile.c ../uae_jit_cleaning/uae-0.8.21/src/cfgfile.c
*** ./uae-0.8.21/src/cfgfile.c	2002-02-16 16:29:42.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/cfgfile.c	2021-01-10 13:10:29.838591684 +0200
***************
*** 17,23 ****
  #include "threaddep/thread.h"
  #include "uae.h"
  #include "autoconf.h"
- #include "events.h"
  #include "custom.h"
  
  /* @@@ need to get rid of this... just cut part of the manual and print that
--- 17,22 ----
***************
*** 67,76 ****
--- 66,87 ----
      {"sound_channels", "" },
      {"sound_min_buff", "" },
      {"sound_max_buff", "" },
+     {"comp_trustbyte", "How to access bytes in compiler (direct/indirect/indirectKS/afterPic" },
+     {"comp_trustword", "How to access words in compiler (direct/indirect/indirectKS/afterPic" },
+     {"comp_trustlong", "How to access longs in compiler (direct/indirect/indirectKS/afterPic" },
+     {"comp_nf", "Whether to optimize away flag generation where possible" },
+     {"comp_fpu", "Whether to provide JIT FPU emulation" },
+     {"compforcesettings", "Whether to force the JIT compiler settings" },
+     {"cachesize", "How many MB to use to buffer translated instructions"},
+     {"override_dga_address","Address from which to map the frame buffer (upper 16 bits) (DANGEROUS!)"},
+     {"avoid_cmov", "Set to yes on machines that lack the CMOV instruction" },
+     {"avoid_dga", "Set to yes if the use of DGA extension creates problems" },
+     {"avoid_vid", "Set to yes if the use of the Vidmode extension creates problems" },
      {"parallel_on_demand", "" },
      {"serial_on_demand", "" },
      {"joyport0", "" },
      {"joyport1", "" },
+     {"pci_devices", "List of PCI devices to make visible to the emulated Amiga" },
      {"kickstart_rom_file", "Kickstart ROM image, (C) Copyright Amiga, Inc." },
      {"kickstart_ext_rom_file", "Extended Kickstart ROM image, (C) Copyright Amiga, Inc." },
      {"kickstart_key_file", "Key-file for encrypted ROM images (from Cloanto's Amiga Forever)" },
***************
*** 104,109 ****
--- 115,122 ----
  static const char *stereomode3[] = { "1", "2", "3", 0 };
  static const char *interpolmode[] = { "none", "rh", "crux", 0 };
  static const char *collmode[] = { "none", "sprites", "playfields", "full", 0 };
+ static const char *compmode[] = { "direct", "indirect", "indirectKS", "afterPic", 0 };
+ static const char *flushmode[]   = { "soft", "hard", 0 };
  
  #define UNEXPANDED "$(FILE_PATH)"
  
***************
*** 185,190 ****
--- 198,223 ----
      fprintf (f, "sound_pri_time=%d\n", p->sound_pri_time);
      fprintf (f, "sound_pri_cutoff=%d\n", p->sound_pri_cutoff);
  
+     fprintf (f, "comp_trustbyte=%s\n", compmode[p->comptrustbyte]);
+     fprintf (f, "comp_trustword=%s\n", compmode[p->comptrustword]);
+     fprintf (f, "comp_trustlong=%s\n", compmode[p->comptrustlong]);
+     fprintf (f, "comp_trustnaddr=%s\n", compmode[p->comptrustnaddr]);
+     fprintf (f, "comp_nf=%s\n", p->compnf ? "true" : "false");
+     fprintf (f, "comp_constjump=%s\n", p->comp_constjump ? "true" : "false");
+     fprintf (f, "comp_oldsegv=%s\n", p->comp_oldsegv ? "true" : "false");
+     
+     fprintf (f, "comp_flushmode=%s\n", flushmode[p->comp_hardflush]);
+     fprintf (f, "compforcesettings=%s\n", p->compforcesettings ? "true" : "false");
+     fprintf (f, "compfpu=%s\n", p->compfpu ? "true" : "false");
+     fprintf (f, "comp_midopt=%s\n", p->comp_midopt ? "true" : "false");
+     fprintf (f, "comp_lowopt=%s\n", p->comp_lowopt ? "true" : "false");
+     fprintf (f, "avoid_cmov=%s\n", p->avoid_cmov ? "true" : "false" );
+     fprintf (f, "avoid_dga=%s\n", p->avoid_dga ? "true" : "false" );
+     fprintf (f, "avoid_vid=%s\n", p->avoid_vid ? "true" : "false" );
+     fprintf (f, "cachesize=%d\n", p->cachesize);
+     if (p->override_dga_address)
+ 	fprintf (f, "override_dga_address=0x%08x\n", p->override_dga_address);
+ 
      fprintf (f, "joyport0=%s\n", portmode[p->jport0]);
      fprintf (f, "joyport1=%s\n", portmode[p->jport1]);
  
***************
*** 377,382 ****
--- 410,425 ----
  	|| cfgfile_yesno (option, value, "autoconfig", &dummy)
  	|| cfgfile_yesno (option, value, "parallel_on_demand", &p->parallel_demand)
  	|| cfgfile_yesno (option, value, "serial_on_demand", &p->serial_demand)
+ 	|| cfgfile_yesno (option, value, "comp_nf", &p->compnf)
+ 	|| cfgfile_yesno (option, value, "comp_constjump", &p->comp_constjump)
+ 	|| cfgfile_yesno (option, value, "comp_oldsegv", &p->comp_oldsegv)
+ 	|| cfgfile_yesno (option, value, "compforcesettings", &p->compforcesettings)
+ 	|| cfgfile_yesno (option, value, "compfpu", &p->compfpu)
+ 	|| cfgfile_yesno (option, value, "comp_midopt", &p->comp_midopt)
+ 	|| cfgfile_yesno (option, value, "comp_lowopt", &p->comp_lowopt)
+ 	|| cfgfile_yesno (option, value, "avoid_cmov", &p->avoid_cmov)
+ 	|| cfgfile_yesno (option, value, "avoid_dga", &p->avoid_dga)
+ 	|| cfgfile_yesno (option, value, "avoid_vid", &p->avoid_vid)
  	|| cfgfile_yesno (option, value, "log_illegal_mem", &p->illegal_mem))
  	return 1;
      if (cfgfile_intval (option, value, "accuracy", &p->emul_accuracy, 1)
***************
*** 386,391 ****
--- 429,436 ----
  	|| cfgfile_intval (option, value, "sound_bits", &p->sound_bits, 1)
  	|| cfgfile_intval (option, value, "sound_pri_cutoff", &p->sound_pri_cutoff, 1)
  	|| cfgfile_intval (option, value, "sound_pri_time", &p->sound_pri_time, 1)
+ 	|| cfgfile_intval (option, value, "cachesize", &p->cachesize, 1)
+ 	|| cfgfile_intval (option, value, "override_dga_address", &p->override_dga_address, 1)
  	|| cfgfile_intval (option, value, "gfx_framerate", &p->gfx_framerate, 1)
  	|| cfgfile_intval (option, value, "gfx_width", &p->gfx_width, 1)
  	|| cfgfile_intval (option, value, "gfx_height", &p->gfx_height, 1)
***************
*** 399,404 ****
--- 444,453 ----
  	return 1;
      if (cfgfile_strval (option, value, "sound_output", &p->produce_sound, soundmode, 0)
  	|| cfgfile_strval (option, value, "sound_interpol", &p->sound_interpol, interpolmode, 0)
+ 	||cfgfile_strval (option, value, "comp_trustbyte", &p->comptrustbyte, compmode, 0)
+ 	||cfgfile_strval (option, value, "comp_trustword", &p->comptrustword, compmode, 0)
+ 	||cfgfile_strval (option, value, "comp_trustlong", &p->comptrustlong, compmode, 0)
+ 	||cfgfile_strval (option, value, "comp_trustnaddr", &p->comptrustnaddr, compmode, 0)
  	|| cfgfile_strval (option, value, "joyport0", &p->jport0, portmode, 0)
  	|| cfgfile_strval (option, value, "joyport1", &p->jport1, portmode, 0)
  	|| cfgfile_strval (option, value, "use_gui", &p->start_gui, guimode1, 1)
***************
*** 414,420 ****
  	|| cfgfile_strval (option, value, "gfx_colour_mode", &p->color_mode, colormode1, 1)
  	|| cfgfile_strval (option, value, "gfx_colour_mode", &p->color_mode, colormode2, 0)
  	|| cfgfile_strval (option, value, "gfx_color_mode", &p->color_mode, colormode1, 1)
! 	|| cfgfile_strval (option, value, "gfx_color_mode", &p->color_mode, colormode2, 0))
  	return 1;
      if (cfgfile_string (option, value, "floppy0", p->df[0], 256)
  	|| cfgfile_string (option, value, "floppy1", p->df[1], 256)
--- 463,470 ----
  	|| cfgfile_strval (option, value, "gfx_colour_mode", &p->color_mode, colormode1, 1)
  	|| cfgfile_strval (option, value, "gfx_colour_mode", &p->color_mode, colormode2, 0)
  	|| cfgfile_strval (option, value, "gfx_color_mode", &p->color_mode, colormode1, 1)
! 	|| cfgfile_strval (option, value, "gfx_color_mode", &p->color_mode, colormode2, 0)
! 	|| cfgfile_strval (option, value, "comp_flushmode", &p->comp_hardflush, flushmode, 0))
  	return 1;
      if (cfgfile_string (option, value, "floppy0", p->df[0], 256)
  	|| cfgfile_string (option, value, "floppy1", p->df[1], 256)
***************
*** 423,428 ****
--- 473,479 ----
  	|| cfgfile_string (option, value, "kickstart_rom_file", p->romfile, 256)
  	|| cfgfile_string (option, value, "kickstart_ext_rom_file", p->romextfile, 256)
  	|| cfgfile_string (option, value, "kickstart_key_file", p->keyfile, 256)
+ 	|| cfgfile_string (option, value, "pci_devices", p->pci_devices, 256)
  	|| cfgfile_string (option, value, "config_description", p->description, 256))
  	return 1;
  
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_abandoned.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_fpp.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_optimizer.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_optimizer_x86.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_raw_x86.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: compemu_support.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: config.h
diff -crB ./uae-0.8.21/src/custom.c ../uae_jit_cleaning/uae-0.8.21/src/custom.c
*** ./uae-0.8.21/src/custom.c	2002-02-16 16:18:13.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/custom.c	2021-01-10 13:10:29.874591684 +0200
***************
*** 20,28 ****
  #include "uae.h"
  #include "gensound.h"
  #include "sounddep/sound.h"
- #include "events.h"
  #include "memory.h"
  #include "custom.h"
  #include "newcpu.h"
  #include "cia.h"
  #include "disk.h"
--- 20,28 ----
  #include "uae.h"
  #include "gensound.h"
  #include "sounddep/sound.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "cia.h"
  #include "disk.h"
***************
*** 54,63 ****
  /* Events */
  
  unsigned long int currcycle, nextevent, is_lastline;
  static int rpt_did_reset;
  struct ev eventtab[ev_max];
  
! frame_time_t vsynctime, vsyncmintime;
  
  static int vpos;
  static uae_u16 lof;
--- 54,67 ----
  /* Events */
  
  unsigned long int currcycle, nextevent, is_lastline;
+ long cycles_to_next_event;
+ long max_cycles_to_next_event;
+ long cycles_to_hsync_event;
+ 
  static int rpt_did_reset;
  struct ev eventtab[ev_max];
  
! volatile frame_time_t vsynctime, vsyncmintime;
  
  static int vpos;
  static uae_u16 lof;
***************
*** 3643,3669 ****
  
  static void do_savestate(void);
  
! static void vsync_handler (void)
  {
! #if 0
!     static int old_clxdat;
!     if (clxdat != old_clxdat) {
! 	printf ("CLXDAT %04x\n", clxdat);
! 	old_clxdat = clxdat;
!     }
! #endif
!     n_frames++;
  
      if (currprefs.m68k_speed == -1) {
  	frame_time_t curr_time = read_processor_time ();
! 	vsyncmintime += vsynctime;
  	/* @@@ Mathias? How do you think we should do this? */
  	/* If we are too far behind, or we just did a reset, adjust the
  	 * needed time. */
! 	if ((long int)(curr_time - vsyncmintime) > 0 || rpt_did_reset)
  	    vsyncmintime = curr_time + vsynctime;
! 	rpt_did_reset = 0;
      }
  
      handle_events ();
  
--- 3647,3698 ----
  
  static void do_savestate(void);
  
! #define N_LINES 8
! 
! STATIC_INLINE int trigger_frh (int v)
  {
!     return (v & (N_LINES - 1)) == 0;
! }
! 
! extern int gonebad;
  
+ static void frh_handler(void)
+ {
      if (currprefs.m68k_speed == -1) {
  	frame_time_t curr_time = read_processor_time ();
! #if 0
! 	printf("now=%lu, target=%lu, diff=%ld\n", curr_time, vsyncmintime,
! 	       diff32 (curr_time, vsyncmintime));
! #endif
! 
! 	vsyncmintime += vsynctime*N_LINES/625*2;
  	/* @@@ Mathias? How do you think we should do this? */
  	/* If we are too far behind, or we just did a reset, adjust the
  	 * needed time. */
! 	if (rpt_did_reset) {
  	    vsyncmintime = curr_time + vsynctime;
! 	    rpt_did_reset = 0;
! 	}
! 
! 	/* Allow this to be one frame's worth of cycles out */
! 	while (diff32 (curr_time, vsyncmintime + vsynctime) > 0) {
! 	    vsyncmintime += vsynctime*N_LINES/625*2;
! 	    gonebad++;
!  	}
      }
+ }
+ 
+ static void vsync_handler (void)
+ {
+     static int count=50;
+     
+     if (--count == 0) {
+ 	int i;
+ 	count=50;
+ 	newcpu_showstate();
+     }
+ 
+     n_frames++;
  
      handle_events ();
  
***************
*** 3811,3817 ****
  
      DISK_update ();
  
!     is_lastline = vpos + 1 == maxvpos + (lof != 0) && currprefs.m68k_speed == -1 && ! rpt_did_reset;
  
      if ((bplcon0 & 4) && currprefs.gfx_linedbl)
  	notice_interlace_seen ();
--- 3840,3856 ----
  
      DISK_update ();
  
!     if (currprefs.m68k_speed == -1) {
! 	static int count=0;
! 
! 	count++;
! 	if (trigger_frh(count)) {
! 	    frh_handler();
! 	}
! 	is_lastline = trigger_frh(count+1) && ! rpt_did_reset;
!     }
!     else
! 	is_lastline=0;
  
      if ((bplcon0 & 4) && currprefs.gfx_linedbl)
  	notice_interlace_seen ();
***************
*** 3898,3904 ****
  {
      int i;
  
!     currcycle = 0;
      for (i = 0; i < ev_max; i++) {
  	eventtab[i].active = 0;
  	eventtab[i].oldcycles = 0;
--- 3937,3944 ----
  {
      int i;
  
!     nextevent = 0;
!     set_cycles (0);
      for (i = 0; i < ev_max; i++) {
  	eventtab[i].active = 0;
  	eventtab[i].oldcycles = 0;
***************
*** 3968,3973 ****
--- 4008,4016 ----
  
      DISK_reset ();
      CIA_reset ();
+ #ifdef JIT
+     compemu_reset ();
+ #endif
      unset_special (~(SPCFLAG_BRK | SPCFLAG_MODE_CHANGE));
  
      vpos = 0;
***************
*** 3998,4004 ****
      cop_state.state = COP_stop;
      diwstate = DIW_waiting_start;
      hdiwstate = DIW_waiting_start;
!     currcycle = 0;
  
      new_beamcon0 = currprefs.ntscmode ? 0x00 : 0x20;
      init_hz ();
--- 4041,4047 ----
      cop_state.state = COP_stop;
      diwstate = DIW_waiting_start;
      hdiwstate = DIW_waiting_start;
!     set_cycles (0);
  
      new_beamcon0 = currprefs.ntscmode ? 0x00 : 0x20;
      init_hz ();
***************
*** 4076,4083 ****
      write_log ("DIWSTRT: %04x DIWSTOP: %04x DDFSTRT: %04x DDFSTOP: %04x\n",
  	       (unsigned int)diwstrt, (unsigned int)diwstop, (unsigned int)ddfstrt, (unsigned int)ddfstop);
      if (timeframes) {
! 	write_log ("Average frame time: %d ms [frames: %d time: %d]\n",
! 		   frametime / timeframes, timeframes, frametime);
  	if (total_skipped)
  	    write_log ("Skipped frames: %d\n", total_skipped);
      }
--- 4119,4126 ----
      write_log ("DIWSTRT: %04x DIWSTOP: %04x DDFSTRT: %04x DDFSTOP: %04x\n",
  	       (unsigned int)diwstrt, (unsigned int)diwstop, (unsigned int)ddfstrt, (unsigned int)ddfstop);
      if (timeframes) {
! 	write_log ("Average frame time: %f ms [frames: %d time: %d]\n",
! 		   (double)frametime / timeframes, timeframes, frametime);
  	if (total_skipped)
  	    write_log ("Skipped frames: %d\n", total_skipped);
      }
diff -crB ./uae-0.8.21/src/debug.c ../uae_jit_cleaning/uae-0.8.21/src/debug.c
*** ./uae-0.8.21/src/debug.c	2001-10-24 13:59:20.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/debug.c	2021-01-10 13:10:29.882591684 +0200
***************
*** 19,24 ****
--- 19,25 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "debug.h"
  #include "cia.h"
diff -crB ./uae-0.8.21/src/disk.c ../uae_jit_cleaning/uae-0.8.21/src/disk.c
*** ./uae-0.8.21/src/disk.c	2002-01-31 16:09:52.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/disk.c	2021-01-10 13:10:29.882591684 +0200
***************
*** 1155,1161 ****
      {
  	int dr;
  	uaecptr pc = m68k_getpc ();
! 	if ((pc & 0xF80000) != 0xF80000)
  	    return;
  	for (dr = 0; dr < 4; dr++) {
  	    drive *drv = &floppy[dr];
--- 1155,1161 ----
      {
  	int dr;
  	uaecptr pc = m68k_getpc ();
! 	if ((munge24(pc) & 0xFFF80000) != 0xF80000)
  	    return;
  	for (dr = 0; dr < 4; dr++) {
  	    drive *drv = &floppy[dr];
diff -crB ./uae-0.8.21/src/drawing.c ../uae_jit_cleaning/uae-0.8.21/src/drawing.c
*** ./uae-0.8.21/src/drawing.c	2002-01-31 17:14:41.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/drawing.c	2021-01-10 13:10:29.882591684 +0200
***************
*** 38,49 ****
--- 38,51 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "xwin.h"
  #include "autoconf.h"
  #include "gui.h"
  #include "picasso96.h"
  #include "drawing.h"
+ #include "compemu.h"
  #include "savestate.h"
  
  int lores_factor, lores_shift;
***************
*** 1725,1730 ****
--- 1727,1733 ----
  	check_picasso ();
  
  	check_prefs_changed_audio ();
+ 	check_prefs_changed_comp ();
  	check_prefs_changed_custom ();
  	check_prefs_changed_cpu ();
  	if (check_prefs_changed_gfx ()) {
diff -crB ./uae-0.8.21/src/ersatz.c ../uae_jit_cleaning/uae-0.8.21/src/ersatz.c
*** ./uae-0.8.21/src/ersatz.c	2001-12-17 20:38:37.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/ersatz.c	2021-01-10 13:10:29.882591684 +0200
***************
*** 15,20 ****
--- 15,21 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "cia.h"
  #include "disk.h"
diff -crB ./uae-0.8.21/src/fpp.c ../uae_jit_cleaning/uae-0.8.21/src/fpp.c
*** ./uae-0.8.21/src/fpp.c	2001-11-19 19:53:29.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/fpp.c	2021-01-10 13:10:29.882591684 +0200
***************
*** 54,60 ****
      return src; /* Should never be reached */
  }
  
! static uae_u32 get_fpsr (void) 
  {
      uae_u32 answer = regs.fpsr & 0x00ffffff;
  #ifdef HAVE_ISNAN
--- 54,60 ----
      return src; /* Should never be reached */
  }
  
! uae_u32 get_fpsr (void) 
  {
      uae_u32 answer = regs.fpsr & 0x00ffffff;
  #ifdef HAVE_ISNAN
diff -crB ./uae-0.8.21/src/fsdb.c ../uae_jit_cleaning/uae-0.8.21/src/fsdb.c
*** ./uae-0.8.21/src/fsdb.c	2001-09-07 14:41:50.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/fsdb.c	2021-01-10 13:10:29.886591684 +0200
***************
*** 16,21 ****
--- 16,22 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "filesys.h"
  #include "autoconf.h"
Only in ../uae_jit_cleaning/uae-0.8.21/src: gencomp.c
diff -crB ./uae-0.8.21/src/gencpu.c ../uae_jit_cleaning/uae-0.8.21/src/gencpu.c
*** ./uae-0.8.21/src/gencpu.c	2001-12-17 20:38:37.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/gencpu.c	2021-01-10 13:10:29.902591684 +0200
***************
*** 1454,1460 ****
  	    abort ();
  	}
  	printf ("\tSET_ZFLG (upper == reg || lower == reg);\n");
! 	printf ("\tSET_CFLG (lower <= upper ? reg < lower || reg > upper : reg > upper || reg < lower);\n");
  	printf ("\tif ((extra & 0x800) && GET_CFLG) { Exception(6,oldpc); goto %s; }\n}\n", endlabelstr);
  	need_endlabel = 1;
  	break;
--- 1454,1460 ----
  	    abort ();
  	}
  	printf ("\tSET_ZFLG (upper == reg || lower == reg);\n");
! 	printf ("\tSET_CFLG_ALWAYS (lower <= upper ? reg < lower || reg > upper : reg > upper || reg < lower);\n");
  	printf ("\tif ((extra & 0x800) && GET_CFLG) { Exception(6,oldpc); goto %s; }\n}\n", endlabelstr);
  	need_endlabel = 1;
  	break;
***************
*** 1991,1997 ****
  	    printf ("\ttmp = (bf0 << (offset & 7)) | (bf1 >> (8 - (offset & 7)));\n");
  	}
  	printf ("\ttmp >>= (32 - width);\n");
! 	printf ("\tSET_NFLG (tmp & (1 << (width-1)) ? 1 : 0);\n");
  	printf ("\tSET_ZFLG (tmp == 0); SET_VFLG (0); SET_CFLG (0);\n");
  	switch (curi->mnemo) {
  	case i_BFTST:
--- 1991,1997 ----
  	    printf ("\ttmp = (bf0 << (offset & 7)) | (bf1 >> (8 - (offset & 7)));\n");
  	}
  	printf ("\ttmp >>= (32 - width);\n");
! 	printf ("\tSET_NFLG_ALWAYS (tmp & (1 << (width-1)) ? 1 : 0);\n");
  	printf ("\tSET_ZFLG (tmp == 0); SET_VFLG (0); SET_CFLG (0);\n");
  	switch (curi->mnemo) {
  	case i_BFTST:
***************
*** 2129,2139 ****
--- 2129,2156 ----
  	break;
  
       case i_CINVL:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(31);\n"); 
+ 	break;
       case i_CINVP:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(32);\n"); 
+ 	break;
       case i_CINVA:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(33);\n"); 
+ 	break;
       case i_CPUSHL:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(41);\n"); 
+ 	break;
       case i_CPUSHP:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(42);\n"); 
+ 	break;
       case i_CPUSHA:
+ 	printf ("\tif (opcode&0x80)\n"
+ 		"\t\tflush_icache(43);\n"); 
  	break;
       case i_MOVE16:
  	 if ((opcode & 0xfff8) == 0xf620) {
***************
*** 2186,2196 ****
--- 2203,2216 ----
      fprintf (f, "#include \"options.h\"\n");
      fprintf (f, "#include \"memory.h\"\n");
      fprintf (f, "#include \"custom.h\"\n");
+     fprintf (f, "#include \"events.h\"\n");
      fprintf (f, "#include \"newcpu.h\"\n");
      fprintf (f, "#include \"compiler.h\"\n");
      fprintf (f, "#include \"cputbl.h\"\n");
      
      fprintf (f, "#define CPUFUNC(x) x##_ff\n"
+ 	     "#define SET_CFLG_ALWAYS(x) SET_CFLG(x)\n"
+ 	     "#define SET_NFLG_ALWAYS(x) SET_NFLG(x)\n"
  	     "#ifdef NOFLAGS\n"
  	     "#include \"noflags.h\"\n"
  	     "#endif\n");
diff -crB ./uae-0.8.21/src/gtkui.c ../uae_jit_cleaning/uae-0.8.21/src/gtkui.c
*** ./uae-0.8.21/src/gtkui.c	2002-02-16 21:26:25.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/gtkui.c	2021-01-10 13:10:29.902591684 +0200
***************
*** 18,23 ****
--- 18,24 ----
  
  #include "config.h"
  #include "options.h"
+ #include "events.h"
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
***************
*** 27,32 ****
--- 28,34 ----
  #include "threaddep/thread.h"
  #include "sounddep/sound.h"
  #include "savestate.h"
+ #include "compemu.h"
  #include "debug.h"
  
  #include <gtk/gtk.h>
***************
*** 73,78 ****
--- 75,86 ----
  static GtkAdjustment *framerate_adj;
  static GtkWidget *bimm_widget, *b32_widget, *afscr_widget, *pfscr_widget;
  
+ static GtkWidget *compbyte_widget[4], *compword_widget[4], *complong_widget[4];
+ static GtkWidget *compaddr_widget[4], *compnf_widget[2], *comp_midopt_widget[2];
+ static GtkWidget *comp_lowopt_widget[2], *compfpu_widget[2], *comp_hardflush_widget[2];
+ static GtkWidget *comp_constjump_widget[2];
+ static GtkAdjustment *cachesize_adj;
+ 
  static GtkWidget *joy_widget[2][6];
  
  static GtkWidget *led_widgets[5];
***************
*** 230,235 ****
--- 238,262 ----
      gtk_label_set_text (GTK_LABEL (key_text_widget), currprefs.keyfile);
  }
  
+ static void set_comp_state (void)
+ {
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (compbyte_widget[currprefs.comptrustbyte]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (compword_widget[currprefs.comptrustword]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (complong_widget[currprefs.comptrustlong]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (compaddr_widget[currprefs.comptrustnaddr]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (compnf_widget[currprefs.compnf]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (comp_hardflush_widget[currprefs.comp_hardflush]), 1);
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (comp_constjump_widget[currprefs.comp_constjump]), 1);
+ 
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (compfpu_widget[currprefs.compfpu]), 1);
+ #if USE_OPTIMIZER
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (comp_midopt_widget[currprefs.comp_midopt]), 1);
+ #endif
+ #if USE_LOW_OPTIMIZER
+     gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (comp_lowopt_widget[currprefs.comp_lowopt]), 1);
+ #endif
+ }
+ 
  static void set_joy_state (void)
  {
      int j0t = changed_prefs.jport0;
***************
*** 337,342 ****
--- 364,370 ----
  	    set_gfx_state ();
  	    set_joy_state ();
  	    set_sound_state ();
+ 	    set_comp_state ();
  	    set_mem_state ();
  	    set_hd_state ();
  	    set_chipset_state ();
***************
*** 500,505 ****
--- 528,552 ----
      changed_prefs.sound_bits = (find_current_toggle (sound_bits_widget, 2) + 1) * 8;
  }
  
+ static void comp_changed (void)
+ {
+   changed_prefs.cachesize=cachesize_adj->value;
+   changed_prefs.comptrustbyte = find_current_toggle (compbyte_widget, 4);
+   changed_prefs.comptrustword = find_current_toggle (compword_widget, 4);
+   changed_prefs.comptrustlong = find_current_toggle (complong_widget, 4);
+   changed_prefs.comptrustnaddr = find_current_toggle (compaddr_widget, 4);
+   changed_prefs.compnf = find_current_toggle (compnf_widget, 2);
+   changed_prefs.comp_hardflush = find_current_toggle (comp_hardflush_widget, 2);
+   changed_prefs.comp_constjump = find_current_toggle (comp_constjump_widget, 2);
+   changed_prefs.compfpu= find_current_toggle (compfpu_widget, 2);
+ #if USE_OPTIMIZER
+   changed_prefs.comp_midopt = find_current_toggle (comp_midopt_widget, 2);
+ #endif
+ #if USE_LOW_OPTIMIZER
+   changed_prefs.comp_lowopt = find_current_toggle (comp_lowopt_widget, 2);
+ #endif
+ }
+ 
  static void did_reset (void)
  {
      if (quit_gui)
***************
*** 1271,1276 ****
--- 1318,1418 ----
      gtk_box_pack_start (GTK_BOX (hbox), frame, FALSE, TRUE, 0);
  }
  
+ static void make_comp_widgets (GtkWidget *vbox)
+ {
+     GtkWidget *frame, *newbox;
+     int i;
+     GtkWidget *hbox;
+     static const char *complabels1[] = {
+ 	"Direct", "Indirect", "Indirect for KS", "Direct after Picasso",
+ 	NULL
+     },*complabels2[] = {
+ 	"Direct", "Indirect", "Indirect for KS", "Direct after Picasso", 
+ 	NULL
+     },*complabels3[] = {
+ 	"Direct", "Indirect", "Indirect for KS", "Direct after Picasso", 
+ 	NULL
+     },*complabels3a[] = {
+ 	"Direct", "Indirect", "Indirect for KS", "Direct after Picasso", 
+ 	NULL
+     }, *complabels4[] = {
+       "Always generate", "Only generate when needed",
+ 	NULL
+     }, *complabels5[] = {
+       "Disable", "Enable",
+ 	NULL
+     }, *complabels6[] = {
+       "Disable", "Enable",
+ 	NULL
+     }, *complabels7[] = {
+       "Disable", "Enable",
+ 	NULL
+     }, *complabels8[] = {
+       "Soft", "Hard",
+ 	NULL
+     }, *complabels9[] = {
+       "Disable", "Enable", 
+ 	NULL
+     };
+     GtkWidget *thing;
+ 
+     add_empty_vbox (vbox);
+ 
+     newbox = make_radio_group_box ("Byte access", complabels1, compbyte_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+     newbox = make_radio_group_box ("Word access", complabels2, compword_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+     newbox = make_radio_group_box ("Long access", complabels3, complong_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+     newbox = make_radio_group_box ("Address lookup", complabels3a, compaddr_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ 
+     newbox = make_radio_group_box ("Flags", complabels4, compnf_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ 
+     newbox = make_radio_group_box ("Icache flushes", complabels8, comp_hardflush_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ 
+     newbox = make_radio_group_box ("Compile through uncond branch", complabels9, comp_constjump_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ 
+     newbox = make_radio_group_box ("JIT FPU compiler", complabels7, compfpu_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ 
+ #if USE_OPTIMIZER
+     newbox = make_radio_group_box ("Mid Level Optimizer", complabels5, comp_midopt_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ #endif
+ 
+ #if USE_LOW_OPTIMIZER
+     newbox = make_radio_group_box ("Low Level Optimizer", complabels6, comp_lowopt_widget, 1, comp_changed);
+     gtk_widget_show (newbox);
+     add_centered_to_vbox (vbox, newbox);
+ #endif
+ 
+     cachesize_adj = GTK_ADJUSTMENT (gtk_adjustment_new (currprefs.cachesize, 0.0, 16384.0, 1.0, 1.0, 1.0));
+     gtk_signal_connect (GTK_OBJECT (cachesize_adj), "value_changed",
+ 			GTK_SIGNAL_FUNC (comp_changed), NULL);
+ 
+     thing = gtk_hscale_new (cachesize_adj);
+     gtk_range_set_update_policy (GTK_RANGE (thing), GTK_UPDATE_DELAYED);
+     gtk_scale_set_digits (GTK_SCALE (thing), 0);
+     gtk_scale_set_value_pos (GTK_SCALE (thing), GTK_POS_RIGHT);
+     add_labelled_widget_centered ("Translation buffer(kB):", thing, vbox);
+ 
+     add_empty_vbox (vbox);
+ }
+ 
+ 
  static void make_joy_widgets (GtkWidget *dvbox)
  {
      int i;
***************
*** 1535,1540 ****
--- 1677,1683 ----
  	{ "Graphics", make_gfx_widgets },
  	{ "Chipset", make_chipset_widgets },
  	{ "Sound", make_sound_widgets },
+  	{ "JIT", make_comp_widgets },
  	{ "Game ports", make_joy_widgets },
  	{ "Harddisks", make_hd_widgets },
  	{ "About", make_about_widgets }
diff -crB ./uae-0.8.21/src/hardfile.c ../uae_jit_cleaning/uae-0.8.21/src/hardfile.c
*** ./uae-0.8.21/src/hardfile.c	2000-08-26 00:29:41.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/hardfile.c	2021-01-10 13:10:29.902591684 +0200
***************
*** 13,18 ****
--- 13,19 ----
  #include "options.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "disk.h"
  #include "autoconf.h"
diff -crB ./uae-0.8.21/src/include/autoconf.h ../uae_jit_cleaning/uae-0.8.21/src/include/autoconf.h
*** ./uae-0.8.21/src/include/autoconf.h	2001-12-30 17:15:57.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/include/autoconf.h	2021-01-10 13:10:29.914591684 +0200
***************
*** 77,82 ****
--- 77,84 ----
  extern void expansion_init (void);
  extern void expansion_cleanup (void);
  
+ extern uae_u8* rtarea;
+ 
  #define TRAPFLAG_NO_REGSAVE 1
  #define TRAPFLAG_NO_RETVAL 2
  #define TRAPFLAG_EXTRA_STACK 4
Only in ../uae_jit_cleaning/uae-0.8.21/src/include: compemu.h
diff -crB ./uae-0.8.21/src/include/custom.h ../uae_jit_cleaning/uae-0.8.21/src/include/custom.h
*** ./uae-0.8.21/src/include/custom.h	2001-10-24 13:59:20.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/include/custom.h	2021-01-10 13:10:29.914591684 +0200
***************
*** 61,66 ****
--- 61,67 ----
  #define SPCFLAG_BLTNASTY 512
  #define SPCFLAG_EXEC 1024
  #define SPCFLAG_MODE_CHANGE 8192
+ #define SPCFLAG_END_COMPILE 16384
  
  extern uae_u16 adkcon;
  
diff -crB ./uae-0.8.21/src/include/events.h ../uae_jit_cleaning/uae-0.8.21/src/include/events.h
*** ./uae-0.8.21/src/include/events.h	2001-07-29 12:47:03.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/include/events.h	2021-01-10 13:10:29.914591684 +0200
***************
*** 1,3 ****
--- 1,5 ----
+ #ifndef EVENTS_H
+ #define EVENTS_H
   /*
    * UAE - The Un*x Amiga Emulator
    *
***************
*** 11,22 ****
  
  #include "machdep/rpt.h"
  
! extern frame_time_t vsynctime, vsyncmintime;
  extern void reset_frame_rate_hack (void);
  extern int rpt_available;
  
- extern unsigned long currcycle, nextevent, is_lastline;
- extern unsigned long sample_evtime;
  typedef void (*evfunc)(void);
  
  struct ev
--- 13,25 ----
  
  #include "machdep/rpt.h"
  
! extern unsigned long currcycle, nextevent, is_lastline;
! extern unsigned long sample_evtime;
! 
! extern volatile frame_time_t vsynctime, vsyncmintime;
  extern void reset_frame_rate_hack (void);
  extern int rpt_available;
  
  typedef void (*evfunc)(void);
  
  struct ev
***************
*** 33,44 ****
  
  extern struct ev eventtab[ev_max];
  
  STATIC_INLINE void events_schedule (void)
  {
      int i;
  
      unsigned long int mintime = ~0L;
!     for (i = 0; i < ev_max; i++) {
  	if (eventtab[i].active) {
  	    unsigned long int eventtime = eventtab[i].evtime - currcycle;
  	    if (eventtime < mintime)
--- 36,54 ----
  
  extern struct ev eventtab[ev_max];
  
+ extern void init_eventtab (void);
+ 
+ #if 1
+ 
+ /* Let's see whether hiding this away somewhere where the compiler can't
+    see it will cure it of its silly urge to mis-optimize the comparison */ extern long int diff32(frame_time_t x, frame_time_t y);
+ 
  STATIC_INLINE void events_schedule (void)
  {
      int i;
  
      unsigned long int mintime = ~0L;
!     for(i = 0; i < ev_max; i++) {
  	if (eventtab[i].active) {
  	    unsigned long int eventtime = eventtab[i].evtime - currcycle;
  	    if (eventtime < mintime)
***************
*** 48,59 ****
      nextevent = currcycle + mintime;
  }
  
! STATIC_INLINE void do_cycles_slow (unsigned long cycles_to_add)
  {
!     if (is_lastline && eventtab[ev_hsync].evtime - currcycle <= cycles_to_add
! 	&& (long int)(read_processor_time () - vsyncmintime) < 0)
  	return;
  
      while ((nextevent - currcycle) <= cycles_to_add) {
          int i;
          cycles_to_add -= (nextevent - currcycle);
--- 58,99 ----
      nextevent = currcycle + mintime;
  }
  
! extern signed long pissoff;
! 
! STATIC_INLINE void cycles_do_special (void)
! {
!     if (pissoff >= 0)
! 	pissoff = -1;
! }
! 
! STATIC_INLINE void do_extra_cycles (unsigned long cycles_to_add) {
!     pissoff -= cycles_to_add;
! }
! 
! STATIC_INLINE unsigned long int get_cycles (void)
! {
!     return currcycle;
! }
! 
! STATIC_INLINE void set_cycles (unsigned long int x)
  {
!     currcycle = x;
! }
! 
! STATIC_INLINE void do_cycles_slow (unsigned long cycles_to_add) {
!     if ((pissoff -= cycles_to_add) >= 0)
  	return;
  
+     cycles_to_add = -pissoff;
+     pissoff = 0;
+ 
+     if (is_lastline && eventtab[ev_hsync].evtime-currcycle <= cycles_to_add) {
+ 	frame_time_t now=read_processor_time ();
+ 	if (diff32(now, vsyncmintime) < 0) {
+ 	    pissoff = 3000 * CYCLE_UNIT;
+ 	    return;
+ 	}
+     }
      while ((nextevent - currcycle) <= cycles_to_add) {
          int i;
          cycles_to_add -= (nextevent - currcycle);
***************
*** 66,100 ****
  	}
          events_schedule();
      }
      currcycle += cycles_to_add;
  }
  
! STATIC_INLINE void do_cycles_fast (void)
  {
!     if (is_lastline && eventtab[ev_hsync].evtime - currcycle <= 1
! 	&& (long int)(read_processor_time () - vsyncmintime) < 0)
  	return;
  
!     currcycle++;
!     if (nextevent == currcycle) {
  	int i;
  
  	for (i = 0; i < ev_max; i++) {
! 	    if (eventtab[i].active && eventtab[i].evtime == currcycle) {
  		(*eventtab[i].handler) ();
  	    }
  	}
  	events_schedule();
      }
! 
  }
  
  /* This is a special-case function.  Normally, all events should lie in the
     future; they should only ever be active at the current cycle during
     do_cycles.  However, a snapshot is saved during do_cycles, and so when
!    restoring it, we may have other events pending.  */
! STATIC_INLINE void handle_active_events (void)
! {
      int i;
      for (i = 0; i < ev_max; i++) {
  	if (eventtab[i].active && eventtab[i].evtime == currcycle) {
--- 106,223 ----
  	}
          events_schedule();
      }
+ 
      currcycle += cycles_to_add;
  }
  
! #define do_cycles do_cycles_slow
! #define countdown pissoff
! 
! #else
! 
! /* Let's see whether hiding this away somewhere where the compiler can't
!    see it will cure it of its silly urge to mis-optimize the comparison */ extern long int diff32(frame_time_t x, frame_time_t y);
! 
! extern long cycles_to_next_event;
! extern long max_cycles_to_next_event;
! extern long cycles_to_hsync_event;
! extern long pissoff;
! 
! STATIC_INLINE void cycles_do_special(void)
! {
!     if (cycles_to_next_event >= 0) {
! 	pissoff += cycles_to_next_event;
! 	cycles_to_next_event = 0;
!     }
! }
! 
! 
! STATIC_INLINE void do_extra_cycles (unsigned long cycles_to_add) {
!     pissoff -= cycles_to_add;
! }
! 
! STATIC_INLINE unsigned long int get_cycles (void)
  {
!     if (cycles_to_next_event <= max_cycles_to_next_event) {
! 	max_cycles_to_next_event = cycles_to_next_event;
! 	return nextevent - cycles_to_next_event;
!     } else {
! 	return nextevent - max_cycles_to_next_event;
!     }
! }
! 
! STATIC_INLINE void events_schedule (void)
! {
!     int i;
! 
!     unsigned long int curcycles = get_cycles();
!     unsigned long int mintime = ~0L;
! 
!     cycles_to_hsync_event=eventtab[ev_hsync].evtime - curcycles;
!     for (i = 0; i < ev_max; i++) {
! 	if (eventtab[i].active) {
! 	    unsigned long int eventtime = eventtab[i].evtime - curcycles;
! 	    if (eventtime < mintime) 
! 		mintime = eventtime;
! 	}
!     }
!     nextevent = curcycles + mintime;
!     max_cycles_to_next_event = mintime;
!     cycles_to_next_event = mintime;
!     cycles_to_hsync_event = mintime - cycles_to_hsync_event;
! }
! 
! STATIC_INLINE void set_cycles (unsigned long int x)
! {
!     cycles_to_next_event = nextevent - x;
!     events_schedule ();
! }
! 
! STATIC_INLINE void do_cycles_slow (long cycles_to_add)
! {
!     cycles_to_next_event -= cycles_to_add;
!     if (cycles_to_next_event > 0)
  	return;
  
!     cycles_to_next_event += pissoff;
!     pissoff=0;
! 
!     if (is_lastline
! 	&& /*cycles_to_next_event <= cycles_to_hsync_event*/
! 	eventtab[ev_hsync].evtime == nextevent) 
!     {
! 	frame_time_t now=read_processor_time();
! 	if (diff32(now, vsyncmintime)<0)
! 	{
! 	    cycles_to_next_event += 3000 * CYCLE_UNIT;
! 	    return;
! 	}
!     }
!     cycles_to_add=0;
!     while (cycles_to_next_event <= cycles_to_add) {
  	int i;
  
+ 	cycles_to_add-=cycles_to_next_event;
+ 	cycles_to_next_event=0;
  	for (i = 0; i < ev_max; i++) {
! 	    if (eventtab[i].active && eventtab[i].evtime == nextevent) {
  		(*eventtab[i].handler) ();
  	    }
  	}
  	events_schedule();
      }
!     cycles_to_next_event -= cycles_to_add;
  }
  
+ #define do_cycles do_cycles_slow
+ #define countdown cycles_to_next_event
+ 
+ #endif
+ 
  /* This is a special-case function.  Normally, all events should lie in the
     future; they should only ever be active at the current cycle during
     do_cycles.  However, a snapshot is saved during do_cycles, and so when
!    restoring it, we may have other events pending.  */ STATIC_INLINE void handle_active_events (void) {
      int i;
      for (i = 0; i < ev_max; i++) {
  	if (eventtab[i].active && eventtab[i].evtime == currcycle) {
***************
*** 103,117 ****
      }
  }
  
- STATIC_INLINE unsigned long get_cycles (void)
- {
-     return currcycle;
- }
- 
- extern void init_eventtab (void);
- 
- #if /* M68K_SPEED == 1 */  0
- #define do_cycles do_cycles_fast
- #else
- #define do_cycles do_cycles_slow
  #endif
--- 226,229 ----
diff -crB ./uae-0.8.21/src/include/newcpu.h ../uae_jit_cleaning/uae-0.8.21/src/include/newcpu.h
*** ./uae-0.8.21/src/include/newcpu.h	2001-12-17 20:38:38.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/include/newcpu.h	2021-01-10 13:10:29.914591684 +0200
***************
*** 51,57 ****
  struct cputbl {
      cpuop_func *handler;
      int specific;
!     uae_u16 opcode;
  };
  
  extern unsigned long op_illg (uae_u32) REGPARAM;
--- 51,57 ----
  struct cputbl {
      cpuop_func *handler;
      int specific;
!     uae_u32 opcode;
  };
  
  extern unsigned long op_illg (uae_u32) REGPARAM;
***************
*** 101,109 ****
--- 101,132 ----
      uae_u32 prefetch;
  } regs, lastint_regs;
  
+ typedef struct {
+   uae_u16* location;
+   uae_u8  cycles;
+   uae_u8  specmem;
+   uae_u8  dummy2;
+   uae_u8  dummy3;
+ } cpu_history;
+ 
+ struct blockinfo_t;
+ 
+ typedef union {
+     cpuop_func* handler;
+     struct blockinfo_t* bi;
+ } cacheline;
+ 
+ extern signed long pissoff;
+ 
+ STATIC_INLINE uae_u32 munge24(uae_u32 x)
+ {
+     return currprefs.address_space_24?(x&0x00ffffff):x;
+ }
+ 
  STATIC_INLINE void set_special (uae_u32 x)
  {
      regs.spcflags |= x;
+     cycles_do_special();
  }
  
  STATIC_INLINE void unset_special (uae_u32 x)
***************
*** 117,122 ****
--- 140,146 ----
  #if !defined USE_COMPILER
  STATIC_INLINE void m68k_setpc (uaecptr newpc)
  {
+     newpc &= ~1;
      regs.pc_p = regs.pc_oldp = get_real_address (newpc);
      regs.pc = newpc;
  }
***************
*** 242,248 ****
      /* A traced STOP instruction drops through immediately without
         actually stopping.  */
      if (stop && (regs.spcflags & SPCFLAG_DOTRACE) == 0)
! 	regs.spcflags |= SPCFLAG_STOP;
  }
  
  extern uae_u32 get_disp_ea_020 (uae_u32 base, uae_u32 dp);
--- 266,272 ----
      /* A traced STOP instruction drops through immediately without
         actually stopping.  */
      if (stop && (regs.spcflags & SPCFLAG_DOTRACE) == 0)
! 	set_special (SPCFLAG_STOP);
  }
  
  extern uae_u32 get_disp_ea_020 (uae_u32 base, uae_u32 dp);
***************
*** 298,303 ****
--- 322,341 ----
  
  extern cpuop_func *cpufunctbl[65536] ASM_SYM_FOR_FUNC ("cpufunctbl");
  
+   
+ /* Flags for Bernie during development/debugging. Should go away eventually */
+ #define DISTRUST_CONSISTENT_MEM 0
+ #define TAGMASK 0x000fffff
+ #define TAGSIZE (TAGMASK+1)
+ #define MAXRUN 1024
+ 
+ extern uae_u8* start_pc_p;
+ extern uae_u32 start_pc;
+ 
+ #define cacheline(x) (((uae_u32)x)&TAGMASK)
+ 
+ void newcpu_showstate(void);
+ 
  #ifdef JIT
  #else
  #define flush_icache(X) do {} while (0)
Only in ../uae_jit_cleaning/uae-0.8.21/src/include: noflags.h
diff -crB ./uae-0.8.21/src/include/options.h ../uae_jit_cleaning/uae-0.8.21/src/include/options.h
*** ./uae-0.8.21/src/include/options.h	2002-02-16 21:27:08.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/include/options.h	2021-01-10 13:10:29.918591684 +0200
***************
*** 57,62 ****
--- 57,84 ----
      int sound_pri_cutoff;
      int sound_interpol;
  
+     int comptrustbyte;
+     int comptrustword;
+     int comptrustlong;
+     int comptrustnaddr;
+     int compnf;
+     int compforcesettings;
+     int compfpu;
+     int comp_midopt;
+     int comp_lowopt;
+ 
+     int comp_hardflush;
+     int comp_constjump;
+     int comp_oldsegv;
+ 
+     int cachesize;
+     int optcount[10];
+ 
+     int avoid_cmov;
+     int avoid_dga;
+     int avoid_vid;
+     uae_u32 override_dga_address;
+ 
      int gfx_framerate;
      int gfx_width;
      int gfx_height;
***************
*** 80,85 ****
--- 102,108 ----
      char romfile[256];
      char romextfile[256];
      char keyfile[256];
+     char pci_devices[256];
      char prtname[256];
      char sername[256];
  
diff -crB ./uae-0.8.21/src/include/picasso96.h ../uae_jit_cleaning/uae-0.8.21/src/include/picasso96.h
*** ./uae-0.8.21/src/include/picasso96.h	2001-11-25 14:41:51.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/include/picasso96.h	2021-01-10 13:10:29.918591684 +0200
***************
*** 10,15 ****
--- 10,20 ----
  
  #define PICASSO96
  
+ 
+ /* Seems the same routines copy back and forth ;-) */
+ #define PIC_READ (S_READ|S_WRITE)
+ #define PIC_WRITE (S_READ|S_WRITE)
+ 
  #define JAM1 0
  #define JAM2 1
  #define COMP 2
***************
*** 282,287 ****
--- 287,293 ----
      uae_s16 BytesPerRow;
      uae_s16 pad;
      RGBFTYPE RGBFormat;
+     uaecptr AMemory;
  };
  
  #define PSSO_Pattern_Memory 0
***************
*** 555,558 ****
--- 561,576 ----
  extern int picasso_nr_resolutions (void);
  extern void picasso_clip_mouse (int *, int *);
  
+ extern int NDX_InvertRect(struct RenderInfo* ri, unsigned long X, unsigned long Y, unsigned long Width, unsigned long Height, uae_u32 mask, int Bpp);
+ extern int NDX_BlitPattern(struct RenderInfo* ri,struct Pattern* pat,unsigned long X, unsigned long Y, unsigned long W, unsigned long H, uae_u8 Mask, uae_u32 RGBFmt);
+ extern int NDX_BlitTemplate(struct RenderInfo* ri, struct Template* tmp, unsigned long X, unsigned long Y, unsigned long W, unsigned long H, uae_u16 Mask);
+ extern int NDX_BlitPlanar2Chunky(struct RenderInfo* ri, struct BitMap* bm, unsigned long srcx, unsigned long srcy, unsigned long dstx, unsigned long dsty, unsigned long width, unsigned long height, uae_u8 minterm, uae_u8 mask);
+ extern int NDX_BlitPlanar2Direct(struct RenderInfo* ri, struct BitMap* bm, unsigned long srcx, unsigned long srcy, unsigned long dstx, unsigned long dsty, unsigned long width, unsigned long height, uae_u8 minterm, uae_u8 Mask);
+ extern int NDX_FillRect(struct RenderInfo* ri, unsigned long X, unsigned long Y, unsigned long Width, unsigned long Height, uae_u32 Pen, uae_u8 Mask, uae_u32 RGBFormat);
+ extern int NDX_BlitRect(struct RenderInfo* ri, unsigned long srcx, unsigned long srcy, unsigned long dstx, unsigned long dsty, unsigned long width, unsigned long height, uae_u8 Mask);
+ extern int NDX_BlitRectNoMaskComplete(struct RenderInfo* sri,struct RenderInfo* dri, unsigned long srcx, unsigned long srcy, unsigned long dstx, unsigned long dsty, unsigned long width, unsigned long height, uae_u8 OpCode, uae_u32 RGBFmt);
+ 
+ extern int picasso_is_special;
+ extern int picasso_is_special_read;
+ 
  #endif
diff -crB ./uae-0.8.21/src/include/sysdeps.h ../uae_jit_cleaning/uae-0.8.21/src/include/sysdeps.h
*** ./uae-0.8.21/src/include/sysdeps.h	2001-11-19 19:58:46.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/include/sysdeps.h	2021-01-10 13:10:29.918591684 +0200
***************
*** 235,241 ****
  /* While we're here, make abort more useful.  */
  #define abort() \
    do { \
!     write_log ("Internal error; file %s, line %d\n", __FILE__, __LINE__); \
      (abort) (); \
  } while (0)
  #else
--- 235,241 ----
  /* While we're here, make abort more useful.  */
  #define abort() \
    do { \
!     fprintf (stderr, "Internal error; file %s, line %d\n", __FILE__, __LINE__); \
      (abort) (); \
  } while (0)
  #else
Only in ../uae_jit_cleaning/uae-0.8.21/src: machdep
diff -crB ./uae-0.8.21/src/main.c ../uae_jit_cleaning/uae-0.8.21/src/main.c
*** ./uae-0.8.21/src/main.c	2001-12-17 20:38:38.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/main.c	2021-01-10 13:10:29.906591684 +0200
***************
*** 17,26 ****
  #include "gensound.h"
  #include "audio.h"
  #include "sounddep/sound.h"
- #include "events.h"
  #include "memory.h"
  #include "custom.h"
  #include "serial.h"
  #include "newcpu.h"
  #include "disk.h"
  #include "debug.h"
--- 17,26 ----
  #include "gensound.h"
  #include "audio.h"
  #include "sounddep/sound.h"
  #include "memory.h"
  #include "custom.h"
  #include "serial.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "disk.h"
  #include "debug.h"
***************
*** 119,124 ****
--- 119,153 ----
      p->sound_maxbsiz = DEFAULT_SOUND_MAXB;
      p->sound_interpol = 0;
  
+     p->comptrustbyte = 0;
+     p->comptrustword = 0;
+     p->comptrustlong = 0;
+     p->comptrustnaddr= 0;
+     p->compnf=1;
+     p->comp_hardflush=0;
+     p->comp_constjump=1;
+     p->comp_oldsegv=0;
+     p->compfpu=1;
+     p->compforcesettings=0;
+     p->cachesize=4096;
+     p->avoid_cmov=0;
+     p->avoid_dga=0;
+     p->avoid_vid=0;
+     p->comp_midopt=0;
+     p->comp_lowopt=0;
+     p->override_dga_address=0;
+     {
+ 	int i;
+ 	for (i=0;i<10;i++)
+ 	    p->optcount[i]=-1;
+ 	p->optcount[0]=4; /* How often a block has to be executed before it
+ 			     is translated */
+ 	p->optcount[1]=0; /* How often to use the naive translation */
+ 	p->optcount[2]=0; 
+ 	p->optcount[3]=0;
+ 	p->optcount[4]=0;
+ 	p->optcount[5]=0;
+     }
      p->gfx_framerate = 1;
      p->gfx_width = 800;
      p->gfx_height = 600;
***************
*** 261,266 ****
--- 290,341 ----
  	currprefs.produce_sound = 0;
  	err = 1;
      }
+     if (currprefs.comptrustbyte < 0 || currprefs.comptrustbyte > 3) {
+ 	fprintf (stderr, "Bad value for comptrustbyte parameter: value must be within 0..2\n");
+ 	currprefs.comptrustbyte = 1;
+ 	err = 1;
+     }
+     if (currprefs.comptrustword < 0 || currprefs.comptrustword > 3) {
+ 	fprintf (stderr, "Bad value for comptrustword parameter: value must be within 0..2\n");
+ 	currprefs.comptrustword = 1;
+ 	err = 1;
+     }
+     if (currprefs.comptrustlong < 0 || currprefs.comptrustlong > 3) {
+ 	fprintf (stderr, "Bad value for comptrustlong parameter: value must be within 0..2\n");
+ 	currprefs.comptrustlong = 1;
+ 	err = 1;
+     }
+     if (currprefs.comptrustnaddr < 0 || currprefs.comptrustnaddr > 3) {
+ 	fprintf (stderr, "Bad value for comptrustnaddr parameter: value must be within 0..2\n");
+ 	currprefs.comptrustnaddr = 1;
+ 	err = 1;
+     }
+     if (currprefs.compnf < 0 || currprefs.compnf > 1) {
+ 	fprintf (stderr, "Bad value for compnf parameter: value must be within 0..1\n");
+ 	currprefs.compnf = 1;
+ 	err = 1;
+     }
+     if (currprefs.comp_hardflush < 0 || currprefs.comp_hardflush > 1) {
+ 	fprintf (stderr, "Bad value for comp_hardflush parameter: value must be within 0..1\n");
+ 	currprefs.comp_hardflush = 1;
+ 	err = 1;
+     }
+     if (currprefs.comp_constjump < 0 || currprefs.comp_constjump > 1) {
+ 	fprintf (stderr, "Bad value for comp_constjump parameter: value must be within 0..1\n");
+ 	currprefs.comp_constjump = 1;
+ 	err = 1;
+     }
+     if (currprefs.comp_oldsegv < 0 || currprefs.comp_oldsegv > 1) {
+ 	fprintf (stderr, "Bad value for comp_oldsegv parameter: value must be within 0..1\n");
+ 	currprefs.comp_oldsegv = 1;
+ 	err = 1;
+     }
+     if (currprefs.cachesize < 0 || currprefs.cachesize > 16384) {
+ 	fprintf (stderr, "Bad value for cachesize parameter: value must be within 0..16384\n");
+ 	currprefs.cachesize = 2048;
+ 	err = 1;
+     }
+ 
      if (currprefs.cpu_level < 2 && currprefs.z3fastmem_size > 0) {
  	write_log ("Z3 fast memory can't be used with a 68000/68010 emulation. It\n"
  		 "requires a 68020 emulation. Turning off Z3 fast memory.\n");
Only in ../uae_jit_cleaning/uae-0.8.21/src: Makefile
diff -crB ./uae-0.8.21/src/Makefile.in ../uae_jit_cleaning/uae-0.8.21/src/Makefile.in
*** ./uae-0.8.21/src/Makefile.in	2001-11-19 14:34:18.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/Makefile.in	2021-01-10 13:10:29.826591684 +0200
***************
*** 39,46 ****
         disk.o audio.o compiler.o uaelib.o drawing.o picasso96.o cpustbl.o \
         uaeexe.o bsdsocket.o missing.o sd-sound.o od-joy.o md-support.o \
         fsusage.o cfgfile.o native2amiga.o @FSDBOBJS@ fsdb.o identify.o \
!        savestate.o writelog.o @ASMOBJS@ @GFXOBJS@ @DEBUGOBJS@ @SCSIOBJS@
! 
  
  all: $(TARGET)
  
--- 39,46 ----
         disk.o audio.o compiler.o uaelib.o drawing.o picasso96.o cpustbl.o \
         uaeexe.o bsdsocket.o missing.o sd-sound.o od-joy.o md-support.o \
         fsusage.o cfgfile.o native2amiga.o @FSDBOBJS@ fsdb.o identify.o \
!        savestate.o writelog.o @ASMOBJS@ @GFXOBJS@ @DEBUGOBJS@ @SCSIOBJS@ \
!        @JITOBJS@
  
  all: $(TARGET)
  
***************
*** 80,85 ****
--- 80,86 ----
  	-rm -f blit.h cpudefs.c
  	-rm -f cpuemu.c build68k cputmp.s cpufast*.s cpustbl.c cputbl.h
  	-rm -f blitfunc.c blitfunc.h blittable.c
+ 	-rm -f compemu.c compstbl.c comptbl.h
  
  halfclean:
  	-rm -f $(OBJS)
***************
*** 106,111 ****
--- 107,114 ----
  	$(MAKE) -C tools cpuopti
  tools/gencpu: 
  	$(MAKE) -C tools gencpu
+ tools/gencomp:
+ 	$(MAKE) -C tools gencomp
  
  custom.o: blit.h
  drawing.o: linetoscr.c
***************
*** 116,130 ****
--- 119,156 ----
  cpuemu.c: tools/gencpu
  	./tools/gencpu
  
+ compemu.c: tools/gencomp
+ 	./tools/gencomp
+ 
  # gencpu also creates cpustbl.c and cputbl.h
  cpustbl.c: cpuemu.c
  cputbl.h: cpuemu.c
+ compstbl.c: compemu.c
+ comptbl.h: compemu.c
+ compemu_support.o: compemu_optimizer.c compemu_raw_x86.c
  
  cpufast.s: cpuemu.c tools/cpuopti
  	$(CC) $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) $< -o cputmp.s
  	./tools/cpuopti <cputmp.s >$@
  	rm cputmp.s
  
+ cpufast_nf.s: cpuemu.c tools/cpuopti
+ 	$(CC) $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS $< -o cputmp_nf.s
+ 	./tools/cpuopti <cputmp_nf.s >$@
+ 	rm cputmp_nf.s
+ 
+ cpuemu_nf.o: cpuemu.c ./tools/cpuopti
+ 	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS $< -o $@
+ 
+ cpustbl_nf.o: cpustbl.c
+ 	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS cpustbl.c -o $@
+ 
+ comptest: compemu_support.o compemu.o comptest.o readcpu.o missing.o cpudefs.o compstbl.o 
+ 	$(CC) -o compemu_support.o comptest compemu.o comptest.o readcpu.o \
+ 		missing.o cpudefs.o compstbl.o \
+ 		$(GFXLDFLAGS) $(LDFLAGS) $(DEBUGFLAGS) $(LIBRARIES) $(MATHLIB)
+ 
+ 
  console_missing.o: missing.c
  	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(CFLAGS_$@) $< -o $@
  
***************
*** 206,211 ****
--- 232,270 ----
  	./tools/cpuopti <cputmp8.s >$@
  	rm cputmp8.s
  
+ cpufast1_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_1 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf1.s
+ 	./tools/cpuopti <cputmp_nf1.s >$@
+ 	rm cputmp_nf1.s
+ cpufast2_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_2 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf2.s
+ 	./tools/cpuopti <cputmp_nf2.s >$@
+ 	rm cputmp_nf2.s
+ cpufast3_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_3 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf3.s
+ 	./tools/cpuopti <cputmp_nf3.s >$@
+ 	rm cputmp_nf3.s
+ cpufast4_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_4 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf4.s
+ 	./tools/cpuopti <cputmp_nf4.s >$@
+ 	rm cputmp_nf4.s
+ cpufast5_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_5 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf5.s
+ 	./tools/cpuopti <cputmp_nf5.s >$@
+ 	rm cputmp_nf5.s
+ cpufast6_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_6 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf6.s
+ 	./tools/cpuopti <cputmp_nf6.s >$@
+ 	rm cputmp_nf6.s
+ cpufast7_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_7 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf7.s
+ 	./tools/cpuopti <cputmp_nf7.s >$@
+ 	rm cputmp_nf7.s
+ cpufast8_nf.s: cpuemu.c cpuopti
+ 	$(CC) -DPART_8 $(INCLUDES) -S $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $(NO_SCHED_CFLAGS) -DNOFLAGS -g0 $< -o cputmp_nf8.s
+ 	./tools/cpuopti <cputmp_nf8.s >$@
+ 	rm cputmp_nf8.s
+ 
  cpuemu1.o: cpuemu.c
  	$(CC) -DPART_1 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $< -o $@
  cpuemu2.o: cpuemu.c
***************
*** 222,224 ****
--- 281,302 ----
  	$(CC) -DPART_7 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $< -o $@
  cpuemu8.o: cpuemu.c
  	$(CC) -DPART_8 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) $< -o $@
+ 
+ 
+ cpuemu1_nf.o: cpuemu.c
+ 	$(CC) -DPART_1 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu2_nf.o: cpuemu.c
+ 	$(CC) -DPART_2 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu3_nf.o: cpuemu.c
+ 	$(CC) -DPART_3 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu4_nf.o: cpuemu.c
+ 	$(CC) -DPART_4 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu5_nf.o: cpuemu.c
+ 	$(CC) -DPART_5 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu6_nf.o: cpuemu.c
+ 	$(CC) -DPART_6 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu7_nf.o: cpuemu.c
+ 	$(CC) -DPART_7 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ cpuemu8_nf.o: cpuemu.c
+ 	$(CC) -DPART_8 $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(X_CFLAGS) $(DEBUGFLAGS) -DNOFLAGS $< -o $@
+ 
Only in ../uae_jit_cleaning/uae-0.8.21/src: md-fpp.h
diff -crB ./uae-0.8.21/src/md-i386-gcc/m68k.h ../uae_jit_cleaning/uae-0.8.21/src/md-i386-gcc/m68k.h
*** ./uae-0.8.21/src/md-i386-gcc/m68k.h	2000-08-16 01:21:41.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/md-i386-gcc/m68k.h	2021-01-10 13:10:29.918591684 +0200
***************
*** 1,3 ****
--- 1,6 ----
+ #ifndef M68K_H
+ #define M68K_H
+ 
   /* 
    * UAE - The Un*x Amiga Emulator
    * 
***************
*** 32,50 ****
      unsigned int x;
  };
  
! #define FLAGVAL_Z 0x40
! #define FLAGVAL_N 0x80
  
! #define SET_ZFLG(y) (regflags.cznv = (regflags.cznv & ~0x40) | (((y) & 1) << 6))
! #define SET_CFLG(y) (regflags.cznv = (regflags.cznv & ~1) | ((y) & 1))
! #define SET_VFLG(y) (regflags.cznv = (regflags.cznv & ~0x800) | (((y) & 1) << 11))
! #define SET_NFLG(y) (regflags.cznv = (regflags.cznv & ~0x80) | (((y) & 1) << 7))
  #define SET_XFLG(y) (regflags.x = (y))
  
! #define GET_ZFLG ((regflags.cznv >> 6) & 1)
! #define GET_CFLG (regflags.cznv & 1)
! #define GET_VFLG ((regflags.cznv >> 11) & 1)
! #define GET_NFLG ((regflags.cznv >> 7) & 1)
  #define GET_XFLG (regflags.x & 1)
  
  #define CLEAR_CZNV (regflags.cznv = 0)
--- 35,53 ----
      unsigned int x;
  };
  
! #define FLAGVAL_Z 0x4000
! #define FLAGVAL_N 0x8000
  
! #define SET_ZFLG(y) (regflags.cznv = (regflags.cznv & ~0x4000) | (((y) & 1) << 14))
! #define SET_CFLG(y) (regflags.cznv = (regflags.cznv & ~0x100) | (((y) & 1) << 8))
! #define SET_VFLG(y) (regflags.cznv = (regflags.cznv & ~0x1) | (((y) & 1)))
! #define SET_NFLG(y) (regflags.cznv = (regflags.cznv & ~0x8000) | (((y) & 1) << 15))
  #define SET_XFLG(y) (regflags.x = (y))
  
! #define GET_ZFLG ((regflags.cznv >> 14) & 1)
! #define GET_CFLG ((regflags.cznv >> 8) & 1)
! #define GET_VFLG ((regflags.cznv >> 0) & 1)
! #define GET_NFLG ((regflags.cznv >> 15) & 1)
  #define GET_XFLG (regflags.x & 1)
  
  #define CLEAR_CZNV (regflags.cznv = 0)
***************
*** 52,58 ****
  #define IOR_CZNV(X) (regflags.cznv |= (X))
  #define SET_CZNV(X) (regflags.cznv = (X))
  
! #define COPY_CARRY (regflags.x = regflags.cznv)
  
  
  #endif
--- 55,61 ----
  #define IOR_CZNV(X) (regflags.cznv |= (X))
  #define SET_CZNV(X) (regflags.cznv = (X))
  
! #define COPY_CARRY (regflags.x = (regflags.cznv)>>8)
  
  
  #endif
***************
*** 65,173 ****
      switch(cc){
       case 0: return 1;                       /* T */
       case 1: return 0;                       /* F */
!      case 2: return (cznv & 0x41) == 0; /* !GET_CFLG && !GET_ZFLG;  HI */
!      case 3: return (cznv & 0x41) != 0; /* GET_CFLG || GET_ZFLG;    LS */
!      case 4: return (cznv & 1) == 0;        /* !GET_CFLG;               CC */
!      case 5: return (cznv & 1) != 0;           /* GET_CFLG;                CS */
!      case 6: return (cznv & 0x40) == 0; /* !GET_ZFLG;               NE */
!      case 7: return (cznv & 0x40) != 0; /* GET_ZFLG;                EQ */
!      case 8: return (cznv & 0x800) == 0;/* !GET_VFLG;               VC */
!      case 9: return (cznv & 0x800) != 0;/* GET_VFLG;                VS */
!      case 10:return (cznv & 0x80) == 0; /* !GET_NFLG;               PL */
!      case 11:return (cznv & 0x80) != 0; /* GET_NFLG;                MI */
!      case 12:return (((cznv << 4) ^ cznv) & 0x800) == 0; /* GET_NFLG == GET_VFLG;             GE */
!      case 13:return (((cznv << 4) ^ cznv) & 0x800) != 0;/* GET_NFLG != GET_VFLG;             LT */
       case 14:
! 	cznv &= 0x8c0;
! 	return (((cznv << 4) ^ cznv) & 0x840) == 0; /* !GET_ZFLG && (GET_NFLG == GET_VFLG);  GT */
       case 15:
! 	cznv &= 0x8c0;
! 	return (((cznv << 4) ^ cznv) & 0x840) != 0; /* GET_ZFLG || (GET_NFLG != GET_VFLG);   LE */
      }
      abort();
      return 0;
  }
  
  #define optflag_testl(v) \
!   __asm__ __volatile__ ("testl %1,%1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "r" (v) : "cc")
! 
  #define optflag_testw(v) \
!   __asm__ __volatile__ ("testw %w1,%w1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "r" (v) : "cc")
  
  #define optflag_testb(v) \
!   __asm__ __volatile__ ("testb %b1,%b1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "q" (v) : "cc")
  
  #define optflag_addl(v, s, d) do { \
!   __asm__ __volatile__ ("addl %k2,%k1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=r" (v) : "rmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  #define optflag_addw(v, s, d) do { \
!   __asm__ __volatile__ ("addw %w2,%w1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=r" (v) : "rmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_addb(v, s, d) do { \
!   __asm__ __volatile__ ("addb %b2,%b1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=q" (v) : "qmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subl(v, s, d) do { \
!   __asm__ __volatile__ ("subl %k2,%k1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=r" (v) : "rmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subw(v, s, d) do { \
!   __asm__ __volatile__ ("subw %w2,%w1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=r" (v) : "rmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subb(v, s, d) do { \
!   __asm__ __volatile__ ("subb %b2,%b1\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv), "=q" (v) : "qmi" (s), "1" (d) : "cc"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_cmpl(s, d) \
!   __asm__ __volatile__ ("cmpl %k1,%k2\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "rmi" (s), "r" (d) : "cc")
  
  #define optflag_cmpw(s, d) \
!   __asm__ __volatile__ ("cmpw %w1,%w2\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "rmi" (s), "r" (d) : "cc")
  
  #define optflag_cmpb(s, d) \
!   __asm__ __volatile__ ("cmpb %b1,%b2\n\t" \
! 			"pushfl\n\t" \
! 			"popl %0\n\t" \
! 			: "=r" (regflags.cznv) : "qmi" (s), "q" (d) : "cc")
  
--- 68,206 ----
      switch(cc){
       case 0: return 1;                       /* T */
       case 1: return 0;                       /* F */
!      case 2: return (cznv & 0x4100) == 0; /* !GET_CFLG && !GET_ZFLG;  HI */
!      case 3: return (cznv & 0x4100) != 0; /* GET_CFLG || GET_ZFLG;    LS */
!      case 4: return (cznv & 0x100) == 0;  /* !GET_CFLG;               CC */
!      case 5: return (cznv & 0x100) != 0;  /* GET_CFLG;                CS */
!      case 6: return (cznv & 0x4000) == 0; /* !GET_ZFLG;               NE */
!      case 7: return (cznv & 0x4000) != 0; /* GET_ZFLG;                EQ */
!      case 8: return (cznv & 0x01) == 0;   /* !GET_VFLG;               VC */
!      case 9: return (cznv & 0x01) != 0;   /* GET_VFLG;                VS */
!      case 10:return (cznv & 0x8000) == 0; /* !GET_NFLG;               PL */
!      case 11:return (cznv & 0x8000) != 0; /* GET_NFLG;                MI */
!      case 12:return (((cznv << 15) ^ cznv) & 0x8000) == 0; /* GET_NFLG == GET_VFLG;             GE */
!      case 13:return (((cznv << 15) ^ cznv) & 0x8000) != 0;/* GET_NFLG != GET_VFLG;             LT */
       case 14:
! 	cznv &= 0xc001;
! 	return (((cznv << 15) ^ cznv) & 0xc000) == 0; /* !GET_ZFLG && (GET_NFLG == GET_VFLG);  GT */
       case 15:
! 	cznv &= 0xc001;
! 	return (((cznv << 15) ^ cznv) & 0xc000) != 0; /* GET_ZFLG || (GET_NFLG != GET_VFLG);   LE */
      }
      abort();
      return 0;
  }
  
+ /* Is there any way to do this without declaring *all* memory clobbered?
+    I.e. any way to tell gcc that some byte-sized value is in %al? */
  #define optflag_testl(v) \
!   __asm__ __volatile__ ("andl %0,%0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "r" (v) : "%eax","cc","memory")
  #define optflag_testw(v) \
!   __asm__ __volatile__ ("andw %w0,%w0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "r" (v) : "%eax","cc","memory")
  
  #define optflag_testb(v) \
!   __asm__ __volatile__ ("andb %b0,%b0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "q" (v) : "%eax","cc","memory")
  
  #define optflag_addl(v, s, d) do { \
!   __asm__ __volatile__ ("addl %k1,%k0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:"=r" (v) : "rmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  #define optflag_addw(v, s, d) do { \
!   __asm__ __volatile__ ("addw %w1,%w0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			: "=r" (v) : "rmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_addb(v, s, d) do { \
!   __asm__ __volatile__ ("addb %b1,%b0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:"=q" (v) : "qmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subl(v, s, d) do { \
!   __asm__ __volatile__ ("subl %k1,%k0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			: "=r" (v) : "rmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subw(v, s, d) do { \
!   __asm__ __volatile__ ("subw %w1,%w0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			: "=r" (v) : "rmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_subb(v, s, d) do { \
!    __asm__ __volatile__ ("subb %b1,%b0\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			: "=q" (v) : "qmi" (s), "0" (d) : "%eax","cc","memory"); \
      COPY_CARRY; \
      } while (0)
  
  #define optflag_cmpl(s, d) \
!   __asm__ __volatile__ ("cmpl %k0,%k1\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "rmi" (s), "r" (d) : "%eax","cc","memory")
  
  #define optflag_cmpw(s, d) \
!   __asm__ __volatile__ ("cmpw %w0,%w1\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "rmi" (s), "r" (d) : "%eax","cc","memory");
  
  #define optflag_cmpb(s, d) \
!   __asm__ __volatile__ ("cmpb %b0,%b1\n\t" \
! 			"lahf\n\t" \
! 			"seto %%al\n\t" \
!                         "movb %%al,regflags\n\t" \
! 			"movb %%ah,regflags+1\n\t" \
! 			:: "qmi" (s), "q" (d) : "%eax","cc","memory")
! 
! 
! #endif
! 
! 
  
Only in ../uae_jit_cleaning/uae-0.8.21/src: md-support.c
Only in ../uae_jit_cleaning/uae-0.8.21/src: md-X86.S
diff -crB ./uae-0.8.21/src/memory.c ../uae_jit_cleaning/uae-0.8.21/src/memory.c
*** ./uae-0.8.21/src/memory.c	2002-02-16 16:29:42.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/memory.c	2021-01-10 14:05:52.970591684 +0200
***************
*** 1032,1038 ****
      if (!canbang)
  	return malloc (s);
  
!     id = shmget (IPC_PRIVATE, s, 0x1ff, file);
      if (id == 1) {
  	canbang = 0;
  	return mapped_malloc (s, file);
--- 1032,1038 ----
      if (!canbang)
  	return malloc (s);
  
!     id = shmget (IPC_PRIVATE, s, 0x1ff);
      if (id == 1) {
  	canbang = 0;
  	return mapped_malloc (s, file);
***************
*** 1187,1193 ****
  	map_banks (&bogomem_bank, 0xC0, t, allocated_bogomem);
      }
      if (a3000memory != 0)
! 	map_banks (&a3000mem_bank, a3000mem_start >> 16, allocated_a3000mem >> 16, allocated_a3000mem);
  
      map_banks (&rtarea_bank, RTAREA_BASE >> 16, 1, 0);
  
--- 1187,1194 ----
  	map_banks (&bogomem_bank, 0xC0, t, allocated_bogomem);
      }
      if (a3000memory != 0)
! 	map_banks (&a3000mem_bank, a3000mem_start >> 16, allocated_a3000mem >> 16,
! 		   allocated_a3000mem);
  
      map_banks (&rtarea_bank, RTAREA_BASE >> 16, 1, 0);
  
***************
*** 1207,1214 ****
--- 1208,1270 ----
  	if (cloanto_rom)
  	    map_banks (&kickmem_bank, 0xE0, 8, 0);
      }
+ 
+     {
+ 	int dummy;
+ 	__asm__ __volatile__ ("mov %%gs:0,%0" : "=r" (dummy));
+     }
+ }
+ 
+ #if defined __i386__ && defined __linux__
+ 
+ #include <sys/syscall.h>
+ 
+ struct modify_ldt_ldt_s {
+     unsigned int  entry_number;
+     unsigned long base_addr;
+     unsigned int  limit;
+     unsigned int  seg_32bit:1;
+     unsigned int  contents:2;
+     unsigned int  read_exec_only:1;
+     unsigned int  limit_in_pages:1;
+     unsigned int  seg_not_present:1;
+     unsigned int  useable:1;
+ };
+ 
+ static inline int modify_ldt( int func, struct modify_ldt_ldt_s *ptr,
+                                   unsigned long count )
+ {
+     int res;
+     __asm__ __volatile__("int $0x80"
+                          : "=a" (res)
+                          : "0" (SYS_modify_ldt),
+                            "b" (func),
+                            "c" (ptr),
+                            "d" (count) );
+     return res;
  }
  
+ #define MODIFY_LDT_CONTENTS_DATA        0
+ #define MODIFY_LDT_CONTENTS_STACK       1
+ #define MODIFY_LDT_CONTENTS_CODE        2
+ 
+ static void setup_ldt (void)
+ {
+     struct modify_ldt_ldt_s entry;
+     entry.entry_number = 1;
+     entry.base_addr = NATMEM_OFFSET;
+     entry.limit = 0x80000000 >> 12;
+     entry.contents = MODIFY_LDT_CONTENTS_DATA;
+     entry.read_exec_only = 0;
+     entry.limit_in_pages = 1;
+     entry.seg_not_present = 0;
+     entry.useable = 1;
+     modify_ldt (1, &entry, sizeof entry);
+     __asm__ __volatile__ ("mov %0,%%gs" : : "r" (15));
+ }
+ 
+ #endif
+ 
  void memory_init (void)
  {
      allocated_chipmem = 0;
***************
*** 1229,1234 ****
--- 1285,1293 ----
  	ersatzkickfile = 1;
      }
  
+     // Crashes emulator at start
+     //setup_ldt ();
+ 
      init_mem_banks ();
      memory_reset ();
  
diff -crB ./uae-0.8.21/src/native2amiga.c ../uae_jit_cleaning/uae-0.8.21/src/native2amiga.c
*** ./uae-0.8.21/src/native2amiga.c	2001-11-19 19:58:46.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/native2amiga.c	2021-01-10 13:10:29.906591684 +0200
***************
*** 17,22 ****
--- 17,23 ----
  #include "options.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "disk.h"
  #include "autoconf.h"
diff -crB ./uae-0.8.21/src/newcpu.c ../uae_jit_cleaning/uae-0.8.21/src/newcpu.c
*** ./uae-0.8.21/src/newcpu.c	2002-02-16 16:18:13.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/newcpu.c	2021-01-10 14:06:32.838591684 +0200
***************
*** 6,11 ****
--- 6,18 ----
    * (c) 1995 Bernd Schmidt
    */
  
+ /* Lots of workarounds for gcc 2.95.* compiler problems tagged as "FIXME".
+    The compiler should be fixed, not the app! */
+ 
+ extern unsigned long foink;
+ extern unsigned long foink2;
+ extern unsigned long foink3;
+ 
  #include "sysconfig.h"
  #include "sysdeps.h"
  
***************
*** 24,29 ****
--- 31,53 ----
  #include "savestate.h"
  #include "blitter.h"
  
+ #ifdef JIT
+ #include "compemu.h"
+ #include <signal.h>
+ static void vec(int x, struct siginfo* si, struct sigcontext* sc);
+ #else
+ /* Need to have these somewhere */
+ static void build_comp(void) {}
+ void check_prefs_changed_comp (void) {}
+ #endif
+ 
+ static int stop_compile;
+ int oink=0;
+ /* For faster cycles handling */
+ signed long pissoff=0;
+ /* Counter for missed vsyncmintime deadlines */
+ int gonebad=0;
+ 
  /* Opcode of faulting instruction */
  uae_u16 last_op_for_exception_3;
  /* PC at fault time */
***************
*** 44,49 ****
--- 68,75 ----
  
  cpuop_func *cpufunctbl[65536];
  
+ extern uae_u32 get_fpsr(void);
+ 
  #define COUNT_INSTRS 0
  
  #if COUNT_INSTRS
***************
*** 96,106 ****
  }
  #endif
  
  int broken_in;
  
! static unsigned long op_illg_1 (uae_u32 opcode) REGPARAM;
  
! static unsigned long REGPARAM2 op_illg_1 (uae_u32 opcode)
  {
      op_illg (opcode);
      return 4;
--- 122,133 ----
  }
  #endif
  
+ 
  int broken_in;
  
! unsigned long op_illg_1 (uae_u32 opcode) REGPARAM;
  
! unsigned long REGPARAM2 op_illg_1 (uae_u32 opcode)
  {
      op_illg (opcode);
      return 4;
***************
*** 143,148 ****
--- 170,176 ----
  	if (tbl[i].specific)
  	    cpufunctbl[tbl[i].opcode] = tbl[i].handler;
      }
+     build_comp();
  }
  
  unsigned long cycles_mask, cycles_val;
***************
*** 681,692 ****
  	unset_special (SPCFLAG_TRACE);
  }
  
! void Exception(int nr, uaecptr oldpc)
  {
      uae_u32 currpc = m68k_getpc ();
  
!     compiler_flush_jsr_stack();
!     MakeSR();
  
      if (!regs.s) {
  	regs.usp = m68k_areg(regs, 7);
--- 709,721 ----
  	unset_special (SPCFLAG_TRACE);
  }
  
! void Exception (int nr, uaecptr oldpc)
  {
      uae_u32 currpc = m68k_getpc ();
  
!     stop_compile = 1;
!     compiler_flush_jsr_stack ();
!     MakeSR ();
  
      if (!regs.s) {
  	regs.usp = m68k_areg(regs, 7);
***************
*** 746,751 ****
--- 775,781 ----
      m68k_areg(regs, 7) -= 2;
      put_word (m68k_areg(regs, 7), regs.sr);
      m68k_setpc (get_long (regs.vbr + 4*nr));
+     set_special(SPCFLAG_END_COMPILE);
      fill_prefetch_0 ();
      regs.t1 = regs.t0 = regs.m = 0;
      unset_special (SPCFLAG_TRACE | SPCFLAG_DOTRACE);
***************
*** 776,782 ****
  	switch (regno) {
  	case 0: regs.sfc = *regp & 7; break;
  	case 1: regs.dfc = *regp & 7; break;
! 	case 2: cacr = *regp & (currprefs.cpu_level < 4 ? 0x3 : 0x80008000); break;
  	case 3: tc = *regp & 0xc000; break;
  	    /* Mask out fields that should be zero.  */
  	case 4: itt0 = *regp & 0xffffe364; break;
--- 806,828 ----
  	switch (regno) {
  	case 0: regs.sfc = *regp & 7; break;
  	case 1: regs.dfc = *regp & 7; break;
! 	 case 2: 
! 	    cacr = *regp & (currprefs.cpu_level < 4 ? 0x3 : 0x80008000);
! #ifdef JIT
! 	    if (currprefs.cpu_level<4) {
! 		set_cache_state(cacr&1);
! 		if (*regp&0x08) {
! 		    flush_icache(1);
! 		}
! 	    }
! 	    else {
! 		set_cache_state((cacr&0x8000)||0);
! 		if (*regp&0x08) {   /* Just to be on the safe side */
! 		    flush_icache(2);
! 		}
! 	    }
! #endif
! 	    break;
  	case 3: tc = *regp & 0xc000; break;
  	    /* Mask out fields that should be zero.  */
  	case 4: itt0 = *regp & 0xffffe364; break;
***************
*** 1123,1128 ****
--- 1169,1185 ----
      regs.intmask = 7;
      regs.vbr = regs.sfc = regs.dfc = 0;
      regs.fpcr = regs.fpsr = regs.fpiar = 0;
+     regs.fp_result=1;
+ }
+ 
+ STATIC_INLINE int in_rom (uaecptr pc)
+ {
+     return (munge24 (pc) & 0xFFF80000) == 0xF80000;
+ }
+ 
+ STATIC_INLINE int in_rtarea (uaecptr pc)
+ {
+     return (munge24 (pc) & 0xFFFF0000) == RTAREA_BASE;
  }
  
  unsigned long REGPARAM2 op_illg (uae_u32 opcode)
***************
*** 1137,1164 ****
      }
  
      compiler_flush_jsr_stack ();
!     if (opcode == 0x4E7B && get_long (0x10) == 0 && (pc & 0xF80000) == 0xF80000) {
  	write_log ("Your Kickstart requires a 68020 CPU. Giving up.\n");
  	broken_in = 1;
  	set_special (SPCFLAG_BRK);
  	quit_program = 1;
      }
      if (opcode == 0xFF0D) {
! 	if ((pc & 0xF80000) == 0xF80000) {
  	    /* This is from the dummy Kickstart replacement */
  	    uae_u16 arg = get_iword (2);
  	    m68k_incpc (4);
  	    ersatz_perform (arg);
  	    fill_prefetch_0 ();
  	    return 4;
! 	} else if ((pc & 0xFFFF0000) == RTAREA_BASE) {
  	    /* User-mode STOP replacement */
  	    m68k_setstopped (1);
  	    return 4;
  	}
      }
  
!     if ((opcode & 0xF000) == 0xA000 && (pc & 0xFFFF0000) == RTAREA_BASE) {
  	/* Calltrap. */
  	m68k_incpc(2);
  	call_calltrap (opcode & 0xFFF);
--- 1194,1221 ----
      }
  
      compiler_flush_jsr_stack ();
!     if (opcode == 0x4E7B && get_long (0x10) == 0 && in_rom (pc)) {
  	write_log ("Your Kickstart requires a 68020 CPU. Giving up.\n");
  	broken_in = 1;
  	set_special (SPCFLAG_BRK);
  	quit_program = 1;
      }
      if (opcode == 0xFF0D) {
! 	if (in_rom (pc)) {
  	    /* This is from the dummy Kickstart replacement */
  	    uae_u16 arg = get_iword (2);
  	    m68k_incpc (4);
  	    ersatz_perform (arg);
  	    fill_prefetch_0 ();
  	    return 4;
! 	} else if (in_rtarea (pc)) {
  	    /* User-mode STOP replacement */
  	    m68k_setstopped (1);
  	    return 4;
  	}
      }
  
!     if ((opcode & 0xF000) == 0xA000 && in_rtarea (pc)) {
  	/* Calltrap. */
  	m68k_incpc(2);
  	call_calltrap (opcode & 0xFFF);
***************
*** 1167,1177 ****
      }
  
      if ((opcode & 0xF000) == 0xF000) {
  	Exception(0xB,0);
  	return 4;
      }
      if ((opcode & 0xF000) == 0xA000) {
! 	if ((pc & 0xFFFF0000) == RTAREA_BASE) {
  	    /* Calltrap. */
  	    call_calltrap (opcode & 0xFFF);
  	}
--- 1224,1235 ----
      }
  
      if ((opcode & 0xF000) == 0xF000) {
+  	write_log ("B-Trap %x at %x (%p)\n", opcode, m68k_getpc () + m68kpc_offset, regs.pc_p);
  	Exception(0xB,0);
  	return 4;
      }
      if ((opcode & 0xF000) == 0xA000) {
! 	if (in_rtarea (pc)) {
  	    /* Calltrap. */
  	    call_calltrap (opcode & 0xFFF);
  	}
***************
*** 1243,1248 ****
--- 1301,1307 ----
  	do_copper ();
  
      /*n_spcinsns++;*/
+     unset_special(SPCFLAG_END_COMPILE);   /* has done its job */
      while (regs.spcflags & SPCFLAG_BLTNASTY) {
  	int c = blitnasty();
  	if (!c)
***************
*** 1301,1307 ****
      uae_u16 *oldpcp;
  #endif
      for (;;) {
! 	int cycles;
  	uae_u32 opcode = get_iword_prefetch (0);
  #ifdef DEBUG_PREFETCH
  	if (get_ilong (0) != do_get_mem_long (&regs.prefetch)) {
--- 1360,1366 ----
      uae_u16 *oldpcp;
  #endif
      for (;;) {
! 	int local_cycles;
  	uae_u32 opcode = get_iword_prefetch (0);
  #ifdef DEBUG_PREFETCH
  	if (get_ilong (0) != do_get_mem_long (&regs.prefetch)) {
***************
*** 1321,1332 ****
  	instrcount[opcode]++;
  #endif
  #if defined X86_ASSEMBLY
! 	__asm__ __volatile__("\tcall *%%ebx"
! 			     : "=&a" (cycles) : "b" (cpufunctbl[opcode]), "0" (opcode)
  			     : "%edx", "%ecx",
  			     "%esi", "%edi", "%ebp", "memory", "cc");
  #else
! 	cycles = (*cpufunctbl[opcode])(opcode);
  #endif
  #ifdef DEBUG_PREFETCH
  	if (memcmp (saved_bytes, oldpcp, 20) != 0) {
--- 1380,1392 ----
  	instrcount[opcode]++;
  #endif
  #if defined X86_ASSEMBLY
! 	__asm__ __volatile__("\tpush %%ebp\n\tcall *%%ebx\n\tpop %%ebp" /* FIXME */
! 			     : "=&a" (local_cycles) 
! 			     : "b" (cpufunctbl[opcode]), "0" (opcode)
  			     : "%edx", "%ecx",
  			     "%esi", "%edi", "%ebp", "memory", "cc");
  #else
! 	local_cycles = (*cpufunctbl[opcode])(opcode);
  #endif
  #ifdef DEBUG_PREFETCH
  	if (memcmp (saved_bytes, oldpcp, 20) != 0) {
***************
*** 1335,1344 ****
  	    debugging = 1;
  	}
  #endif
  	/*n_insns++;*/
! 	cycles &= cycles_mask;
! 	cycles |= cycles_val;
! 	do_cycles (cycles);
  	if (regs.spcflags) {
  	    if (do_specialties ())
  		return;
--- 1395,1405 ----
  	    debugging = 1;
  	}
  #endif
+ 
  	/*n_insns++;*/
! 	local_cycles &= cycles_mask;
! 	local_cycles |= cycles_val;
! 	do_cycles (local_cycles);
  	if (regs.spcflags) {
  	    if (do_specialties ())
  		return;
***************
*** 1348,1353 ****
--- 1409,1521 ----
  
  #define DEBUG_PREFETCH
  
+ #ifdef JIT  /* Completely different run_2 replacement */
+ 
+ void do_nothing(void)
+ {
+     /* What did you expect this to do? */
+     do_cycles(0);
+     /* I bet you didn't expect *that* ;-) */
+ }
+ 
+ void exec_nostats(void)
+ {
+     int new_cycles;
+ 
+     for (;;) 
+     { 
+ 	/* gcc bug! */
+ 	__volatile__ uae_u16 opcode=get_iword(0);
+ #if defined X86_ASSEMBLY
+ 	__asm__ __volatile__("\tpush %%ebp\n\tcall *%%ebx\n\tpop %%ebp" /* FIXME */
+ 			     : "=&a" (new_cycles) 
+ 			     : "b" (cpufunctbl[opcode]), "0" (opcode)
+ 			     : "%edx", "%ecx", "%esi", "%edi", 
+ 			     "%ebp", "memory", "cc");
+ #else
+ 	new_cycles = (*cpufunctbl[opcode])(opcode);
+ #endif
+ 
+ 	new_cycles &= cycles_mask;
+ 	new_cycles |= cycles_val;
+ 	do_cycles (new_cycles);
+ 	
+ 	if (end_block(opcode) ||
+ 	    regs.spcflags) {
+ 	    return; /* We will deal with the spcflags in the caller */
+ 	}
+     }
+ }
+ 
+ 
+ void execute_normal (void)
+ {
+     int blocklen;
+     cpu_history pc_hist[MAXRUN];
+     int new_cycles;
+     int total_cycles;
+ 
+     if (check_for_cache_miss())
+ 	return;
+     total_cycles=0;
+     blocklen=0;
+     start_pc_p=regs.pc_oldp;  
+     start_pc=regs.pc; 
+     for (;;) 
+     {    /* Take note: This is the do-it-normal loop */
+ 	uae_u16 opcode=get_iword(0);
+ 
+ 	special_mem = DISTRUST_CONSISTENT_MEM;
+ 	pc_hist[blocklen].location = (uae_u16*)regs.pc_p;
+ 	stop_compile = 0;
+ #if defined X86_ASSEMBLY
+ 	__asm__ __volatile__("\tpush %%ebp\n\tcall *%%ebx\n\tpop %%ebp" /* FIXME */
+ 			     : "=&a" (new_cycles) 
+ 			     : "b" (cpufunctbl[opcode]), "0" (opcode)
+ 			     : "%edx", "%ecx", "%esi", "%edi", 
+ 			     "%ebp", "memory", "cc");
+ #else
+ 	new_cycles = (*cpufunctbl[opcode])(opcode);
+ #endif
+ 	new_cycles &= cycles_mask;
+ 	new_cycles |= cycles_val;
+ 	do_cycles (new_cycles);
+ 	total_cycles+=new_cycles;
+ 	pc_hist[blocklen].specmem=special_mem;
+ 	blocklen++;
+ 	if (stop_compile || end_block(opcode) || blocklen >= MAXRUN || regs.spcflags) {
+ 	    compile_block(pc_hist,blocklen,total_cycles);
+ 	    return; /* We will deal with the spcflags in the caller */
+ 	}
+ 	/* No need to check regs.spcflags, because if they were set,
+ 	   we'd have ended up inside that "if" */
+     }
+ }
+ 
+ typedef void compiled_handler(void);
+ 
+ static void m68k_run_2a (void)
+ {
+     for (;;) {  
+ #if defined X86_ASSEMBLY 
+ 	__asm__ __volatile__(
+ 	    "\tpush %%ebp\n\tcall *%0\n\tpop %%ebp"  /* FIXME */
+ 	    :: "m" (cache_tags[cacheline(regs.pc_p)].handler) 
+ 	    : "%edx", "%ecx", "%eax",
+ 	    "%esi", "%ebx", "%edi", "%ebp", "memory", "cc");
+ #else
+ 	((compiled_handler*)(pushall_call_handler))();
+ #endif
+ 	/* Whenever we return from that, we should check spcflags */
+ 	if (regs.spcflags) {
+ 	    if (do_specialties ()) {
+ 		return;
+ 	    }
+ 	}
+     }
+ }
+ #endif
+ 
  /* Same thing, but don't use prefetch to get opcode.  */
  static void m68k_run_2 (void)
  {
***************
*** 1364,1370 ****
  	instrcount[opcode]++;
  #endif
  #if defined X86_ASSEMBLY
! 	__asm__ __volatile__("\tcall *%%ebx"
  			     : "=&a" (cycles) : "b" (cpufunctbl[opcode]), "0" (opcode)
  			     : "%edx", "%ecx",
  			     "%esi", "%edi", "%ebp", "memory", "cc");
--- 1532,1538 ----
  	instrcount[opcode]++;
  #endif
  #if defined X86_ASSEMBLY
! 	__asm__ __volatile__("\tpush %%ebp\n\tcall *%%ebx\n\tpop %%ebp" /* FIXME */
  			     : "=&a" (cycles) : "b" (cpufunctbl[opcode]), "0" (opcode)
  			     : "%edx", "%ecx",
  			     "%esi", "%edi", "%ebp", "memory", "cc");
***************
*** 1430,1436 ****
--- 1598,1609 ----
  
  	if (debugging)
  	    debug ();
+ #ifndef JIT
  	m68k_run1 (currprefs.cpu_compatible ? m68k_run_1 : m68k_run_2);
+ #else
+ 	m68k_run1 (currprefs.cpu_compatible ? m68k_run_1 : 
+ 		   currprefs.cpu_level>=2 ? m68k_run_2a : m68k_run_2);
+ #endif
      }
      in_m68k_go--;
  }
***************
*** 1525,1530 ****
--- 1698,1705 ----
  void m68k_dumpstate (FILE *f, uaecptr *nextpc)
  {
      int i;
+     uae_u32 fpsr;
+ 
      for (i = 0; i < 8; i++){
  	fprintf (f, "D%d: %08lx ", i, m68k_dreg(regs, i));
  	if ((i & 3) == 3) fprintf (f, "\n");
***************
*** 1545,1555 ****
  	fprintf (f, "FP%d: %g ", i, regs.fp[i]);
  	if ((i & 3) == 3) fprintf (f, "\n");
      }
      fprintf (f, "N=%d Z=%d I=%d NAN=%d\n",
! 	     (regs.fpsr & 0x8000000) != 0,
! 	     (regs.fpsr & 0x4000000) != 0,
! 	     (regs.fpsr & 0x2000000) != 0,
! 	     (regs.fpsr & 0x1000000) != 0);
      if (currprefs.cpu_compatible)
  	fprintf (f, "prefetch %08lx\n", (unsigned long)do_get_mem_long(&regs.prefetch));
  
--- 1720,1731 ----
  	fprintf (f, "FP%d: %g ", i, regs.fp[i]);
  	if ((i & 3) == 3) fprintf (f, "\n");
      }
+     fpsr=get_fpsr();
      fprintf (f, "N=%d Z=%d I=%d NAN=%d\n",
! 	     (fpsr & 0x8000000) != 0,
! 	     (fpsr & 0x4000000) != 0,
! 	     (fpsr & 0x2000000) != 0,
! 	     (fpsr & 0x1000000) != 0);
      if (currprefs.cpu_compatible)
  	fprintf (f, "prefetch %08lx\n", (unsigned long)do_get_mem_long(&regs.prefetch));
  
***************
*** 1654,1656 ****
--- 1830,1884 ----
      *len = dst - dstbak;
      return dstbak;
  }
+ 
+ extern int segvcount;
+ extern int soft_flush_count;
+ extern int hard_flush_count;
+ extern int compile_count;
+ extern int checksum_count;
+ extern int inhibit_frame;
+ 
+ void newcpu_showstate(void)
+ {
+     static time_t oldtime=0;
+     static int line=0;
+     time_t newtime=time(NULL);
+     
+     /* return; */
+ #if defined JIT 
+ 
+     if (!line) {
+ 	fprintf(stderr,"compiled segv soft hard trans check  lost   debug1   debug2   debug3   debug4\n");
+ 	line++;
+     }
+     if (oldtime && newtime!=oldtime+1) {
+ 	printf("Time difference was %d seconds, should be 1\n",(int)(newtime-oldtime));
+ 	line++;
+     }
+     oldtime=newtime;
+ 
+     fprintf(stderr,"%8lu %4d %4d %4d %5d %5d %5.3f",get_jitted_size(),segvcount,soft_flush_count,hard_flush_count,compile_count,checksum_count,(double)gonebad/15625*8);
+     /*    fprintf(stderr," %8d %8lu %8lu %8lu",oink,foink3,foink2,foink);*/
+     if (!inhibit_frame) {
+ 	fprintf(stderr," NAT");
+     }
+     fprintf(stderr,"\n");
+     oink=0; 
+     /*    foink3=foink2=foink=0;*/
+     checksum_count=soft_flush_count=hard_flush_count=compile_count=0;
+     gonebad=0;
+     line++;
+     if (line==25)
+ 	line=0;
+ #endif
+ }
+ 
+ /* Putting this here should stop the compiler from trying to work out
+    (wrongly!) what we *really* mean ;-) 
+ */
+ 
+ long int diff32(frame_time_t x, frame_time_t y)
+ {
+     return (long int)(x-y);
+ }
+ 
diff -crB ./uae-0.8.21/src/nogui.c ../uae_jit_cleaning/uae-0.8.21/src/nogui.c
*** ./uae-0.8.21/src/nogui.c	2001-12-30 16:41:47.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/nogui.c	2021-01-10 14:05:59.962591684 +0200
***************
*** 43,49 ****
  {
  }
  
! static void getline (char *p)
  {
  }
  
--- 43,49 ----
  {
  }
  
! static void gui_getline (char *p)
  {
  }
  
diff -crB ./uae-0.8.21/src/od-amiga/ami-rexx.c ../uae_jit_cleaning/uae-0.8.21/src/od-amiga/ami-rexx.c
*** ./uae-0.8.21/src/od-amiga/ami-rexx.c	2001-09-07 14:44:24.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/od-amiga/ami-rexx.c	2021-01-10 13:10:29.922591684 +0200
***************
*** 34,39 ****
--- 34,40 ----
  
  #include <rexx/storage.h>
  #include <rexx/errors.h>
+ #include "events.h"
  
  /* this prevent a conflict between <rexx/rexxio.h> and <sys/dirent.h> */
  #undef DT_DIR 
***************
*** 210,216 ****
  static void QUIT(void)
  {
      broken_in = 1;
!     regs.spcflags |= SPCFLAG_BRK;
      quit_program = 1;
  }
  
--- 211,217 ----
  static void QUIT(void)
  {
      broken_in = 1;
!     set_special(SPCFLAG_BRK);
      quit_program = 1;
  }
  
Only in ../uae_jit_cleaning/uae-0.8.21/src: od-joy.c
diff -crB ./uae-0.8.21/src/od-macos/mac.c ../uae_jit_cleaning/uae-0.8.21/src/od-macos/mac.c
*** ./uae-0.8.21/src/od-macos/mac.c	2001-09-07 14:44:25.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/od-macos/mac.c	2021-01-10 13:10:29.922591684 +0200
***************
*** 936,942 ****
  				
  				case 13:
  					broken_in = 1;
! 					regs.spcflags |= SPCFLAG_BRK;
  					quit_program=1;
  				break;
  			}
--- 936,942 ----
  				
  				case 13:
  					broken_in = 1;
! 					set_special(SPCFLAG_BRK);
  					quit_program=1;
  				break;
  			}
diff -crB ./uae-0.8.21/src/od-pOS/pos-rexx.c ../uae_jit_cleaning/uae-0.8.21/src/od-pOS/pos-rexx.c
*** ./uae-0.8.21/src/od-pOS/pos-rexx.c	1997-11-01 16:07:58.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/od-pOS/pos-rexx.c	2021-01-10 13:10:29.922591684 +0200
***************
*** 6,11 ****
--- 6,13 ----
    * Copyright 1997 Samuel Devulder.
    */
  
+ #include "events.h"
+ 
  int  rexx_init(void);
  void rexx_exit(void);
  void rexx_led(int led, int on);
***************
*** 189,195 ****
  static void QUIT(void)
  {
      broken_in = 1;
!     regs.spcflags |= SPCFLAG_BRK;
      quit_program = 1;
  }
  
--- 191,197 ----
  static void QUIT(void)
  {
      broken_in = 1;
!     set_special(SPCFLAG_BRK);
      quit_program = 1;
  }
  
diff -crB ./uae-0.8.21/src/od-win32/win32gui.c ../uae_jit_cleaning/uae-0.8.21/src/od-win32/win32gui.c
*** ./uae-0.8.21/src/od-win32/win32gui.c	2001-12-17 18:37:43.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/od-win32/win32gui.c	2021-01-10 13:10:29.926591684 +0200
***************
*** 3014,3020 ****
  	    case PSN_RESET:
  		if (allow_quit) {
  		    quit_program = 1;
! 		    regs.spcflags |= SPCFLAG_BRK;
  		}
  		break;
  	    }
--- 3014,3020 ----
  	    case PSN_RESET:
  		if (allow_quit) {
  		    quit_program = 1;
! 		    set_special(SPCFLAG_BRK);
  		}
  		break;
  	    }
***************
*** 3233,3239 ****
  	case PSN_RESET:
  	    if (allow_quit) {
  		quit_program = 1;
! 		regs.spcflags |= SPCFLAG_BRK;
  	    }
  	    break;
  	}
--- 3233,3239 ----
  	case PSN_RESET:
  	    if (allow_quit) {
  		quit_program = 1;
! 		set_special(SPCFLAG_BRK);
  	    }
  	    break;
  	}
***************
*** 3603,3609 ****
  	case PSN_RESET:
  	    if (allow_quit) {
  		quit_program = 1;
! 		regs.spcflags |= SPCFLAG_BRK;
  	    }
  	    break;
  	}
--- 3603,3609 ----
  	case PSN_RESET:
  	    if (allow_quit) {
  		quit_program = 1;
! 		set_special(SPCFLAG_BRK);
  	    }
  	    break;
  	}
Only in ../uae_jit_cleaning/uae-0.8.21/src: osdep
diff -crB ./uae-0.8.21/src/picasso96.c ../uae_jit_cleaning/uae-0.8.21/src/picasso96.c
*** ./uae-0.8.21/src/picasso96.c	2002-01-31 16:09:52.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/picasso96.c	2021-01-10 13:10:29.910591684 +0200
***************
*** 39,48 ****
--- 39,53 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "xwin.h"
  #include "picasso96.h"
  
+ int have_done_picasso=0; /* For the JIT compiler */
+ int picasso_is_special=PIC_WRITE; /* ditto */
+ int picasso_is_special_read=PIC_READ; /* ditto */
+ 
  #ifdef PICASSO96
  
  /* #define P96TRACING_ENABLED */
***************
*** 248,253 ****
--- 253,259 ----
      uaecptr memp = get_long (amigamemptr + PSSO_RenderInfo_Memory);
  
      if (valid_address (memp, PSSO_RenderInfo_sizeof)) {
+ 	ri->AMemory=memp;
  	ri->Memory = get_real_address (memp);
  	ri->BytesPerRow = get_word (amigamemptr + PSSO_RenderInfo_BytesPerRow);
  	ri->RGBFormat = get_long (amigamemptr + PSSO_RenderInfo_RGBFormat);
***************
*** 696,701 ****
--- 702,709 ----
      if (!picasso_on)
  	return;
  
+     have_done_picasso=1;
+     
      /* Make sure that the first time we show a Picasso video mode, we don't blit any crap.
       * We can do this by checking if we have an Address yet.  */
      if (picasso96_state.Address) {
***************
*** 923,928 ****
--- 931,940 ----
  #if 0
      write_log ("SetSwitch() - trying to show %s screen\n", flag ? "picasso96" : "amiga");
  #endif
+ 
+     flush_icache(5);  /* Changing the screen mode might make gfx memory
+ 			 directly accessible, or no longer thus accessible */
+ 
      /* Put old switch-state in D0 */
      return !flag;
  }
***************
*** 2239,2244 ****
--- 2251,2258 ----
  
      addr += gfxmem_start;
      /* Check to see if this needs to be written through to the display, or was it an "offscreen" area? */
+     /* Shouldn't the "+4" be on the *first* addr, rather than the second?
+        and be a "+3" at  that? */
      if (addr < picasso96_state.Address || addr + 4 > picasso96_state.Extent)
  	return;
  
***************
*** 2335,2340 ****
--- 2349,2356 ----
  static uae_u32 REGPARAM2 gfxmem_lget (uaecptr addr)
  {
      uae_u32 *m;
+ 
+     special_mem|=picasso_is_special_read;  
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      m = (uae_u32 *) (gfxmemory + addr);
***************
*** 2344,2349 ****
--- 2360,2367 ----
  static uae_u32 REGPARAM2 gfxmem_wget (uaecptr addr)
  {
      uae_u16 *m;
+ 
+     special_mem|=picasso_is_special_read;  
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      m = (uae_u16 *) (gfxmemory + addr);
***************
*** 2352,2357 ****
--- 2370,2376 ----
  
  static uae_u32 REGPARAM2 gfxmem_bget (uaecptr addr)
  {
+     special_mem|=picasso_is_special_read;  
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      return gfxmemory[addr];
***************
*** 2360,2365 ****
--- 2379,2386 ----
  static void REGPARAM2 gfxmem_lput (uaecptr addr, uae_u32 l)
  {
      uae_u32 *m;
+ 
+     special_mem|=picasso_is_special; 
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      m = (uae_u32 *) (gfxmemory + addr);
***************
*** 2372,2377 ****
--- 2393,2399 ----
  static void REGPARAM2 gfxmem_wput (uaecptr addr, uae_u32 w)
  {
      uae_u16 *m;
+     special_mem|=picasso_is_special; 
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      m = (uae_u16 *) (gfxmemory + addr);
***************
*** 2383,2388 ****
--- 2405,2411 ----
  
  static void REGPARAM2 gfxmem_bput (uaecptr addr, uae_u32 b)
  {
+     special_mem|=picasso_is_special; 
      addr -= gfxmem_start & gfxmem_mask;
      addr &= gfxmem_mask;
      gfxmemory[addr] = b;
Only in ../uae_jit_cleaning/uae-0.8.21/src: sd-sound.c
diff -crB ./uae-0.8.21/src/sd-uss/sound.h ../uae_jit_cleaning/uae-0.8.21/src/sd-uss/sound.h
*** ./uae-0.8.21/src/sd-uss/sound.h	1997-11-25 18:27:52.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/sd-uss/sound.h	2021-01-10 13:10:29.926591684 +0200
***************
*** 13,20 ****
  
  static __inline__ void check_sound_buffers (void)
  {
!     if ((char *)sndbufpt - (char *)sndbuffer >= sndbufsize) {
! 	write (sound_fd, sndbuffer, sndbufsize);
  	sndbufpt = sndbuffer;
      }
  }
--- 13,41 ----
  
  static __inline__ void check_sound_buffers (void)
  {
!     int delay;
!     
!     int size=(char *)sndbufpt - (char *)sndbuffer;
!     if (size >= sndbufsize) {
! #if 0
! 	ioctl(sound_fd,SNDCTL_DSP_GETODELAY,&delay);
! 	if (delay<sndbufsize*1+size) {
! 	    /* We are still OK */
! 	}
! 	else {
! 	    unsigned long long x=sndbufsize;
! 	    x*=syncbase;
! 	    x/=currprefs.sound_freq;
! 	    x/=(currprefs.sound_bits/8);
! 	    x/=(currprefs.stereo+1);
! 	    x/=16;  
! 	    /* Skip one 1/16 buffer worth of time. That's 6% we can slow
! 	       things down --- that should be enough! */
! 	    vsyncmintime+=x;
! 	    // fprintf(stderr,"Adding %llu ticks in sound\n",x);
! 	}
! #endif
! 	write (sound_fd, sndbuffer, size);
  	sndbufpt = sndbuffer;
      }
  }
Only in ../uae_jit_cleaning/uae-0.8.21/src: sounddep
Only in ../uae_jit_cleaning/uae-0.8.21/src: sysconfig.h
Only in ../uae_jit_cleaning/uae-0.8.21/src: target.h
Only in ../uae_jit_cleaning/uae-0.8.21/src: threaddep
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: config.cache
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: config.log
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: config.status
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: cpudefs.c
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: Makefile
diff -crB ./uae-0.8.21/src/tools/Makefile.in ../uae_jit_cleaning/uae-0.8.21/src/tools/Makefile.in
*** ./uae-0.8.21/src/tools/Makefile.in	2001-11-22 02:03:30.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/tools/Makefile.in	2021-01-10 13:10:29.926591684 +0200
***************
*** 23,36 ****
  
  INCLUDES=-I. -I@top_srcdir@/../include/ -I@top_srcdir@
  
! all: gencpu build68k genblitter cpuopti
  
  install:
  
  
  clean:
  	-rm -f *.o
! 	-rm -f gencpu genblitter cpuopti build68k
  
  
  streifenfrei: clean
--- 23,36 ----
  
  INCLUDES=-I. -I@top_srcdir@/../include/ -I@top_srcdir@
  
! all: gencpu gencomp build68k genblitter cpuopti
  
  install:
  
  
  clean:
  	-rm -f *.o
! 	-rm -f gencpu gencomp genblitter cpuopti build68k
  
  
  streifenfrei: clean
***************
*** 43,48 ****
--- 43,50 ----
  	$(CC) $(LDFLAGS) -o cpuopti cpuopti.o writelog.o
  gencpu: gencpu.o readcpu.o cpudefs.o missing.o writelog.o
  	$(CC) $(LDFLAGS) -o gencpu gencpu.o readcpu.o cpudefs.o missing.o writelog.o
+ gencomp: gencomp.o readcpu.o cpudefs.o missing.o
+ 	$(CC) $(LDFLAGS) -o gencomp gencomp.o readcpu.o missing.o cpudefs.o
  
  custom.o: blit.h
  drawing.o: linetoscr.c
***************
*** 62,67 ****
--- 64,71 ----
  	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(DEBUGFLAGS) @top_srcdir@/../genblitter.c -o $@
  gencpu.o: @top_srcdir@/../gencpu.c
  	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(DEBUGFLAGS) @top_srcdir@/../gencpu.c -o $@
+ gencomp.o: @top_srcdir@/../gencomp.c
+ 	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(DEBUGFLAGS) @top_srcdir@/../gencomp.c -o $@
  build68k.o: @top_srcdir@/../build68k.c
  	$(CC) $(INCLUDES) -c $(INCDIRS) $(CFLAGS) $(DEBUGFLAGS) @top_srcdir@/../build68k.c -o $@
  blitops.o: @top_srcdir@/../blitops.c
Only in ../uae_jit_cleaning/uae-0.8.21/src/tools: sysconfig.h
diff -crB ./uae-0.8.21/src/uaeexe.c ../uae_jit_cleaning/uae-0.8.21/src/uaeexe.c
*** ./uae-0.8.21/src/uaeexe.c	2000-08-26 00:29:42.000000000 +0300
--- ../uae_jit_cleaning/uae-0.8.21/src/uaeexe.c	2021-01-10 13:10:29.910591684 +0200
***************
*** 12,17 ****
--- 12,18 ----
  #include "uae.h"
  #include "memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "autoconf.h"
  #include "uaeexe.h"
diff -crB ./uae-0.8.21/src/uaelib.c ../uae_jit_cleaning/uae-0.8.21/src/uaelib.c
*** ./uae-0.8.21/src/uaelib.c	2001-12-30 17:15:56.000000000 +0200
--- ../uae_jit_cleaning/uae-0.8.21/src/uaelib.c	2021-01-10 13:10:29.910591684 +0200
***************
*** 20,25 ****
--- 20,26 ----
  #include "uae.h"
  #include "include/memory.h"
  #include "custom.h"
+ #include "events.h"
  #include "newcpu.h"
  #include "xwin.h"
  #include "autoconf.h"
Only in ./uae-0.8.21: uae_0.8.21_with_jit_2.patch
